Object.defineProperty(exports,"__esModule",{value:true});exports.UIHitSlopView=exports.UIChildContainerView=undefined;var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _defineProperty2=require("babel-runtime/helpers/defineProperty");var _defineProperty3=_interopRequireDefault(_defineProperty2);var _extends3=require("babel-runtime/helpers/extends");var _extends4=_interopRequireDefault(_extends3);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _dec,_class,_dec2,_class2,_class3,_temp,_dec3,_class4;var _UIBorderView=require("./UIBorderView");var _UIBorderView2=_interopRequireDefault(_UIBorderView);var _CustomElement=require("./../utils/CustomElement");var _CustomElement2=_interopRequireDefault(_CustomElement);var _ColorArrayFromHexARGB=require("./../utils/ColorArrayFromHexARGB");var _ColorArrayFromHexARGB2=_interopRequireDefault(_ColorArrayFromHexARGB);var _MatrixMath=require("./../utils/MatrixMath");var MatrixMath=_interopRequireWildcard(_MatrixMath);var _prefixInlineStyles=require("./../utils/prefixInlineStyles");var _prefixInlineStyles2=_interopRequireDefault(_prefixInlineStyles);var _isIOS=require("./../utils/isIOS");var _isIOS2=_interopRequireDefault(_isIOS);var _debounce=require("debounce");var _debounce2=_interopRequireDefault(_debounce);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj.default=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _fixBabelExtend=function(O){var gPO=O.getPrototypeOf||function(o){return o.__proto__;},sPO=O.setPrototypeOf||function(o,p){o.__proto__=p;return o;},construct=typeof Reflect==='object'?Reflect.construct:function(Parent,args,Class){var Constructor,a=[null];a.push.apply(a,args);Constructor=Parent.bind.apply(Parent,a);return sPO(new Constructor(),Class.prototype);};return function fixBabelExtend(Class){var Parent=gPO(Class);return sPO(Class,sPO(function Super(){return construct(Parent,arguments,gPO(this).constructor);},Parent));};}(Object);var UIChildContainerView=exports.UIChildContainerView=(_dec=(0,_CustomElement2.default)("ui-child-container-view"),_dec(_class=_fixBabelExtend(function(_HTMLElement){(0,_inherits3.default)(UIChildContainerView,_HTMLElement);function UIChildContainerView(){(0,_classCallCheck3.default)(this,UIChildContainerView);var _this=(0,_possibleConstructorReturn3.default)(this,(UIChildContainerView.__proto__||Object.getPrototypeOf(UIChildContainerView)).call(this));(0,_extends4.default)(_this.style,(0,_prefixInlineStyles2.default)({contain:"layout style size",position:"absolute",top:"0",left:"0",userSelect:"inherit",transformOrigin:"top left"}));return _this;}(0,_createClass3.default)(UIChildContainerView,[{key:"updateDimensions",value:function updateDimensions(width,height){this.style.width=width+"px";this.style.height=height+"px";}}]);return UIChildContainerView;}(HTMLElement)))||_class);(function(){var styleElement=document.createElement("style");styleElement.innerHTML="\n    .pe-auto, .pe-box-only {\n      pointer-events: auto;\n    }\n    .pe-box-only > * {\n      pointer-events: none;\n    }\n    .pe-none, .pe-box-none, .pe-none * {\n      pointer-events: none !important;\n    }\n    .pe-box-none > * {\n      pointer-events: auto;\n    }\n  ";document.head&&document.head.appendChild(styleElement);})();var UIHitSlopView=exports.UIHitSlopView=(_dec2=(0,_CustomElement2.default)("ui-hit-slop-view"),_dec2(_class2=(_temp=_class3=_fixBabelExtend(function(_HTMLElement2){(0,_inherits3.default)(UIHitSlopView,_HTMLElement2);function UIHitSlopView(viewOwner,touchable){(0,_classCallCheck3.default)(this,UIHitSlopView);var _this2=(0,_possibleConstructorReturn3.default)(this,(UIHitSlopView.__proto__||Object.getPrototypeOf(UIHitSlopView)).call(this));_this2.viewOwner=viewOwner;_this2.touchable=touchable;(0,_extends4.default)(_this2.style,(0,_prefixInlineStyles2.default)({contain:"strict",position:"absolute"}));return _this2;}(0,_createClass3.default)(UIHitSlopView,[{key:"slop",set:function set(value){var resolvedValue=Object.entries((0,_extends4.default)({},UIHitSlopView.defaultHitSlop,value)).reduce(function(acc,cur){return(0,_extends4.default)({},acc,(0,_defineProperty3.default)({},cur[0],-1*cur[1]+"px"));},{});(0,_extends4.default)(this.style,resolvedValue);}},{key:"touchable",set:function set(value){this.style.cursor=value?"pointer":"auto";}}]);return UIHitSlopView;}(HTMLElement)),_class3.defaultHitSlop={top:0,bottom:0,left:0,right:0},_temp))||_class2);var UIView=(_dec3=(0,_CustomElement2.default)("ui-view"),_dec3(_class4=_fixBabelExtend(function(_HTMLElement3){(0,_inherits3.default)(UIView,_HTMLElement3);function UIView(){(0,_classCallCheck3.default)(this,UIView);var _this3=(0,_possibleConstructorReturn3.default)(this,(UIView.__proto__||Object.getPrototypeOf(UIView)).call(this));_this3._top=0;_this3._left=0;_this3._bottom=0;_this3._right=0;_this3._width=0;_this3._height=0;_this3._touchable=false;_this3._disabled=false;_this3._shadowColor=[1,0,0,0];_this3._shadowOffset={width:0,height:0};_this3._shadowOpacity=0;_this3._shadowRadius=0;_this3.isAnimatingOpacity=false;_this3.handleEndedAnimatedOpacity=(0,_debounce2.default)(function(){_this3.removeWillChange("opacity");_this3.isAnimatingOpacity=false;},200);_this3.isAnimatingTransform=false;_this3.handleEndedAnimatedTransform=(0,_debounce2.default)(function(){_this3.removeWillChange("transform");_this3.isAnimatingTransform=false;},100);_this3.childContainer=new UIChildContainerView();_this3.appendChild(_this3.childContainer);_this3.reactSubviews=[];_this3.hasBeenFramed=false;_this3.position="absolute";_this3.backgroundColor="rgba(0,0,0,0)";_this3._willChangeRegistry={};(0,_extends4.default)(_this3.style,(0,_prefixInlineStyles2.default)({contain:"size layout style",boxSizing:"border-box",userSelect:"inherit",overflow:"visible"}));_UIBorderView.ALL_BORDER_PROPS.forEach(function(propName){Object.defineProperty(_this3,propName,{configurable:true,set:function set(value){if(propName.startsWith("border")&&propName.endsWith("Radius")){_this3.style[propName]=value+"px";}_this3.borderChild[propName]=value;}});});return _this3;}(0,_createClass3.default)(UIView,[{key:"addWillChange",value:function addWillChange(key){if(this._willChangeRegistry.hasOwnProperty(key)){this._willChangeRegistry[key]+=1;}else{this._willChangeRegistry[key]=1;}this.updateWillChange();}},{key:"removeWillChange",value:function removeWillChange(key){if(this._willChangeRegistry.hasOwnProperty(key)){if(this._willChangeRegistry[key]===1){delete this._willChangeRegistry[key];}else{this._willChangeRegistry[key]-=1;}this.updateWillChange();}}},{key:"updateWillChange",value:function updateWillChange(){this.style.willChange=Object.keys(this._willChangeRegistry).join(", ");}},{key:"prefixStyle",value:function prefixStyle(propName,propValue){var styleObject={};if(typeof propName==="string"){styleObject[propName]=propValue;}else{styleObject=propName;}return(0,_prefixInlineStyles2.default)(styleObject);}},{key:"updateHostStyle",value:function updateHostStyle(propName,propValue){(0,_extends4.default)(this.style,this.prefixStyle(propName,propValue));}},{key:"updateChildContainerStyle",value:function updateChildContainerStyle(propName,propValue){(0,_extends4.default)(this.childContainer.style,this.prefixStyle(propName,propValue));}},{key:"updateTransform",value:function updateTransform(){var transforms=["translate("+this._left+"px, "+this._top+"px)"];if(this._animatedTransform){transforms.push(this._animatedTransform);}else if(this._transform){transforms.push(this._transform.length===6?"matrix("+this._transform.join(", "):"matrix3d("+this._transform.join(", ")+")");}var transformString=transforms.join(" ");this.updateHostStyle("transform",transformString);}},{key:"attempt2d",value:function attempt2d(v){if(v[2]===0&&v[3]===0&&v[6]===0&&v[7]===0&&v[8]===0&&v[9]===0&&v[10]===1&&v[11]===0&&v[14]===0&&v[15]===1){return[v[0],v[1],v[4],v[5],v[12],v[13]];}}},{key:"updateCursor",value:function updateCursor(){var cursorValue=this._touchable&&!this._disabled?"pointer":"auto";this.updateHostStyle("cursor",cursorValue);}},{key:"updateShadow",value:function updateShadow(){var _shadowColor=(0,_slicedToArray3.default)(this._shadowColor,4),r=_shadowColor[1],g=_shadowColor[2],b=_shadowColor[3];var resolvedColor="rgba("+r+", "+g+", "+b+", "+this._shadowOpacity+")";this.updateHostStyle("boxShadow",this._shadowOffset.width+"px "+this._shadowOffset.height+"px "+this._shadowRadius+"px "+resolvedColor);}},{key:"insertReactSubviewAtIndex",value:function insertReactSubviewAtIndex(subview,index){if(index===this.reactSubviews.length){this.childContainer.appendChild(subview);}else{var beforeElement=this.reactSubviews[index];this.childContainer.insertBefore(subview,beforeElement);}this.reactSubviews.splice(index,0,subview);subview.reactSuperview=this;}},{key:"removeReactSubview",value:function removeReactSubview(subview){subview.reactSuperview=undefined;this.reactSubviews=this.reactSubviews.filter(function(s){return s!==subview;});}},{key:"purge",value:function purge(){if(this.reactSuperview){this.reactSuperview.removeReactSubview(this);}this.remove();}},{key:"addGestureRecognizer",value:function addGestureRecognizer(handler,deviceType,touchListenerOptions){this.addEventListener("pointerdown",handler.pointerBegan,touchListenerOptions);}},{key:"removeGestureRecognizer",value:function removeGestureRecognizer(handler){}},{key:"reactTag",get:function get(){return this._reactTag;},set:function set(value){this._reactTag=value;}},{key:"frame",get:function get(){return{top:this.top,left:this.left,width:this.width,height:this.height};},set:function set(value){(0,_extends4.default)(this,value);this.childContainer.updateDimensions(value.width,value.height);if(this.borderView){this.borderView.updateDimensions(value.width,value.height);}if(!this.hasBeenFramed){this.hasBeenFramed=true;}}},{key:"position",set:function set(value){this.updateHostStyle("position",value);}},{key:"top",get:function get(){return this._top;},set:function set(value){if(value!==this._top){this._top=value;this.updateTransform();}}},{key:"left",get:function get(){return this._left;},set:function set(value){if(value!==this._left){this._left=value;this.updateTransform();}}},{key:"width",get:function get(){return this._width;},set:function set(value){if(value!==this._width){this._width=value;this.updateHostStyle("width",value+"px");}}},{key:"height",get:function get(){return this._height;},set:function set(value){if(value!==this._height){this._height=value;this.updateHostStyle("height",value+"px");}}},{key:"backgroundColor",set:function set(value){var resolvedValue=value;if(typeof value==="number"){var _ColorArrayFromHexARG=(0,_ColorArrayFromHexARGB2.default)(value),_ColorArrayFromHexARG2=(0,_slicedToArray3.default)(_ColorArrayFromHexARG,4),a=_ColorArrayFromHexARG2[0],r=_ColorArrayFromHexARG2[1],g=_ColorArrayFromHexARG2[2],b=_ColorArrayFromHexARG2[3];var stringValue="rgba("+r+","+g+","+b+","+a+")";this._backgroundColor=stringValue;this.updateHostStyle("backgroundColor",stringValue);}else{this._backgroundColor=value;this.updateHostStyle("backgroundColor",value);}}},{key:"pointerEvents",set:function set(value){if(this._pointerEvents!=null){this.classList.remove("pe-"+this._pointerEvents);}if(["auto","none","box-none","box-only"].includes(value)){this.classList.add("pe-"+value);}this._pointerEvents=value;}},{key:"opacity",get:function get(){return this._opacity;},set:function set(value){if(!this.isAnimatingOpacity&&this._opacity!=null){this.addWillChange("opacity");this.isAnimatingOpacity=true;}this.handleEndedAnimatedOpacity();this._opacity=value;this.updateHostStyle("opacity",""+value);}},{key:"transform",get:function get(){return this._transform;},set:function set(value){if(value){var maybe2d=this.attempt2d(value);this._transform=maybe2d?maybe2d:value;}else{this._transform=[1,0,0,1,0,0];}this.updateTransform();}},{key:"animatedTransform",get:function get(){return this._animatedTransform;},set:function set(value){if(!value){this._animatedTransform="";this.updateTransform();return;}var transformString="";value.forEach(function(transformObject){Object.keys(transformObject).forEach(function(property){var value=transformObject[property];if(["translateX","translateY","translateZ"].includes(property)){transformString+=property+"("+value+"px)";}else if(["rotate","rotateX","rotateY","rotateZ"].includes(property)){transformString+=property+"("+value+"rad)";}else{transformString+=property+"("+value+")";}});});if(!this.isAnimatingTransform){this.addWillChange("transform");this.isAnimatingTransform=true;}this.handleEndedAnimatedTransform();this._animatedTransform=transformString;this.updateTransform();}},{key:"borderChild",get:function get(){if(!this.borderView){var borderView=new _UIBorderView2.default();this.appendChild(borderView);this.borderView=borderView;return borderView;}return this.borderView;}},{key:"touchable",get:function get(){return this._touchable;},set:function set(value){this._touchable=value;if(this.hitSlopView){this.hitSlopView.touchable=value;}this.updateCursor();}},{key:"disabled",set:function set(value){this._disabled=value;this.updateCursor();}},{key:"zIndex",set:function set(value){this.updateHostStyle("zIndex",""+value);}},{key:"overflow",set:function set(value){if(value==="scroll")value="auto";this.updateHostStyle("overflow",value);}},{key:"backfaceVisibility",set:function set(value){this.updateHostStyle("backfaceVisibility",value);}},{key:"shadowColor",set:function set(value){var color=(0,_ColorArrayFromHexARGB2.default)(value);this._shadowColor=color;this.updateShadow();}},{key:"shadowOffset",set:function set(value){this._shadowOffset=value;this.updateShadow();}},{key:"shadowOpacity",set:function set(value){this._shadowOpacity=value;this.updateShadow();}},{key:"shadowRadius",set:function set(value){this._shadowRadius=value;this.updateShadow();}},{key:"hitSlop",set:function set(value){if(value!=null){var hitSlopView=this.hitSlopView;if(hitSlopView==null){hitSlopView=new UIHitSlopView(this,this._touchable);this.insertBefore(hitSlopView,this.childContainer);this.hitSlopView=hitSlopView;}hitSlopView.slop=value;}else if(this.hitSlopView!=null){this.removeChild(this.hitSlopView);this.hitSlopView=undefined;}}}]);return UIView;}(HTMLElement)))||_class4);exports.default=UIView;
//# sourceMappingURL=UIView.js.map