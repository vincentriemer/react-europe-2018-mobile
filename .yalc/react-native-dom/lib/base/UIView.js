Object.defineProperty(exports,"__esModule",{value:true});exports.UIChildContainerView=exports.FrameZero=undefined;var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _extends2=require("babel-runtime/helpers/extends");var _extends3=_interopRequireDefault(_extends2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _dec,_class,_dec2,_class2;var _UIBorderView=require("./UIBorderView");var _UIBorderView2=_interopRequireDefault(_UIBorderView);var _CustomElement=require("./../utils/CustomElement");var _CustomElement2=_interopRequireDefault(_CustomElement);var _ColorArrayFromHexARGB=require("./../utils/ColorArrayFromHexARGB");var _ColorArrayFromHexARGB2=_interopRequireDefault(_ColorArrayFromHexARGB);var _MatrixMath=require("./../utils/MatrixMath.dom");var MatrixMath=_interopRequireWildcard(_MatrixMath);var _prefixInlineStyles=require("./../utils/prefixInlineStyles");var _prefixInlineStyles2=_interopRequireDefault(_prefixInlineStyles);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj.default=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var FrameZero=exports.FrameZero={top:0,left:0,width:0,height:0};var baseDimension=1000;var UIChildContainerView=exports.UIChildContainerView=(_dec=(0,_CustomElement2.default)("ui-child-container-view"),_dec(_class=function(_HTMLElement){(0,_inherits3.default)(UIChildContainerView,_HTMLElement);function UIChildContainerView(){(0,_classCallCheck3.default)(this,UIChildContainerView);var _this=(0,_possibleConstructorReturn3.default)(this,(UIChildContainerView.__proto__||Object.getPrototypeOf(UIChildContainerView)).call(this));(0,_extends3.default)(_this.style,(0,_prefixInlineStyles2.default)({contain:"layout style",position:"absolute",top:"0",left:"0",right:"0",bottom:"0",userSelect:"inherit",transformOrigin:"top left",touchAction:"manipulation"}));return _this;}return UIChildContainerView;}(HTMLElement))||_class);var UIView=(_dec2=(0,_CustomElement2.default)("ui-view"),_dec2(_class2=function(_HTMLElement2){(0,_inherits3.default)(UIView,_HTMLElement2);function UIView(){(0,_classCallCheck3.default)(this,UIView);var _this2=(0,_possibleConstructorReturn3.default)(this,(UIView.__proto__||Object.getPrototypeOf(UIView)).call(this));_this2._top=0;_this2._left=0;_this2._bottom=0;_this2._right=0;_this2._width=0;_this2._height=0;_this2._touchable=false;_this2._disabled=false;_this2._pointerEvents="auto";_this2._shadowColor=[1,0,0,0];_this2._shadowOffset={width:0,height:0};_this2._shadowOpacity=0;_this2._shadowRadius=0;_this2.childContainer=new UIChildContainerView();_this2.appendChild(_this2.childContainer);_this2.reactSubviews=[];_this2.hasBeenFramed=false;_this2.opacity=1;_this2.position="absolute";_this2.backgroundColor="rgba(0,0,0,0)";(0,_extends3.default)(_this2.style,(0,_prefixInlineStyles2.default)({contain:"size layout style",boxSizing:"border-box",opacity:"0",touchAction:"manipulation",userSelect:"inherit",isolation:"isolate"}));_UIBorderView.ALL_BORDER_PROPS.forEach(function(propName){Object.defineProperty(_this2,propName,{configurable:true,set:function set(value){if(propName.startsWith("border")&&propName.endsWith("Radius")){_this2.style[propName]=value+"px";}_this2.borderChild[propName]=value;}});});return _this2;}(0,_createClass3.default)(UIView,[{key:"prefixStyle",value:function prefixStyle(propName,propValue){var styleObject={};if(typeof propName==="string"){styleObject[propName]=propValue;}else{styleObject=propName;}return(0,_prefixInlineStyles2.default)(styleObject);}},{key:"updateHostStyle",value:function updateHostStyle(propName,propValue){(0,_extends3.default)(this.style,this.prefixStyle(propName,propValue));}},{key:"updateChildContainerStyle",value:function updateChildContainerStyle(propName,propValue){(0,_extends3.default)(this.childContainer.style,this.prefixStyle(propName,propValue));}},{key:"updateTransform",value:function updateTransform(){var transforms=["translate("+this._left+"px, "+this._top+"px)"];if(this._animatedTransform){transforms.push(this._animatedTransform);}else if(this._transform){transforms.push("matrix3d("+this._transform.join(", ")+")");}var transformString=transforms.join(" ");this.updateHostStyle("transform",transformString);}},{key:"updateCursor",value:function updateCursor(){var cursorValue=this._touchable&&!this._disabled?"pointer":"auto";this.updateHostStyle("cursor",cursorValue);}},{key:"updateShadow",value:function updateShadow(){var _shadowColor=(0,_slicedToArray3.default)(this._shadowColor,4),r=_shadowColor[1],g=_shadowColor[2],b=_shadowColor[3];var resolvedColor="rgba("+r+", "+g+", "+b+", "+this._shadowOpacity+")";this.updateHostStyle("boxShadow",this._shadowOffset.width+"px "+this._shadowOffset.height+"px "+this._shadowRadius+"px "+resolvedColor);}},{key:"insertReactSubviewAtIndex",value:function insertReactSubviewAtIndex(subview,index){if(index===this.reactSubviews.length){this.childContainer.appendChild(subview);}else{var beforeElement=this.reactSubviews[index];this.childContainer.insertBefore(subview,beforeElement);}this.reactSubviews.splice(index,0,subview);subview.reactSuperview=this;}},{key:"removeReactSubview",value:function removeReactSubview(subview){subview.reactSuperview=undefined;this.reactSubviews=this.reactSubviews.filter(function(s){return s!==subview;});}},{key:"purge",value:function purge(){if(this.reactSuperview){this.reactSuperview.removeReactSubview(this);}this.remove();}},{key:"addGestureRecognizer",value:function addGestureRecognizer(handler,deviceType,touchListenerOptions){if(deviceType!=="touchOnly"){this.addEventListener("mousedown",handler.mouseClickBegan,false);}if(deviceType!=="mouseOnly"){this.addEventListener("touchstart",handler.nativeTouchBegan,touchListenerOptions);}}},{key:"removeGestureRecognizer",value:function removeGestureRecognizer(handler){}},{key:"reactTag",get:function get(){return this._reactTag;},set:function set(value){this._reactTag=value;}},{key:"frame",get:function get(){return{top:this.top,left:this.left,width:this.width,height:this.height};},set:function set(value){(0,_extends3.default)(this,value);if(!this.hasBeenFramed){this.hasBeenFramed=true;this.updateHostStyle("opacity",""+this._opacity);}}},{key:"position",set:function set(value){this.updateHostStyle("position",value);}},{key:"top",get:function get(){return this._top;},set:function set(value){if(value!==this._top){this._top=value;this.updateTransform();}}},{key:"left",get:function get(){return this._left;},set:function set(value){if(value!==this._left){this._left=value;this.updateTransform();}}},{key:"width",get:function get(){return this._width;},set:function set(value){if(value!==this._width){this._width=value;this.updateHostStyle("width",value+"px");}}},{key:"height",get:function get(){return this._height;},set:function set(value){if(value!==this._height){this._height=value;this.updateHostStyle("height",value+"px");}}},{key:"backgroundColor",set:function set(value){var resolvedValue=value;if(typeof value==="number"){var _ColorArrayFromHexARG=(0,_ColorArrayFromHexARGB2.default)(value),_ColorArrayFromHexARG2=(0,_slicedToArray3.default)(_ColorArrayFromHexARG,4),a=_ColorArrayFromHexARG2[0],r=_ColorArrayFromHexARG2[1],g=_ColorArrayFromHexARG2[2],b=_ColorArrayFromHexARG2[3];var stringValue="rgba("+r+","+g+","+b+","+a+")";this._backgroundColor=stringValue;this.updateHostStyle("backgroundColor",stringValue);}else{this._backgroundColor=value;this.updateHostStyle("backgroundColor",value);}}},{key:"pointerEvents",set:function set(value){this._pointerEvents=value;switch(value){case"box-none":{this.updateHostStyle("pointerEvents","none");this.updateChildContainerStyle("pointerEvents","all");break;}case"box-only":{this.updateHostStyle("pointerEvents","all");this.updateChildContainerStyle("pointerEvents","none");break;}default:{this.updateHostStyle("pointerEvents",value);this.updateChildContainerStyle("pointerEvents",value);}}}},{key:"opacity",get:function get(){return this._opacity;},set:function set(value){this._opacity=value;this.updateHostStyle("opacity",""+value);}},{key:"transform",get:function get(){return this._transform;},set:function set(value){if(value){this._transform=value;}else{this._transform=MatrixMath.createIdentityMatrix();}this.updateTransform();}},{key:"animatedTransform",get:function get(){return this._animatedTransform;},set:function set(value){if(!value){this._animatedTransform="";this.updateTransform();return;}var transformString="";value.forEach(function(transformObject){Object.keys(transformObject).forEach(function(property){var value=transformObject[property];if(["translateX","translateY","translateZ"].includes(property)){transformString+=property+"("+value+"px)";}else if(["rotate","rotateX","rotateY","rotateZ"].includes(property)){transformString+=property+"("+value+"rad)";}else{transformString+=property+"("+value+")";}});});this._animatedTransform=transformString+" translateZ(0px)";this.updateTransform();}},{key:"borderChild",get:function get(){if(!this.borderView){var borderView=new _UIBorderView2.default();this.appendChild(borderView);this.borderView=borderView;return borderView;}return this.borderView;}},{key:"touchable",get:function get(){return this._touchable;},set:function set(value){this._touchable=value;this.updateCursor();}},{key:"disabled",set:function set(value){this._disabled=value;this.updateCursor();}},{key:"zIndex",set:function set(value){this.updateHostStyle("zIndex",""+value);}},{key:"overflow",set:function set(value){this.updateHostStyle("overflow",value);}},{key:"backfaceVisibility",set:function set(value){this.updateHostStyle("backfaceVisibility",value);}},{key:"shadowColor",set:function set(value){var color=(0,_ColorArrayFromHexARGB2.default)(value);this._shadowColor=color;this.updateShadow();}},{key:"shadowOffset",set:function set(value){this._shadowOffset=value;this.updateShadow();}},{key:"shadowOpacity",set:function set(value){this._shadowOpacity=value;this.updateShadow();}},{key:"shadowRadius",set:function set(value){this._shadowRadius=value;this.updateShadow();}}]);return UIView;}(HTMLElement))||_class2);exports.default=UIView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL1JlYWN0RG9tL2Jhc2UvVUlWaWV3LmpzIl0sIm5hbWVzIjpbIk1hdHJpeE1hdGgiLCJGcmFtZVplcm8iLCJ0b3AiLCJsZWZ0Iiwid2lkdGgiLCJoZWlnaHQiLCJiYXNlRGltZW5zaW9uIiwiVUlDaGlsZENvbnRhaW5lclZpZXciLCJzdHlsZSIsImNvbnRhaW4iLCJwb3NpdGlvbiIsInJpZ2h0IiwiYm90dG9tIiwidXNlclNlbGVjdCIsInRyYW5zZm9ybU9yaWdpbiIsInRvdWNoQWN0aW9uIiwiSFRNTEVsZW1lbnQiLCJVSVZpZXciLCJfdG9wIiwiX2xlZnQiLCJfYm90dG9tIiwiX3JpZ2h0IiwiX3dpZHRoIiwiX2hlaWdodCIsIl90b3VjaGFibGUiLCJfZGlzYWJsZWQiLCJfcG9pbnRlckV2ZW50cyIsIl9zaGFkb3dDb2xvciIsIl9zaGFkb3dPZmZzZXQiLCJfc2hhZG93T3BhY2l0eSIsIl9zaGFkb3dSYWRpdXMiLCJjaGlsZENvbnRhaW5lciIsImFwcGVuZENoaWxkIiwicmVhY3RTdWJ2aWV3cyIsImhhc0JlZW5GcmFtZWQiLCJvcGFjaXR5IiwiYmFja2dyb3VuZENvbG9yIiwiYm94U2l6aW5nIiwiaXNvbGF0aW9uIiwiZm9yRWFjaCIsInByb3BOYW1lIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJzZXQiLCJ2YWx1ZSIsInN0YXJ0c1dpdGgiLCJlbmRzV2l0aCIsImJvcmRlckNoaWxkIiwicHJvcFZhbHVlIiwic3R5bGVPYmplY3QiLCJwcmVmaXhTdHlsZSIsInRyYW5zZm9ybXMiLCJfYW5pbWF0ZWRUcmFuc2Zvcm0iLCJwdXNoIiwiX3RyYW5zZm9ybSIsImpvaW4iLCJ0cmFuc2Zvcm1TdHJpbmciLCJ1cGRhdGVIb3N0U3R5bGUiLCJjdXJzb3JWYWx1ZSIsInIiLCJnIiwiYiIsInJlc29sdmVkQ29sb3IiLCJzdWJ2aWV3IiwiaW5kZXgiLCJsZW5ndGgiLCJiZWZvcmVFbGVtZW50IiwiaW5zZXJ0QmVmb3JlIiwic3BsaWNlIiwicmVhY3RTdXBlcnZpZXciLCJ1bmRlZmluZWQiLCJmaWx0ZXIiLCJzIiwicmVtb3ZlUmVhY3RTdWJ2aWV3IiwicmVtb3ZlIiwiaGFuZGxlciIsImRldmljZVR5cGUiLCJ0b3VjaExpc3RlbmVyT3B0aW9ucyIsImFkZEV2ZW50TGlzdGVuZXIiLCJtb3VzZUNsaWNrQmVnYW4iLCJuYXRpdmVUb3VjaEJlZ2FuIiwiX3JlYWN0VGFnIiwiX29wYWNpdHkiLCJ1cGRhdGVUcmFuc2Zvcm0iLCJyZXNvbHZlZFZhbHVlIiwiYSIsInN0cmluZ1ZhbHVlIiwiX2JhY2tncm91bmRDb2xvciIsInVwZGF0ZUNoaWxkQ29udGFpbmVyU3R5bGUiLCJjcmVhdGVJZGVudGl0eU1hdHJpeCIsInRyYW5zZm9ybU9iamVjdCIsImtleXMiLCJwcm9wZXJ0eSIsImluY2x1ZGVzIiwiYm9yZGVyVmlldyIsInVwZGF0ZUN1cnNvciIsImNvbG9yIiwidXBkYXRlU2hhZG93Il0sIm1hcHBpbmdzIjoiMDRCQU9BLDRDLHlEQUNBLHVELDJEQUNBLHVFLDJFQUNBLHFELEdBQVlBLFcsc0NBQ1osaUUsa1lBRU8sR0FBTUMsNkJBQW1CLENBQzlCQyxJQUFLLENBRHlCLENBRTlCQyxLQUFNLENBRndCLENBRzlCQyxNQUFPLENBSHVCLENBSTlCQyxPQUFRLENBSnNCLENBQXpCLENBT1AsR0FBTUMsZUFBZ0IsSUFBdEIsQyxHQUdhQyxxQixTQUFBQSxvQixPQURaLDRCQUFjLHlCQUFkLEMsOEZBRUMsK0JBQWMsME1BRVosc0JBQ0UsTUFBS0MsS0FEUCxDQUVFLGlDQUFtQixDQUNqQkMsUUFBUyxjQURRLENBRWpCQyxTQUFVLFVBRk8sQ0FHakJSLElBQUssR0FIWSxDQUlqQkMsS0FBTSxHQUpXLENBS2pCUSxNQUFPLEdBTFUsQ0FNakJDLE9BQVEsR0FOUyxDQU9qQkMsV0FBWSxTQVBLLENBUWpCQyxnQkFBaUIsVUFSQSxDQVNqQkMsWUFBYSxjQVRJLENBQW5CLENBRkYsRUFGWSxhQWdCYixDLDhCQWpCdUNDLFcsZUFxQnBDQyxPLFFB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WW5ELEssQ0FBZ0IsQ0FDM0IsS0FBS3BCLFNBQUwsQ0FBaUJvQixLQUFqQixDQUNBLEtBQUttRCxZQUFMLEdBQ0QsQyxpQ0FFVW5ELEssQ0FBZSxDQUN4QixLQUFLYSxlQUFMLENBQXFCLFFBQXJCLElBQWtDYixLQUFsQyxFQUNELEMsbUNBRVlBLEssQ0FBZSxDQUMxQixLQUFLYSxlQUFMLENBQXFCLFVBQXJCLENBQWlDYixLQUFqQyxFQUNELEMsNkNBRXNCQSxLLENBQWUsQ0FDcEMsS0FBS2EsZUFBTCxDQUFxQixvQkFBckIsQ0FBMkNiLEtBQTNDLEVBQ0QsQyxzQ0FnQmVBLEssQ0FBZSxDQUM3QixHQUFNb0QsT0FBUSxvQ0FBc0JwRCxLQUF0QixDQUFkLENBQ0EsS0FBS2xCLFlBQUwsQ0FBb0JzRSxLQUFwQixDQUNBLEtBQUtDLFlBQUwsR0FDRCxDLHVDQUVnQnJELEssQ0FBMEMsQ0FDekQsS0FBS2pCLGFBQUwsQ0FBcUJpQixLQUFyQixDQUNBLEtBQUtxRCxZQUFMLEdBQ0QsQyx3Q0FFaUJyRCxLLENBQWUsQ0FDL0IsS0FBS2hCLGNBQUwsQ0FBc0JnQixLQUF0QixDQUNBLEtBQUtxRCxZQUFMLEdBQ0QsQyx1Q0FFZ0JyRCxLLENBQWUsQ0FDOUIsS0FBS2YsYUFBTCxDQUFxQmUsS0FBckIsQ0FDQSxLQUFLcUQsWUFBTCxHQUNELEMsb0JBbFZrQmxGLFcsNkJBbVlOQyxNIiwiZmlsZSI6IlVJVmlldy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQHByb3ZpZGVzTW9kdWxlIFVJVmlld1xuICogQGZsb3dcbiAqL1xuXG5pbXBvcnQgdHlwZSBSQ1RUb3VjaEhhbmRsZXIgZnJvbSBcIlJDVFRvdWNoSGFuZGxlclwiO1xuaW1wb3J0IHR5cGUgeyBSQ1RDb21wb25lbnQgfSBmcm9tIFwiUkNUQ29tcG9uZW50XCI7XG5pbXBvcnQgVUlCb3JkZXJWaWV3LCB7IEFMTF9CT1JERVJfUFJPUFMgfSBmcm9tIFwiVUlCb3JkZXJWaWV3XCI7XG5pbXBvcnQgQ3VzdG9tRWxlbWVudCBmcm9tIFwiQ3VzdG9tRWxlbWVudFwiO1xuaW1wb3J0IENvbG9yQXJyYXlGcm9tSGV4QVJHQiBmcm9tIFwiQ29sb3JBcnJheUZyb21IZXhBUkdCXCI7XG5pbXBvcnQgKiBhcyBNYXRyaXhNYXRoIGZyb20gXCJNYXRyaXhNYXRoXCI7XG5pbXBvcnQgcHJlZml4SW5saW5lU3R5bGVzIGZyb20gXCJwcmVmaXhJbmxpbmVTdHlsZXNcIjtcblxuZXhwb3J0IGNvbnN0IEZyYW1lWmVybzogRnJhbWUgPSB7XG4gIHRvcDogMCxcbiAgbGVmdDogMCxcbiAgd2lkdGg6IDAsXG4gIGhlaWdodDogMFxufTtcblxuY29uc3QgYmFzZURpbWVuc2lvbiA9IDEwMDA7XG5cbkBDdXN0b21FbGVtZW50KFwidWktY2hpbGQtY29udGFpbmVyLXZpZXdcIilcbmV4cG9ydCBjbGFzcyBVSUNoaWxkQ29udGFpbmVyVmlldyBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICBPYmplY3QuYXNzaWduKFxuICAgICAgdGhpcy5zdHlsZSxcbiAgICAgIHByZWZpeElubGluZVN0eWxlcyh7XG4gICAgICAgIGNvbnRhaW46IFwibGF5b3V0IHN0eWxlXCIsXG4gICAgICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgICAgIHRvcDogXCIwXCIsXG4gICAgICAgIGxlZnQ6IFwiMFwiLFxuICAgICAgICByaWdodDogXCIwXCIsXG4gICAgICAgIGJvdHRvbTogXCIwXCIsXG4gICAgICAgIHVzZXJTZWxlY3Q6IFwiaW5oZXJpdFwiLFxuICAgICAgICB0cmFuc2Zvcm1PcmlnaW46IFwidG9wIGxlZnRcIixcbiAgICAgICAgdG91Y2hBY3Rpb246IFwibWFuaXB1bGF0aW9uXCJcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxufVxuXG5AQ3VzdG9tRWxlbWVudChcInVpLXZpZXdcIilcbmNsYXNzIFVJVmlldyBleHRlbmRzIEhUTUxFbGVtZW50IGltcGxlbWVudHMgUkNUQ29tcG9uZW50IHtcbiAgX3RvcDogbnVtYmVyID0gMDtcbiAgX2xlZnQ6IG51bWJlciA9IDA7XG4gIF9ib3R0b206IG51bWJlciA9IDA7XG4gIF9yaWdodDogbnVtYmVyID0gMDtcbiAgX3dpZHRoOiBudW1iZXIgPSAwO1xuICBfaGVpZ2h0OiBudW1iZXIgPSAwO1xuICBfdG91Y2hhYmxlOiBib29sZWFuID0gZmFsc2U7XG4gIF9vcGFjaXR5OiBudW1iZXI7XG4gIF90cmFuc2Zvcm06IG51bWJlcltdO1xuICBfYW5pbWF0ZWRUcmFuc2Zvcm06IHN0cmluZztcbiAgX2JhY2tncm91bmRDb2xvcjogc3RyaW5nO1xuICBfZGlzYWJsZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgX3BvaW50ZXJFdmVudHM6IHN0cmluZyA9IFwiYXV0b1wiO1xuXG4gIF9zaGFkb3dDb2xvcjogW251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl0gPSBbMSwgMCwgMCwgMF07XG4gIF9zaGFkb3dPZmZzZXQ6IHsgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIgfSA9IHsgd2lkdGg6IDAsIGhlaWdodDogMCB9O1xuICBfc2hhZG93T3BhY2l0eTogbnVtYmVyID0gMDtcbiAgX3NoYWRvd1JhZGl1czogbnVtYmVyID0gMDtcblxuICBjaGlsZENvbnRhaW5lcjogVUlDaGlsZENvbnRhaW5lclZpZXc7XG4gIGJvcmRlclZpZXc6ID9VSUJvcmRlclZpZXc7XG5cbiAgX3JlYWN0VGFnOiBudW1iZXI7XG4gIHJlYWN0U3Vidmlld3M6IEFycmF5PFVJVmlldz47XG4gIHJlYWN0U3VwZXJ2aWV3OiA/VUlWaWV3O1xuICBoYXNCZWVuRnJhbWVkOiBib29sZWFuO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLmNoaWxkQ29udGFpbmVyID0gbmV3IFVJQ2hpbGRDb250YWluZXJWaWV3KCk7XG4gICAgdGhpcy5hcHBlbmRDaGlsZCh0aGlzLmNoaWxkQ29udGFpbmVyKTtcblxuICAgIHRoaXMucmVhY3RTdWJ2aWV3cyA9IFtdO1xuICAgIHRoaXMuaGFzQmVlbkZyYW1lZCA9IGZhbHNlO1xuICAgIHRoaXMub3BhY2l0eSA9IDE7XG5cbiAgICB0aGlzLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gXCJyZ2JhKDAsMCwwLDApXCI7XG5cbiAgICBPYmplY3QuYXNzaWduKFxuICAgICAgdGhpcy5zdHlsZSxcbiAgICAgIHByZWZpeElubGluZVN0eWxlcyh7XG4gICAgICAgIGNvbnRhaW46IFwic2l6ZSBsYXlvdXQgc3R5bGVcIixcbiAgICAgICAgYm94U2l6aW5nOiBcImJvcmRlci1ib3hcIixcbiAgICAgICAgb3BhY2l0eTogXCIwXCIsXG4gICAgICAgIHRvdWNoQWN0aW9uOiBcIm1hbmlwdWxhdGlvblwiLFxuICAgICAgICB1c2VyU2VsZWN0OiBcImluaGVyaXRcIixcbiAgICAgICAgaXNvbGF0aW9uOiBcImlzb2xhdGVcIlxuICAgICAgICAvLyBvdmVyZmxvdzogXCJoaWRkZW5cIlxuICAgICAgfSlcbiAgICApO1xuXG4gICAgQUxMX0JPUkRFUl9QUk9QUy5mb3JFYWNoKChwcm9wTmFtZSkgPT4ge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIHByb3BOYW1lLCB7XG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgc2V0OiAodmFsdWUpID0+IHtcbiAgICAgICAgICBpZiAocHJvcE5hbWUuc3RhcnRzV2l0aChcImJvcmRlclwiKSAmJiBwcm9wTmFtZS5lbmRzV2l0aChcIlJhZGl1c1wiKSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZVtwcm9wTmFtZV0gPSBgJHt2YWx1ZX1weGA7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vICRGbG93Rml4TWVcbiAgICAgICAgICB0aGlzLmJvcmRlckNoaWxkW3Byb3BOYW1lXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHByZWZpeFN0eWxlKHByb3BOYW1lOiBzdHJpbmcgfCBPYmplY3QsIHByb3BWYWx1ZT86IHN0cmluZykge1xuICAgIGxldCBzdHlsZU9iamVjdCA9IHt9O1xuICAgIGlmICh0eXBlb2YgcHJvcE5hbWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHN0eWxlT2JqZWN0W3Byb3BOYW1lXSA9IHByb3BWYWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3R5bGVPYmplY3QgPSBwcm9wTmFtZTtcbiAgICB9XG4gICAgcmV0dXJuIHByZWZpeElubGluZVN0eWxlcyhzdHlsZU9iamVjdCk7XG4gIH1cblxuICB1cGRhdGVIb3N0U3R5bGUocHJvcE5hbWU6IHN0cmluZyB8IE9iamVjdCwgcHJvcFZhbHVlPzogc3RyaW5nKSB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLnN0eWxlLCB0aGlzLnByZWZpeFN0eWxlKHByb3BOYW1lLCBwcm9wVmFsdWUpKTtcbiAgfVxuXG4gIHVwZGF0ZUNoaWxkQ29udGFpbmVyU3R5bGUocHJvcE5hbWU6IHN0cmluZyB8IE9iamVjdCwgcHJvcFZhbHVlPzogc3RyaW5nKSB7XG4gICAgT2JqZWN0LmFzc2lnbihcbiAgICAgIHRoaXMuY2hpbGRDb250YWluZXIuc3R5bGUsXG4gICAgICB0aGlzLnByZWZpeFN0eWxlKHByb3BOYW1lLCBwcm9wVmFsdWUpXG4gICAgKTtcbiAgfVxuXG4gIGdldCByZWFjdFRhZygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9yZWFjdFRhZztcbiAgfVxuXG4gIHNldCByZWFjdFRhZyh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5fcmVhY3RUYWcgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBmcmFtZSgpOiBGcmFtZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogdGhpcy50b3AsXG4gICAgICBsZWZ0OiB0aGlzLmxlZnQsXG4gICAgICB3aWR0aDogdGhpcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgc2V0IGZyYW1lKHZhbHVlOiBGcmFtZSkge1xuICAgIE9iamVjdC5hc3NpZ24odGhpcywgdmFsdWUpO1xuICAgIGlmICghdGhpcy5oYXNCZWVuRnJhbWVkKSB7XG4gICAgICB0aGlzLmhhc0JlZW5GcmFtZWQgPSB0cnVlO1xuICAgICAgdGhpcy51cGRhdGVIb3N0U3R5bGUoXCJvcGFjaXR5XCIsIGAke3RoaXMuX29wYWNpdHl9YCk7XG4gICAgfVxuICB9XG5cbiAgc2V0IHBvc2l0aW9uKHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnVwZGF0ZUhvc3RTdHlsZShcInBvc2l0aW9uXCIsIHZhbHVlKTtcbiAgfVxuXG4gIGdldCB0b3AoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fdG9wO1xuICB9XG5cbiAgc2V0IHRvcCh2YWx1ZTogbnVtYmVyKSB7XG4gICAgaWYgKHZhbHVlICE9PSB0aGlzLl90b3ApIHtcbiAgICAgIHRoaXMuX3RvcCA9IHZhbHVlO1xuICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICB9XG4gIH1cblxuICBnZXQgbGVmdCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9sZWZ0O1xuICB9XG5cbiAgc2V0IGxlZnQodmFsdWU6IG51bWJlcikge1xuICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5fbGVmdCkge1xuICAgICAgdGhpcy5fbGVmdCA9IHZhbHVlO1xuICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVUcmFuc2Zvcm0oKSB7XG4gICAgY29uc3QgdHJhbnNmb3JtcyA9IFtgdHJhbnNsYXRlKCR7dGhpcy5fbGVmdH1weCwgJHt0aGlzLl90b3B9cHgpYF07XG5cbiAgICBpZiAodGhpcy5fYW5pbWF0ZWRUcmFuc2Zvcm0pIHtcbiAgICAgIHRyYW5zZm9ybXMucHVzaCh0aGlzLl9hbmltYXRlZFRyYW5zZm9ybSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLl90cmFuc2Zvcm0pIHtcbiAgICAgIHRyYW5zZm9ybXMucHVzaChgbWF0cml4M2QoJHt0aGlzLl90cmFuc2Zvcm0uam9pbihcIiwgXCIpfSlgKTtcbiAgICB9XG5cbiAgICBjb25zdCB0cmFuc2Zvcm1TdHJpbmcgPSB0cmFuc2Zvcm1zLmpvaW4oXCIgXCIpO1xuXG4gICAgdGhpcy51cGRhdGVIb3N0U3R5bGUoXCJ0cmFuc2Zvcm1cIiwgdHJhbnNmb3JtU3RyaW5nKTtcbiAgfVxuXG4gIGdldCB3aWR0aCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl93aWR0aDtcbiAgfVxuXG4gIHNldCB3aWR0aCh2YWx1ZTogbnVtYmVyKSB7XG4gICAgaWYgKHZhbHVlICE9PSB0aGlzLl93aWR0aCkge1xuICAgICAgdGhpcy5fd2lkdGggPSB2YWx1ZTtcbiAgICAgIHRoaXMudXBkYXRlSG9zdFN0eWxlKFwid2lkdGhcIiwgYCR7dmFsdWV9cHhgKTtcbiAgICB9XG4gIH1cblxuICBnZXQgaGVpZ2h0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX2hlaWdodDtcbiAgfVxuXG4gIHNldCBoZWlnaHQodmFsdWU6IG51bWJlcikge1xuICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5faGVpZ2h0KSB7XG4gICAgICB0aGlzLl9oZWlnaHQgPSB2YWx1ZTtcbiAgICAgIHRoaXMudXBkYXRlSG9zdFN0eWxlKFwiaGVpZ2h0XCIsIGAke3ZhbHVlfXB4YCk7XG4gICAgfVxuICB9XG5cbiAgc2V0IGJhY2tncm91bmRDb2xvcih2YWx1ZTogc3RyaW5nIHwgbnVtYmVyKSB7XG4gICAgbGV0IHJlc29sdmVkVmFsdWUgPSB2YWx1ZTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb25zdCBbYSwgciwgZywgYl0gPSBDb2xvckFycmF5RnJvbUhleEFSR0IodmFsdWUpO1xuICAgICAgY29uc3Qgc3RyaW5nVmFsdWUgPSBgcmdiYSgke3J9LCR7Z30sJHtifSwke2F9KWA7XG4gICAgICB0aGlzLl9iYWNrZ3JvdW5kQ29sb3IgPSBzdHJpbmdWYWx1ZTtcbiAgICAgIHRoaXMudXBkYXRlSG9zdFN0eWxlKFwiYmFja2dyb3VuZENvbG9yXCIsIHN0cmluZ1ZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYmFja2dyb3VuZENvbG9yID0gdmFsdWU7XG4gICAgICB0aGlzLnVwZGF0ZUhvc3RTdHlsZShcImJhY2tncm91bmRDb2xvclwiLCB2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgc2V0IHBvaW50ZXJFdmVudHModmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuX3BvaW50ZXJFdmVudHMgPSB2YWx1ZTtcbiAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICBjYXNlIFwiYm94LW5vbmVcIjoge1xuICAgICAgICB0aGlzLnVwZGF0ZUhvc3RTdHlsZShcInBvaW50ZXJFdmVudHNcIiwgXCJub25lXCIpO1xuICAgICAgICB0aGlzLnVwZGF0ZUNoaWxkQ29udGFpbmVyU3R5bGUoXCJwb2ludGVyRXZlbnRzXCIsIFwiYWxsXCIpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJib3gtb25seVwiOiB7XG4gICAgICAgIHRoaXMudXBkYXRlSG9zdFN0eWxlKFwicG9pbnRlckV2ZW50c1wiLCBcImFsbFwiKTtcbiAgICAgICAgdGhpcy51cGRhdGVDaGlsZENvbnRhaW5lclN0eWxlKFwicG9pbnRlckV2ZW50c1wiLCBcIm5vbmVcIik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICB0aGlzLnVwZGF0ZUhvc3RTdHlsZShcInBvaW50ZXJFdmVudHNcIiwgdmFsdWUpO1xuICAgICAgICB0aGlzLnVwZGF0ZUNoaWxkQ29udGFpbmVyU3R5bGUoXCJwb2ludGVyRXZlbnRzXCIsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXQgb3BhY2l0eSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9vcGFjaXR5O1xuICB9XG5cbiAgc2V0IG9wYWNpdHkodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX29wYWNpdHkgPSB2YWx1ZTtcbiAgICB0aGlzLnVwZGF0ZUhvc3RTdHlsZShcIm9wYWNpdHlcIiwgYCR7dmFsdWV9YCk7XG4gIH1cblxuICBnZXQgdHJhbnNmb3JtKCk6IG51bWJlcltdIHtcbiAgICByZXR1cm4gdGhpcy5fdHJhbnNmb3JtO1xuICB9XG5cbiAgc2V0IHRyYW5zZm9ybSh2YWx1ZTogP0FycmF5PG51bWJlcj4pIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuX3RyYW5zZm9ybSA9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl90cmFuc2Zvcm0gPSBNYXRyaXhNYXRoLmNyZWF0ZUlkZW50aXR5TWF0cml4KCk7XG4gICAgfVxuICAgIHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7XG4gIH1cblxuICBnZXQgYW5pbWF0ZWRUcmFuc2Zvcm0oKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fYW5pbWF0ZWRUcmFuc2Zvcm07XG4gIH1cblxuICBzZXQgYW5pbWF0ZWRUcmFuc2Zvcm0odmFsdWU6ID9BcnJheTxPYmplY3Q+KSB7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgdGhpcy5fYW5pbWF0ZWRUcmFuc2Zvcm0gPSBcIlwiO1xuICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgdHJhbnNmb3JtU3RyaW5nID0gXCJcIjtcbiAgICB2YWx1ZS5mb3JFYWNoKCh0cmFuc2Zvcm1PYmplY3QpID0+IHtcbiAgICAgIE9iamVjdC5rZXlzKHRyYW5zZm9ybU9iamVjdCkuZm9yRWFjaCgocHJvcGVydHkpID0+IHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0cmFuc2Zvcm1PYmplY3RbcHJvcGVydHldO1xuICAgICAgICBpZiAoW1widHJhbnNsYXRlWFwiLCBcInRyYW5zbGF0ZVlcIiwgXCJ0cmFuc2xhdGVaXCJdLmluY2x1ZGVzKHByb3BlcnR5KSkge1xuICAgICAgICAgIHRyYW5zZm9ybVN0cmluZyArPSBgJHtwcm9wZXJ0eX0oJHt2YWx1ZX1weClgO1xuICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgIFtcInJvdGF0ZVwiLCBcInJvdGF0ZVhcIiwgXCJyb3RhdGVZXCIsIFwicm90YXRlWlwiXS5pbmNsdWRlcyhwcm9wZXJ0eSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgdHJhbnNmb3JtU3RyaW5nICs9IGAke3Byb3BlcnR5fSgke3ZhbHVlfXJhZClgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRyYW5zZm9ybVN0cmluZyArPSBgJHtwcm9wZXJ0eX0oJHt2YWx1ZX0pYDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9hbmltYXRlZFRyYW5zZm9ybSA9IHRyYW5zZm9ybVN0cmluZyArIFwiIHRyYW5zbGF0ZVooMHB4KVwiO1xuICAgIHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7XG4gIH1cblxuICBnZXQgYm9yZGVyQ2hpbGQoKTogVUlCb3JkZXJWaWV3IHtcbiAgICBpZiAoIXRoaXMuYm9yZGVyVmlldykge1xuICAgICAgY29uc3QgYm9yZGVyVmlldyA9IG5ldyBVSUJvcmRlclZpZXcoKTtcblxuICAgICAgdGhpcy5hcHBlbmRDaGlsZChib3JkZXJWaWV3KTtcbiAgICAgIHRoaXMuYm9yZGVyVmlldyA9IGJvcmRlclZpZXc7XG4gICAgICByZXR1cm4gYm9yZGVyVmlldztcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5ib3JkZXJWaWV3O1xuICB9XG5cbiAgZ2V0IHRvdWNoYWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fdG91Y2hhYmxlO1xuICB9XG5cbiAgdXBkYXRlQ3Vyc29yKCkge1xuICAgIGNvbnN0IGN1cnNvclZhbHVlID0gdGhpcy5fdG91Y2hhYmxlICYmICF0aGlzLl9kaXNhYmxlZCA/IFwicG9pbnRlclwiIDogXCJhdXRvXCI7XG4gICAgdGhpcy51cGRhdGVIb3N0U3R5bGUoXCJjdXJzb3JcIiwgY3Vyc29yVmFsdWUpO1xuICB9XG5cbiAgc2V0IHRvdWNoYWJsZSh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX3RvdWNoYWJsZSA9IHZhbHVlO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gIH1cblxuICBzZXQgZGlzYWJsZWQodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9kaXNhYmxlZCA9IHZhbHVlO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gIH1cblxuICBzZXQgekluZGV4KHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLnVwZGF0ZUhvc3RTdHlsZShcInpJbmRleFwiLCBgJHt2YWx1ZX1gKTtcbiAgfVxuXG4gIHNldCBvdmVyZmxvdyh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy51cGRhdGVIb3N0U3R5bGUoXCJvdmVyZmxvd1wiLCB2YWx1ZSk7XG4gIH1cblxuICBzZXQgYmFja2ZhY2VWaXNpYmlsaXR5KHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnVwZGF0ZUhvc3RTdHlsZShcImJhY2tmYWNlVmlzaWJpbGl0eVwiLCB2YWx1ZSk7XG4gIH1cblxuICAvLyBTSEFET1cgUFJPUFMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgdXBkYXRlU2hhZG93KCkge1xuICAgIGNvbnN0IFssIHIsIGcsIGJdID0gdGhpcy5fc2hhZG93Q29sb3I7XG4gICAgY29uc3QgcmVzb2x2ZWRDb2xvciA9IGByZ2JhKCR7cn0sICR7Z30sICR7Yn0sICR7dGhpcy5fc2hhZG93T3BhY2l0eX0pYDtcblxuICAgIHRoaXMudXBkYXRlSG9zdFN0eWxlKFxuICAgICAgXCJib3hTaGFkb3dcIixcbiAgICAgIGAke3RoaXMuX3NoYWRvd09mZnNldC53aWR0aH1weCAke3RoaXMuX3NoYWRvd09mZnNldC5oZWlnaHR9cHggJHtcbiAgICAgICAgdGhpcy5fc2hhZG93UmFkaXVzXG4gICAgICB9cHggJHtyZXNvbHZlZENvbG9yfWBcbiAgICApO1xuICB9XG5cbiAgc2V0IHNoYWRvd0NvbG9yKHZhbHVlOiBudW1iZXIpIHtcbiAgICBjb25zdCBjb2xvciA9IENvbG9yQXJyYXlGcm9tSGV4QVJHQih2YWx1ZSk7XG4gICAgdGhpcy5fc2hhZG93Q29sb3IgPSBjb2xvcjtcbiAgICB0aGlzLnVwZGF0ZVNoYWRvdygpO1xuICB9XG5cbiAgc2V0IHNoYWRvd09mZnNldCh2YWx1ZTogeyB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciB9KSB7XG4gICAgdGhpcy5fc2hhZG93T2Zmc2V0ID0gdmFsdWU7XG4gICAgdGhpcy51cGRhdGVTaGFkb3coKTtcbiAgfVxuXG4gIHNldCBzaGFkb3dPcGFjaXR5KHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLl9zaGFkb3dPcGFjaXR5ID0gdmFsdWU7XG4gICAgdGhpcy51cGRhdGVTaGFkb3coKTtcbiAgfVxuXG4gIHNldCBzaGFkb3dSYWRpdXModmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX3NoYWRvd1JhZGl1cyA9IHZhbHVlO1xuICAgIHRoaXMudXBkYXRlU2hhZG93KCk7XG4gIH1cblxuICBpbnNlcnRSZWFjdFN1YnZpZXdBdEluZGV4KHN1YnZpZXc6IFVJVmlldywgaW5kZXg6IG51bWJlcikge1xuICAgIGlmIChpbmRleCA9PT0gdGhpcy5yZWFjdFN1YnZpZXdzLmxlbmd0aCkge1xuICAgICAgdGhpcy5jaGlsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzdWJ2aWV3KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgYmVmb3JlRWxlbWVudCA9IHRoaXMucmVhY3RTdWJ2aWV3c1tpbmRleF07XG4gICAgICB0aGlzLmNoaWxkQ29udGFpbmVyLmluc2VydEJlZm9yZShzdWJ2aWV3LCBiZWZvcmVFbGVtZW50KTtcbiAgICB9XG5cbiAgICB0aGlzLnJlYWN0U3Vidmlld3Muc3BsaWNlKGluZGV4LCAwLCBzdWJ2aWV3KTtcbiAgICBzdWJ2aWV3LnJlYWN0U3VwZXJ2aWV3ID0gdGhpcztcbiAgfVxuXG4gIHJlbW92ZVJlYWN0U3VidmlldyhzdWJ2aWV3OiBVSVZpZXcpIHtcbiAgICBzdWJ2aWV3LnJlYWN0U3VwZXJ2aWV3ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMucmVhY3RTdWJ2aWV3cyA9IHRoaXMucmVhY3RTdWJ2aWV3cy5maWx0ZXIoKHMpID0+IHMgIT09IHN1YnZpZXcpO1xuICB9XG5cbiAgcHVyZ2UoKSB7XG4gICAgaWYgKHRoaXMucmVhY3RTdXBlcnZpZXcpIHtcbiAgICAgIHRoaXMucmVhY3RTdXBlcnZpZXcucmVtb3ZlUmVhY3RTdWJ2aWV3KHRoaXMpO1xuICAgIH1cbiAgICB0aGlzLnJlbW92ZSgpO1xuICB9XG5cbiAgYWRkR2VzdHVyZVJlY29nbml6ZXIoXG4gICAgaGFuZGxlcjogUkNUVG91Y2hIYW5kbGVyLFxuICAgIGRldmljZVR5cGU6IFwibW91c2VPbmx5XCIgfCBcInRvdWNoT25seVwiIHwgXCJoeWJyaWRcIixcbiAgICB0b3VjaExpc3RlbmVyT3B0aW9uczogT2JqZWN0IHwgYm9vbGVhblxuICApIHtcbiAgICBpZiAoZGV2aWNlVHlwZSAhPT0gXCJ0b3VjaE9ubHlcIikge1xuICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZXIubW91c2VDbGlja0JlZ2FuLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgaWYgKGRldmljZVR5cGUgIT09IFwibW91c2VPbmx5XCIpIHtcbiAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJ0b3VjaHN0YXJ0XCIsXG4gICAgICAgIGhhbmRsZXIubmF0aXZlVG91Y2hCZWdhbixcbiAgICAgICAgdG91Y2hMaXN0ZW5lck9wdGlvbnNcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlR2VzdHVyZVJlY29nbml6ZXIoaGFuZGxlcjogUkNUVG91Y2hIYW5kbGVyKSB7XG4gICAgLy8gVE9ETzogSW1wbGVtZW50XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVUlWaWV3O1xuIl19