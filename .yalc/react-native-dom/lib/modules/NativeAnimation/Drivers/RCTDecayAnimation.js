Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _RCTAnimationDriver=require("./RCTAnimationDriver");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var RCTDecayAnimation=function(){function RCTDecayAnimation(animationId,config,valueNode,callback){(0,_classCallCheck3.default)(this,RCTDecayAnimation);this.animationId=animationId;this.fromValue=0;this.lastValue=0;this.valueNode=valueNode;this.callback=callback;this.velocity=config.velocity;this.deceleration=config.deceleration;this.iterations=config.iterations!=null?config.iterations:1;this.currentLoop=1;this.animationHasFinished=this.iterations===0;return this;}(0,_createClass3.default)(RCTDecayAnimation,[{key:"startAnimation",value:function startAnimation(){this.frameStartTime=-1;this.animationHasBegun=true;}},{key:"stopAnimation",value:function stopAnimation(){if(this.callback){this.callback({finished:this.animationHasFinished});}}},{key:"stepAnimationWithTime",value:function stepAnimationWithTime(currentTime){var valueNode=this.valueNode;if(valueNode==null||!this.animationHasBegun||this.animationHasFinished){return;}if(this.frameStartTime===-1){this.frameStartTime=currentTime-_RCTAnimationDriver.RCTSingleFrameInterval;if(this.fromValue===this.lastValue){this.fromValue=valueNode.value;}else{this.updateValue(this.fromValue);}this.lastValue=valueNode.value;}var value=this.fromValue+this.velocity/(1-this.deceleration)*(1-Math.exp(-(1-this.deceleration)*(currentTime-this.frameStartTime)));this.updateValue(value);if(Math.abs(this.lastValue-value)<0.1){if(this.iterations===-1||this.currentLoop<this.iterations){this.frameStartTime=-1;this.currentLoop++;}else{this.animationHasFinished=true;return;}}this.lastValue=value;}},{key:"updateValue",value:function updateValue(outputValue){var valueNode=this.valueNode;if(valueNode){valueNode.value=outputValue;valueNode.setNeedsUpdate();}}}]);return RCTDecayAnimation;}();exports.default=RCTDecayAnimation;
//# sourceMappingURL=RCTDecayAnimation.js.map