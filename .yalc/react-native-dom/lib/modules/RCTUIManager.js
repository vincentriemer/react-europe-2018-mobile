var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _regenerator=require("babel-runtime/regenerator");var _regenerator2=_interopRequireDefault(_regenerator);var _toConsumableArray2=require("babel-runtime/helpers/toConsumableArray");var _toConsumableArray3=_interopRequireDefault(_toConsumableArray2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _this8=this;var _Invariant=require("./../utils/Invariant");var _Invariant2=_interopRequireDefault(_Invariant);var _RCTBridge=require("./../bridge/RCTBridge");var _RCTBridge2=_interopRequireDefault(_RCTBridge);var _UIView=require("./../base/UIView");var _UIView2=_interopRequireDefault(_UIView);var _RCTView=require("./../views/RCTView");var _RCTView2=_interopRequireDefault(_RCTView);var _RCTRootView=require("./../bridge/RCTRootView");var _RCTRootView2=_interopRequireDefault(_RCTRootView);var _RCTDeviceInfo=require("./RCTDeviceInfo");var _RCTDeviceInfo2=_interopRequireDefault(_RCTDeviceInfo);var _RCTLayoutAnimationManager=require("./LayoutAnimation/RCTLayoutAnimationManager");var _RCTLayoutAnimationManager2=_interopRequireDefault(_RCTLayoutAnimationManager);var _RCTUIManagerObserver=require("./RCTUIManagerObserver");var _RCTUIManagerObserver2=_interopRequireDefault(_RCTUIManagerObserver);var _RCTComponentData=require("./../views/RCTComponentData");var _RCTComponentData2=_interopRequireDefault(_RCTComponentData);var _CanUse=require("./../utils/CanUse");var _CanUse2=_interopRequireDefault(_CanUse);var _Instrument=require("./../utils/Instrument");var _Instrument2=_interopRequireDefault(_Instrument);var _RCTShadowView2=require("./../views/RCTShadowView");var _RCTShadowView3=_interopRequireDefault(_RCTShadowView2);var _RCTRootShadowView2=require("./../views/RCTRootShadowView");var _RCTRootShadowView3=_interopRequireDefault(_RCTRootShadowView2);var _RCTShadowText2=require("./../views/Text/RCTShadowText");var _RCTShadowText3=_interopRequireDefault(_RCTShadowText2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};Object['ke'+'ys'](descriptor).forEach(function(key){desc[key]=descriptor[key];});desc.enumerable=!!desc.enumerable;desc.configurable=!!desc.configurable;if('value'in desc||desc.initializer){desc.writable=true;}desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc;},desc);if(context&&desc.initializer!==void 0){desc.value=desc.initializer?desc.initializer.call(context):void 0;desc.initializer=undefined;}if(desc.initializer===void 0){Object['define'+'Property'](target,property,desc);desc=null;}return desc;}var rootTagCounter=0;function byPosition(a,b){if(a===b)return 0;if(!a.compareDocumentPosition){return b.sourceIndex-a.sourceIndex;}if(a.compareDocumentPosition(b)&2){return-1;}return 1;}function reactViewFromPoint(topView,x,y){var element,elements=[];var old_visibility=[];while(true){element=document.elementFromPoint(x,y);if(!element||element===document.documentElement){break;}elements.push(element);old_visibility.push(element.style.visibility);element.style.visibility="hidden";}for(var k=0;k<elements.length;k++){elements[k].style.visibility=old_visibility[k];}elements=elements.filter(function(elem){return topView.contains(elem)&&elem instanceof _UIView2.default;});elements.sort(byPosition);return elements[0];}module.exports=function _callee(){var _dec,_dec2,_dec3,_dec4,_dec5,_dec6,_dec7,_dec8,_dec9,_dec10,_dec11,_dec12,_dec13,_dec14,_class,_desc,_value,_class2;var RCTShadowView,RCTRootShadowView,RCTShadowText,RCTUIManager;return _regenerator2.default.async(function _callee$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regenerator2.default.awrap(_RCTShadowView3.default);case 2:RCTShadowView=_context4.sent;_context4.next=5;return _regenerator2.default.awrap(_RCTRootShadowView3.default);case 5:RCTRootShadowView=_context4.sent;_context4.next=8;return _regenerator2.default.awrap(_RCTShadowText3.default);case 8:RCTShadowText=_context4.sent;RCTUIManager=(_dec=(0,_RCTBridge.RCT_EXPORT_MODULE)("RCTUIManager"),_dec2=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec3=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec4=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec5=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec6=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec7=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec8=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec9=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec10=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec11=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec12=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec13=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec14=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec(_class=(_class2=function(){function RCTUIManager(bridge){var _this=this;(0,_classCallCheck3.default)(this,RCTUIManager);this.pendingUIBlocks=[];this.didUpdateDimensions=function(_ref){var _ref$window=_ref.window,width=_ref$window.width,height=_ref$window.height,scale=_ref$window.scale;var _loop=function _loop(rootViewTag){var rootView=_this.viewRegistry.get(rootViewTag);(0,_Invariant2.default)(rootView,"Root view must exist");(0,_Invariant2.default)(rootView instanceof _RCTRootView2.default,"View must be an RCTRootView");_this.addUIBlock(function(){_this.setAvailableSize({width:width,height:height},scale,rootView);});};for(var _iterator=_this.rootViewTags,_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[typeof Symbol==="function"?typeof Symbol==="function"?typeof Symbol==="function"?Symbol.iterator:"@@iterator":"@@iterator":"@@iterator"]();;){var _ref2;if(_isArray){if(_i>=_iterator.length)break;_ref2=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;_ref2=_i.value;}var rootViewTag=_ref2;_loop(rootViewTag);}_this.requestTick();};this.bridge=bridge;this.shadowViewRegistry=new Map();this.viewRegistry=new Map();this.rootViewTags=new Set();this.componentDataByName=new Map();this.bridge.moduleClasses.forEach(function(moduleClass){if(moduleClass.__isViewManager){var componentData=new _RCTComponentData2.default(moduleClass,_this.bridge);_this.componentDataByName.set(componentData.name,componentData);}});this.layoutAnimationManager=new _RCTLayoutAnimationManager2.default(this);this.observerCoordinator=new _RCTUIManagerObserver2.default();(0,_Invariant2.default)(this.bridge,"Bridge must be set");var deviceInfoModule=this.bridge.modulesByName["DeviceInfo"];deviceInfoModule.addListener("didUpdateDimensions",this.didUpdateDimensions);}(0,_createClass3.default)(RCTUIManager,[{key:"registerRootView",value:function registerRootView(rootView){var reactTag=rootView.reactTag;var availableSize=rootView.availableSize;this.viewRegistry.set(reactTag,rootView);var shadowView=new RCTRootShadowView();shadowView.availableSize=availableSize;shadowView.reactTag=reactTag;shadowView.viewName=rootView.constructor.name;var pixelRatio=this.bridge.deviceInfo.getDevicePixelRatio();shadowView.updatePointScaleFactor(pixelRatio);this.shadowViewRegistry.set(reactTag,shadowView);this.rootViewTags.add(reactTag);}},{key:"setAvailableSize",value:function setAvailableSize(size,scale,rootView){var _this2=this;this.pendingUIBlocks.push(function(){var reactTag=rootView.reactTag;var rootShadowView=_this2.shadowViewRegistry.get(reactTag);if(rootShadowView&&rootShadowView instanceof RCTRootShadowView)rootShadowView.updateAvailableSize(size)&&rootShadowView.updatePointScaleFactor(scale);});}},{key:"setLocalDataForView",value:function setLocalDataForView(localData,view){var tag=view.reactTag;var shadowView=this.shadowViewRegistry.get(tag);if(shadowView==null){console.warn("Could not locate shadow view with tag "+tag+", this is probably caused by a temporary inconsistency between native views and shadow views.");return;}shadowView.localData=localData;this.requestTick();}},{key:"rootViewForReactTag",value:function rootViewForReactTag(reactTag,completion){}},{key:"viewNameForReactTag",value:function viewNameForReactTag(reactTag){var shadowView=this.shadowViewRegistry.get(reactTag);(0,_Invariant2.default)(shadowView,"No such shadowView with id "+reactTag);return shadowView.viewName;}},{key:"purgeView",value:function purgeView(reactTag){var shadowView=this.shadowViewRegistry.get(reactTag);if(shadowView){this.shadowViewRegistry.delete(reactTag);shadowView.purge();}if(this.layoutAnimationManager.isPending()){var view=this.viewRegistry.get(reactTag);if(view&&view.reactSuperview){view.reactSuperview.removeReactSubview(view);}this.layoutAnimationManager.queueRemovedNode(reactTag);}else{this.addUIBlock(function(uiManager,viewRegistry){var view=viewRegistry.get(reactTag);viewRegistry.delete(reactTag);if(view){view.purge();}});}}},{key:"frame",value:function frame(){var _this3=this;return _regenerator2.default.async(function frame$(_context){while(1){switch(_context.prev=_context.next){case 0:this.observerCoordinator.uiManagerWillPerformLayout(this);this.rootViewTags.forEach(function(rootTag){var rootShadowView=_this3.shadowViewRegistry.get(rootTag);if(rootShadowView!=null&&rootShadowView.isDirty){(0,_Invariant2.default)(rootShadowView instanceof RCTRootShadowView,"attempting to recalculate from shadowView that isn't root");var layoutChanges=(0,_Instrument2.default)("⚛️ Layout",function(){return rootShadowView.recalculateLayout();});if(_this3.layoutAnimationManager.isPending()){_this3.layoutAnimationManager.addLayoutChanges(layoutChanges);}else{_this3.applyLayoutChanges(layoutChanges);}}});this.observerCoordinator.uiManagerDidPerformLayout(this);if(this.layoutAnimationManager.isPending()){(0,_Instrument2.default)("⚛️ LayoutAnimation Construction",function(){_this3.layoutAnimationManager.applyLayoutChanges();});}this.observerCoordinator.uiManagerWillFlushBlocks(this);(0,_Instrument2.default)("⚛️ Style",function(){if(_this3.pendingUIBlocks.length>0){var uiBlocks=[].concat((0,_toConsumableArray3.default)(_this3.pendingUIBlocks));_this3.pendingUIBlocks=[];uiBlocks.forEach(function(block){block.call(null,_this3,_this3.viewRegistry);});_this3.requestTick();}});case 6:case"end":return _context.stop();}}},null,this);}},{key:"shouldContinue",value:function shouldContinue(){return this.pendingUIBlocks.length!==0;}},{key:"requestTick",value:function requestTick(){var _this4=this;this.rootViewTags.forEach(function(rootViewTag){var rootView=_this4.viewRegistry.get(rootViewTag);(0,_Invariant2.default)(rootView&&rootView instanceof _RCTRootView2.default,"RootView (with ID "+rootViewTag+") does not exist");rootView.requestTick();});}},{key:"applyLayoutChanges",value:function applyLayoutChanges(layoutChanges){var _this5=this;layoutChanges.forEach(function(layoutChange){var reactTag=layoutChange.reactTag,layout=layoutChange.layout;_this5.addUIBlock(function(uiManager,viewRegistry){var view=viewRegistry.get(reactTag);(0,_Invariant2.default)(view,"View with reactTag "+reactTag+" does not exist");view.frame=layout;});});}},{key:"measure",value:function measure(reactTag,callbackId){var _this6=this;return new Promise(function(resolve,reject){_this6.addUIBlock(function(){var shadowView=_this6.shadowViewRegistry.get(reactTag);var view=_this6.viewRegistry.get(reactTag);if(!shadowView||!shadowView.measurement){return;}var _shadowView$measureGl=shadowView.measureGlobal(),globalX=_shadowView$measureGl.globalX,globalY=_shadowView$measureGl.globalY;(0,_Invariant2.default)(shadowView.previousLayout,"Shadow view has no previous layout");var _shadowView$previousL=shadowView.previousLayout,left=_shadowView$previousL.left,top=_shadowView$previousL.top,width=_shadowView$previousL.width,height=_shadowView$previousL.height;if(callbackId!=null){_this6.bridge.callbackFromId(callbackId)(left,top,width,height,globalX,globalY);}else{resolve({left:left,top:top,width:width,height:height,globalX:globalX,globalY:globalY});}});});}},{key:"measureInWindow",value:function measureInWindow(reactTag,callbackId){var result,globalX,globalY,width,height;return _regenerator2.default.async(function measureInWindow$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regenerator2.default.awrap(this.measure(reactTag));case 2:result=_context2.sent;(0,_Invariant2.default)(result,"No measurement available for view "+reactTag);globalX=result.globalX,globalY=result.globalY,width=result.width,height=result.height;this.bridge.callbackFromId(callbackId)(globalX,globalY,width,height);case 6:case"end":return _context2.stop();}}},null,this);}},{key:"setJSResponder",value:function setJSResponder(reactTag){this.jsResponder=this.viewRegistry.get(reactTag);if(!this.jsResponder){console.error("Invalid view set to be the JS responder - tag "+reactTag);}}},{key:"clearJSResponder",value:function clearJSResponder(){this.jsResponder=null;}},{key:"configureNextLayoutAnimation",value:function configureNextLayoutAnimation(config,onAnimationDidEnd){if(!_CanUse2.default.matchMedia||!window.matchMedia("(prefers-reduced-motion: reduce)").matches){this.layoutAnimationManager.configureNext(config,this.bridge.callbackFromId(onAnimationDidEnd));}}},{key:"addUIBlock",value:function addUIBlock(block){if(block==null||this.viewRegistry==null){return;}this.pendingUIBlocks.push(block);}},{key:"prependUIBlock",value:function prependUIBlock(block){if(!block){return;}this.pendingUIBlocks.unshift(block);}},{key:"setChildren",value:function setChildren(containerTag,reactTags){RCTUIManager.RCTSetChildren(containerTag,reactTags,this.shadowViewRegistry);this.addUIBlock(function(uiManager,viewRegistry){RCTUIManager.RCTSetChildren(containerTag,reactTags,viewRegistry);});}},{key:"createView",value:function createView(reactTag,viewName,rootTag,props){var componentData=this.componentDataByName.get(viewName);(0,_Invariant2.default)(componentData,"No component found for view with name "+viewName);var shadowView=componentData.createShadowView(reactTag);if(shadowView!=null){shadowView.viewName=viewName;componentData.setPropsForShadowView(props,shadowView);this.shadowViewRegistry.set(reactTag,shadowView);}var backgroundColor=shadowView.backgroundColor;var view=componentData.createView(reactTag);if(view!=null){componentData.setPropsForView(props,view);if(typeof view.setBackgroundColor==="function"){view.setBackgroundColor(backgroundColor);}this.viewRegistry.set(reactTag,view);}}},{key:"updateView",value:function updateView(reactTag,viewName,updatedProps){var componentData=this.componentDataByName.get(viewName);(0,_Invariant2.default)(componentData,"No component found for view with name "+viewName);var shadowView=this.shadowViewRegistry.get(reactTag);if(shadowView){componentData.setPropsForShadowView(updatedProps,shadowView);}var view=this.viewRegistry.get(reactTag);if(view){componentData.setPropsForView(updatedProps,view);}}},{key:"synchronouslyUpdateView",value:function synchronouslyUpdateView(reactTag,viewName,props){var componentData=this.componentDataByName.get(viewName);(0,_Invariant2.default)(componentData,"No component found for view with name "+viewName);var view=this.viewRegistry.get(reactTag);if(view){componentData.setPropsForView(props,view);}}},{key:"replaceExistingNonRootView",value:function replaceExistingNonRootView(reactTag,newReactTag){var shadowView=this.shadowViewRegistry.get(reactTag);(0,_Invariant2.default)(shadowView,"shadowView (for ID "+reactTag+") not found");var superShadowView=shadowView.reactSuperview;(0,_Invariant2.default)(superShadowView,"shadowView super (of ID "+reactTag+") not found");var indexOfView=superShadowView.reactSubviews.indexOf(shadowView);(0,_Invariant2.default)(indexOfView!==-1,"View's superview does't claim it as subview");var removeAtIndices=[indexOfView];var addTags=[newReactTag];this.manageChildren(superShadowView.reactTag,null,null,addTags,removeAtIndices,removeAtIndices);}},{key:"findSubviewIn",value:function findSubviewIn(reactTag,atPoint,callbackId){var _atPoint,x,y,view,target,measurement,globalX,globalY,width,height;return _regenerator2.default.async(function findSubviewIn$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_atPoint=(0,_slicedToArray3.default)(atPoint,2),x=_atPoint[0],y=_atPoint[1];view=this.viewRegistry.get(reactTag);(0,_Invariant2.default)(view,"No such view with tag "+reactTag);target=reactViewFromPoint(view,x,y);if(!(!target||!(target instanceof _UIView2.default))){_context3.next=6;break;}return _context3.abrupt("return");case 6:_context3.next=8;return _regenerator2.default.awrap(this.measure(target.reactTag));case 8:measurement=_context3.sent;(0,_Invariant2.default)(measurement,"View with tag "+target.reactTag+" has no measurement");globalX=measurement.globalX,globalY=measurement.globalY,width=measurement.width,height=measurement.height;this.bridge.callbackFromId(callbackId)(target.reactTag,globalX,globalY,width,height);case 12:case"end":return _context3.stop();}}},null,this);}},{key:"manageChildren",value:function manageChildren(tag,moveFrom,moveTo,addChildTags,addAtIndices,removeFrom){var _this7=this;var viewToManage=this.viewRegistry.get(tag);var shadowViewToManage=this.shadowViewRegistry.get(tag);if(!viewToManage||!shadowViewToManage)return;var numToMove=!moveFrom?0:moveFrom.length;var viewsToAdd=[];var indicesToRemove=[];var tagsToRemove=[];var tagsToDelete=[];if(moveFrom&&moveTo){for(var i=0;i<moveFrom.length;i++){var moveFromIndex=moveFrom[i];var tagToMove=viewToManage.reactSubviews[moveFromIndex].reactTag;viewsToAdd[i]={tag:tagToMove,index:moveTo[i]};indicesToRemove[i]=moveFromIndex;tagsToRemove[i]=tagToMove;}}if(addChildTags){for(var _i2=0;_i2<addChildTags.length;_i2++){var viewTagToAdd=addChildTags[_i2];var indexToAddAt=addAtIndices[_i2];viewsToAdd[numToMove+_i2]={tag:viewTagToAdd,index:indexToAddAt};}}if(removeFrom){for(var _i3=0;_i3<removeFrom.length;_i3++){var indexToRemove=removeFrom[_i3];if(viewToManage.reactSubviews[indexToRemove]){var tagToRemove=viewToManage.reactSubviews[indexToRemove].reactTag;indicesToRemove[numToMove+_i3]=indexToRemove;tagsToRemove[numToMove+_i3]=tagToRemove;tagsToDelete[_i3]=tagToRemove;}}}viewsToAdd.sort(function(a,b){return a.index-b.index;});indicesToRemove.sort(function(a,b){return a-b;});var _loop2=function _loop2(_i4){var childIndex=indicesToRemove[_i4];var shadowSubView=undefined;if(shadowViewToManage instanceof RCTShadowText){shadowSubView=shadowViewToManage.textChildren[childIndex];}else{shadowSubView=shadowViewToManage.reactSubviews[childIndex];}if(shadowSubView)shadowViewToManage.removeReactSubview(shadowSubView);if(!_this7.layoutAnimationManager.isPending()){_this7.addUIBlock(function(uiManager,viewRegistry){var subView=viewToManage.reactSubviews[childIndex];viewToManage.removeReactSubview(subView);});}};for(var _i4=indicesToRemove.length-1;_i4>=0;_i4--){_loop2(_i4);}var _loop3=function _loop3(_i5){var _viewsToAdd$_i=viewsToAdd[_i5],tagToAdd=_viewsToAdd$_i.tag,indexToAdd=_viewsToAdd$_i.index;var shadowSubView=_this7.shadowViewRegistry.get(tagToAdd);if(shadowSubView){shadowViewToManage.insertReactSubviewAtIndex(shadowSubView,indexToAdd);shadowSubView.makeDirty();}_this7.addUIBlock(function(uiManager,viewRegistry){var subView=viewRegistry.get(tagToAdd);(0,_Invariant2.default)(subView,"Attempted to insert subview with tag "+tagToAdd+" that does not exist");viewToManage.insertReactSubviewAtIndex(subView,indexToAdd);});};for(var _i5=0;_i5<viewsToAdd.length;_i5++){_loop3(_i5);}for(var _i6=0;_i6<tagsToDelete.length;_i6++){this.purgeView(tagsToDelete[_i6]);}}},{key:"focus",value:function focus(reactTag){}},{key:"blur",value:function blur(reactTag){}},{key:"constantsToExport",value:function constantsToExport(){var constants={};var bubblingEvents={};var directEvents={};for(var _iterator2=this.componentDataByName,_isArray2=Array.isArray(_iterator2),_i7=0,_iterator2=_isArray2?_iterator2:_iterator2[typeof Symbol==="function"?typeof Symbol==="function"?Symbol.iterator:"@@iterator":"@@iterator"]();;){var _ref5;if(_isArray2){if(_i7>=_iterator2.length)break;_ref5=_iterator2[_i7++];}else{_i7=_iterator2.next();if(_i7.done)break;_ref5=_i7.value;}var _ref3=_ref5;var _ref4=(0,_slicedToArray3.default)(_ref3,2);var name=_ref4[0];var componentData=_ref4[1];var moduleConstants={};var bubblingEventTypes={};var directEventTypes={};moduleConstants.Manager=(0,_RCTBridge.bridgeModuleNameForClass)(componentData.managerClass);var viewConfig=componentData.viewConfig;moduleConstants.NativeProps=viewConfig.propTypes;moduleConstants.baseModuleName=viewConfig.baseModuleName;for(var _iterator3=viewConfig.directEvents,_isArray3=Array.isArray(_iterator3),_i8=0,_iterator3=_isArray3?_iterator3:_iterator3[typeof Symbol==="function"?typeof Symbol==="function"?Symbol.iterator:"@@iterator":"@@iterator"]();;){var _ref6;if(_isArray3){if(_i8>=_iterator3.length)break;_ref6=_iterator3[_i8++];}else{_i8=_iterator3.next();if(_i8.done)break;_ref6=_i8.value;}var eventName=_ref6;if(!directEvents[eventName]){directEvents[eventName]={registrationName:"on"+eventName.substring(3)};}directEventTypes[eventName]=directEvents[eventName];}moduleConstants.directEventTypes=directEventTypes;for(var _iterator4=viewConfig.bubblingEvents,_isArray4=Array.isArray(_iterator4),_i9=0,_iterator4=_isArray4?_iterator4:_iterator4[typeof Symbol==="function"?typeof Symbol==="function"?Symbol.iterator:"@@iterator":"@@iterator"]();;){var _ref7;if(_isArray4){if(_i9>=_iterator4.length)break;_ref7=_iterator4[_i9++];}else{_i9=_iterator4.next();if(_i9.done)break;_ref7=_i9.value;}var _eventName=_ref7;if(!bubblingEvents[_eventName]){var bubbleName="on"+_eventName.substring(3);bubblingEvents[_eventName]={phasedRegistrationNames:{bubbled:bubbleName,captured:bubbleName+"Capture"}};}bubblingEventTypes[_eventName]=bubblingEvents[_eventName];}moduleConstants.bubblingEventTypes=bubblingEventTypes;constants[name]=moduleConstants;}return constants;}},{key:"allocateRootTag",get:function get(){var tag=rootTagCounter;rootTagCounter++;return tag*10+1;}}],[{key:"RCTSetChildren",value:function RCTSetChildren(containerTag,reactTags,registry){var container=registry.get(containerTag);var index=0;reactTags.forEach(function(reactTag){var view=registry.get(reactTag);(0,_Invariant2.default)(container,"No container view found with id: "+containerTag);(0,_Invariant2.default)(view,"No view found with id: "+reactTag);container.insertReactSubviewAtIndex(view,index++);});}}]);return RCTUIManager;}(),(_applyDecoratedDescriptor(_class2.prototype,"measure",[_dec2],Object.getOwnPropertyDescriptor(_class2.prototype,"measure"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"measureInWindow",[_dec3],Object.getOwnPropertyDescriptor(_class2.prototype,"measureInWindow"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setJSResponder",[_dec4],Object.getOwnPropertyDescriptor(_class2.prototype,"setJSResponder"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"clearJSResponder",[_dec5],Object.getOwnPropertyDescriptor(_class2.prototype,"clearJSResponder"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"configureNextLayoutAnimation",[_dec6],Object.getOwnPropertyDescriptor(_class2.prototype,"configureNextLayoutAnimation"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setChildren",[_dec7],Object.getOwnPropertyDescriptor(_class2.prototype,"setChildren"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"createView",[_dec8],Object.getOwnPropertyDescriptor(_class2.prototype,"createView"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"updateView",[_dec9],Object.getOwnPropertyDescriptor(_class2.prototype,"updateView"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"replaceExistingNonRootView",[_dec10],Object.getOwnPropertyDescriptor(_class2.prototype,"replaceExistingNonRootView"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"findSubviewIn",[_dec11],Object.getOwnPropertyDescriptor(_class2.prototype,"findSubviewIn"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"manageChildren",[_dec12],Object.getOwnPropertyDescriptor(_class2.prototype,"manageChildren"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"focus",[_dec13],Object.getOwnPropertyDescriptor(_class2.prototype,"focus"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"blur",[_dec14],Object.getOwnPropertyDescriptor(_class2.prototype,"blur"),_class2.prototype)),_class2))||_class);return _context4.abrupt("return",RCTUIManager);case 11:case"end":return _context4.stop();}}},null,_this8);}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL1JlYWN0RG9tL21vZHVsZXMvUkNUVUlNYW5hZ2VyLmpzIl0sIm5hbWVzIjpbInJvb3RUYWdDb3VudGVyIiwiYnlQb3NpdGlvbiIsImEiLCJiIiwiY29tcGFyZURvY3VtZW50UG9zaXRpb24iLCJzb3VyY2VJbmRleCIsInJlYWN0Vmlld0Zyb21Qb2ludCIsInRvcFZpZXciLCJ4IiwieSIsImVsZW1lbnQiLCJlbGVtZW50cyIsIm9sZF92aXNpYmlsaXR5IiwiZG9jdW1lbnQiLCJlbGVtZW50RnJvbVBvaW50IiwiZG9jdW1lbnRFbGVtZW50IiwicHVzaCIsInN0eWxlIiwidmlzaWJpbGl0eSIsImsiLCJsZW5ndGgiLCJmaWx0ZXIiLCJlbGVtIiwiY29udGFpbnMiLCJzb3J0IiwibW9kdWxlIiwiZXhwb3J0cyIsIlJDVFNoYWRvd1ZpZXciLCJSQ1RSb290U2hhZG93VmlldyIsIlJDVFNoYWRvd1RleHQiLCJSQ1RVSU1hbmFnZXIiLCJicmlkZ2UiLCJwZW5kaW5nVUlCbG9ja3MiLCJkaWRVcGRhdGVEaW1lbnNpb25zIiwid2luZG93Iiwid2lkdGgiLCJoZWlnaHQiLCJzY2FsZSIsInJvb3RWaWV3VGFnIiwicm9vdFZpZXciLCJ2aWV3UmVnaXN0cnkiLCJnZXQiLCJhZGRVSUJsb2NrIiwic2V0QXZhaWxhYmxlU2l6ZSIsInJvb3RWaWV3VGFncyIsInJlcXVlc3RUaWNrIiwic2hhZG93Vmlld1JlZ2lzdHJ5IiwiTWFwIiwiU2V0IiwiY29tcG9uZW50RGF0YUJ5TmFtZSIsIm1vZHVsZUNsYXNzZXMiLCJmb3JFYWNoIiwibW9kdWxlQ2xhc3MiLCJfX2lzVmlld01hbmFnZXIiLCJjb21wb25lbnREYXRhIiwic2V0IiwibmFtZSIsImxheW91dEFuaW1hdGlvbk1hbmFnZXIiLCJvYnNlcnZlckNvb3JkaW5hdG9yIiwiZGV2aWNlSW5mb01vZHVsZSIsIm1vZHVsZXNCeU5hbWUiLCJhZGRMaXN0ZW5lciIsInJlYWN0VGFnIiwiYXZhaWxhYmxlU2l6ZSIsInNoYWRvd1ZpZXciLCJ2aWV3TmFtZSIsImNvbnN0cnVjdG9yIiwicGl4ZWxSYXRpbyIsImRldmljZUluZm8iLCJnZXREZXZpY2VQaXhlbFJhdGlvIiwidXBkYXRlUG9pbnRTY2FsZUZhY3RvciIsImFkZCIsInNpemUiLCJyb290U2hhZG93VmlldyIsInVwZGF0ZUF2YWlsYWJsZVNpemUiLCJsb2NhbERhdGEiLCJ2aWV3IiwidGFnIiwiY29uc29sZSIsIndhcm4iLCJjb21wbGV0aW9uIiwiZGVsZXRlIiwicHVyZ2UiLCJpc1BlbmRpbmciLCJyZWFjdFN1cGVydmlldyIsInJlbW92ZVJlYWN0U3VidmlldyIsInF1ZXVlUmVtb3ZlZE5vZGUiLCJ1aU1hbmFnZXIiLCJ1aU1hbmFnZXJXaWxsUGVyZm9ybUxheW91dCIsInJvb3RUYWciLCJpc0RpcnR5IiwibGF5b3V0Q2hhbmdlcyIsInJlY2FsY3VsYXRlTGF5b3V0IiwiYWRkTGF5b3V0Q2hhbmdlcyIsImFwcGx5TGF5b3V0Q2hhbmdlcyIsInVpTWFuYWdlckRpZFBlcmZvcm1MYXlvdXQiLCJ1aU1hbmFnZXJXaWxsRmx1c2hCbG9ja3MiLCJ1aUJsb2NrcyIsImJsb2NrIiwiY2FsbCIsImxheW91dENoYW5nZSIsImxheW91dCIsImZyYW1lIiwiY2FsbGJhY2tJZCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwibWVhc3VyZW1lbnQiLCJtZWFzdXJlR2xvYmFsIiwiZ2xvYmFsWCIsImdsb2JhbFkiLCJwcmV2aW91c0xheW91dCIsImxlZnQiLCJ0b3AiLCJjYWxsYmFja0Zyb21JZCIsIm1lYXN1cmUiLCJyZXN1bHQiLCJqc1Jlc3BvbmRlciIsImVycm9yIiwiY29uZmlnIiwib25BbmltYXRpb25EaWRFbmQiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsImNvbmZpZ3VyZU5leHQiLCJ1bnNoaWZ0IiwiY29udGFpbmVyVGFnIiwicmVhY3RUYWdzIiwiUkNUU2V0Q2hpbGRyZW4iLCJwcm9wcyIsImNyZWF0ZVNoYWRvd1ZpZXciLCJzZXRQcm9wc0ZvclNoYWRvd1ZpZXciLCJiYWNrZ3JvdW5kQ29sb3IiLCJjcmVhdGVWaWV3Iiwic2V0UHJvcHNGb3JWaWV3Iiwic2V0QmFja2dyb3VuZENvbG9yIiwidXBkYXRlZFByb3BzIiwibmV3UmVhY3RUYWciLCJzdXBlclNoYWRvd1ZpZXciLCJpbmRleE9mVmlldyIsInJlYWN0U3Vidmlld3MiLCJpbmRleE9mIiwicmVtb3ZlQXRJbmRpY2VzIiwiYWRkVGFncyIsIm1hbmFnZUNoaWxkcmVuIiwiYXRQb2ludCIsInRhcmdldCIsIm1vdmVGcm9tIiwibW92ZVRvIiwiYWRkQ2hpbGRUYWdzIiwiYWRkQXRJbmRpY2VzIiwicmVtb3ZlRnJvbSIsInZpZXdUb01hbmFnZSIsInNoYWRvd1ZpZXdUb01hbmFnZSIsIm51bVRvTW92ZSIsInZpZXdzVG9BZGQiLCJpbmRpY2VzVG9SZW1vdmUiLCJ0YWdzVG9SZW1vdmUiLCJ0YWdzVG9EZWxldGUiLCJpIiwibW92ZUZyb21JbmRleCIsInRhZ1RvTW92ZSIsImluZGV4Iiwidmlld1RhZ1RvQWRkIiwiaW5kZXhUb0FkZEF0IiwiaW5kZXhUb1JlbW92ZSIsInRhZ1RvUmVtb3ZlIiwiY2hpbGRJbmRleCIsInNoYWRvd1N1YlZpZXciLCJ1bmRlZmluZWQiLCJ0ZXh0Q2hpbGRyZW4iLCJzdWJWaWV3IiwidGFnVG9BZGQiLCJpbmRleFRvQWRkIiwiaW5zZXJ0UmVhY3RTdWJ2aWV3QXRJbmRleCIsIm1ha2VEaXJ0eSIsInB1cmdlVmlldyIsImNvbnN0YW50cyIsImJ1YmJsaW5nRXZlbnRzIiwiZGlyZWN0RXZlbnRzIiwibW9kdWxlQ29uc3RhbnRzIiwiYnViYmxpbmdFdmVudFR5cGVzIiwiZGlyZWN0RXZlbnRUeXBlcyIsIk1hbmFnZXIiLCJtYW5hZ2VyQ2xhc3MiLCJ2aWV3Q29uZmlnIiwiTmF0aXZlUHJvcHMiLCJwcm9wVHlwZXMiLCJiYXNlTW9kdWxlTmFtZSIsImV2ZW50TmFtZSIsInJlZ2lzdHJhdGlvbk5hbWUiLCJzdWJzdHJpbmciLCJidWJibGVOYW1lIiwicGhhc2VkUmVnaXN0cmF0aW9uTmFtZXMi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LENBQUwsQ0FBZ0MsQ0FDOUIsR0FBTUcsaUJBQWtCSCxXQUFVRSxTQUFWLENBQW9CLENBQXBCLENBQXhCLENBQ0FiLGVBQWVXLFVBQWYsRUFBNEIsQ0FDMUJJLHdCQUF5QixDQUN2QkMsUUFBU0YsVUFEYyxDQUV2QkcsU0FBYUgsVUFBYixVQUZ1QixDQURDLENBQTVCLENBTUQsQ0FDRFgsbUJBQW1CUSxVQUFuQixFQUFnQ1gsZUFBZVcsVUFBZixDQUFoQyxDQUNELENBQ0RULGdCQUFnQkMsa0JBQWhCLENBQXFDQSxrQkFBckMsQ0FFQUosVUFBVXhILElBQVYsRUFBa0IySCxlQUFsQixDQUNELENBRUQsTUFBT0gsVUFBUCxDQUNELENBeHJCYSwyQ0FzRWdCLENBQzVCLEdBQU1uRyxLQUFNN0UsY0FBWixDQUNBQSxpQkFDQSxNQUFPNkUsS0FBTSxFQUFOLENBQVcsQ0FBbEIsQ0FDRCxDQTFFYSx3REFrV1pnRCxZQWxXWSxDQW1XWkMsU0FuV1ksQ0FvV1pxRSxRQXBXWSxDQXFXWixDQUNBLEdBQU1DLFdBQVlELFNBQVMxSixHQUFULENBQWFvRixZQUFiLENBQWxCLENBQ0EsR0FBSW9DLE9BQVEsQ0FBWixDQUNBbkMsVUFBVTNFLE9BQVYsQ0FBa0IsU0FBQ1csUUFBRCxDQUFjLENBQzlCLEdBQU1jLE1BQU91SCxTQUFTMUosR0FBVCxDQUFhcUIsUUFBYixDQUFiLENBQ0Esd0JBQ0VzSSxTQURGLHFDQUVzQ3ZFLFlBRnRDLEVBSUEsd0JBQVVqRCxJQUFWLDJCQUEwQ2QsUUFBMUMsRUFDQXNJLFVBQVV2Qix5QkFBVixDQUFvQ2pHLElBQXBDLENBQTBDcUYsT0FBMUMsRUFDRCxDQVJELEVBU0QsQ0FqWGEsaWpFQTJyQlRuSSxZQTNyQlMsOERBQUQsRUFBakIiLCJmaWxlIjoiUkNUVUlNYW5hZ2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAcHJvdmlkZXNNb2R1bGUgUkNUVUlNYW5hZ2VyXG4gKiBAZmxvd1xuICovXG5cbmltcG9ydCBpbnZhcmlhbnQgZnJvbSBcIkludmFyaWFudFwiO1xuaW1wb3J0IFJDVEJyaWRnZSwge1xuICBSQ1RfRVhQT1JUX01PRFVMRSxcbiAgUkNUX0VYUE9SVF9NRVRIT0QsXG4gIGJyaWRnZU1vZHVsZU5hbWVGb3JDbGFzcyxcbiAgUkNURnVuY3Rpb25UeXBlTm9ybWFsXG59IGZyb20gXCJSQ1RCcmlkZ2VcIjtcbmltcG9ydCBVSVZpZXcgZnJvbSBcIlVJVmlld1wiO1xuaW1wb3J0IFJDVFZpZXcgZnJvbSBcIlJDVFZpZXdcIjtcbmltcG9ydCBSQ1RSb290VmlldyBmcm9tIFwiUkNUUm9vdFZpZXdcIjtcbmltcG9ydCBSQ1REZXZpY2VJbmZvIGZyb20gXCJSQ1REZXZpY2VJbmZvXCI7XG5pbXBvcnQgUkNUTGF5b3V0QW5pbWF0aW9uTWFuYWdlciBmcm9tIFwiUkNUTGF5b3V0QW5pbWF0aW9uTWFuYWdlclwiO1xuaW1wb3J0IFJDVFVJTWFuYWdlck9ic2VydmVyQ29vcmRpbmF0b3IgZnJvbSBcIlJDVFVJTWFuYWdlck9ic2VydmVyQ29vcmRpbmF0b3JcIjtcbmltcG9ydCBSQ1RDb21wb25lbnREYXRhIGZyb20gXCJSQ1RDb21wb25lbnREYXRhXCI7XG5pbXBvcnQgQ2FuVXNlIGZyb20gXCJDYW5Vc2VcIjtcbmltcG9ydCBpbnN0cnVtZW50IGZyb20gXCJJbnN0cnVtZW50XCI7XG5cbmltcG9ydCB0eXBlIHsgUkNUQ29tcG9uZW50IH0gZnJvbSBcIlJDVENvbXBvbmVudFwiO1xuaW1wb3J0IHR5cGUgeyBMYXlvdXRDaGFuZ2UgfSBmcm9tIFwiUkNUU2hhZG93Vmlld1wiO1xuaW1wb3J0IHR5cGUgeyBMYXlvdXRBbmltYXRpb25Db25maWcgfSBmcm9tIFwiUkNUTGF5b3V0QW5pbWF0aW9uTWFuYWdlclwiO1xuXG5pbXBvcnQgX1JDVFNoYWRvd1ZpZXcgZnJvbSBcIlJDVFNoYWRvd1ZpZXdcIjtcbmltcG9ydCBfUkNUUm9vdFNoYWRvd1ZpZXcgZnJvbSBcIlJDVFJvb3RTaGFkb3dWaWV3XCI7XG5pbXBvcnQgX1JDVFNoYWRvd1RleHQgZnJvbSBcIlJDVFNoYWRvd1RleHRcIjtcblxudHlwZSBTaGFkb3dWaWV3ID0gYW55O1xudHlwZSBTaXplID0geyB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciB9O1xuXG5sZXQgcm9vdFRhZ0NvdW50ZXIgPSAwO1xuXG5mdW5jdGlvbiBieVBvc2l0aW9uKGEsIGIpIHtcbiAgaWYgKGEgPT09IGIpIHJldHVybiAwO1xuICBpZiAoIWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24pIHtcbiAgICByZXR1cm4gYi5zb3VyY2VJbmRleCAtIGEuc291cmNlSW5kZXg7XG4gIH1cbiAgaWYgKGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYikgJiAyKSB7XG4gICAgcmV0dXJuIC0xO1xuICB9XG4gIHJldHVybiAxO1xufVxuXG4vLyBEb2Vzbid0IGdldCBtb3JlIGhhY2t5IHRoYW4gdGhpcyBmb2xrc1xuZnVuY3Rpb24gcmVhY3RWaWV3RnJvbVBvaW50KHRvcFZpZXc6IFVJVmlldywgeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgdmFyIGVsZW1lbnQsXG4gICAgZWxlbWVudHMgPSBbXTtcbiAgdmFyIG9sZF92aXNpYmlsaXR5ID0gW107XG4gIHdoaWxlICh0cnVlKSB7XG4gICAgZWxlbWVudCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoeCwgeSk7XG4gICAgaWYgKCFlbGVtZW50IHx8IGVsZW1lbnQgPT09IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGVsZW1lbnRzLnB1c2goZWxlbWVudCk7XG4gICAgb2xkX3Zpc2liaWxpdHkucHVzaChlbGVtZW50LnN0eWxlLnZpc2liaWxpdHkpO1xuICAgIGVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7IC8vIFRlbXBvcmFyaWx5IGhpZGUgdGhlIGVsZW1lbnQgKHdpdGhvdXQgY2hhbmdpbmcgdGhlIGxheW91dClcbiAgfVxuICBmb3IgKHZhciBrID0gMDsgayA8IGVsZW1lbnRzLmxlbmd0aDsgaysrKSB7XG4gICAgZWxlbWVudHNba10uc3R5bGUudmlzaWJpbGl0eSA9IG9sZF92aXNpYmlsaXR5W2tdO1xuICB9XG5cbiAgZWxlbWVudHMgPSBlbGVtZW50cy5maWx0ZXIoXG4gICAgKGVsZW0pID0+IHRvcFZpZXcuY29udGFpbnMoZWxlbSkgJiYgZWxlbSBpbnN0YW5jZW9mIFVJVmlld1xuICApO1xuICBlbGVtZW50cy5zb3J0KGJ5UG9zaXRpb24pO1xuXG4gIHJldHVybiBlbGVtZW50c1swXTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSAoYXN5bmMgKCkgPT4ge1xuICBjb25zdCBSQ1RTaGFkb3dWaWV3ID0gYXdhaXQgX1JDVFNoYWRvd1ZpZXc7XG4gIGNvbnN0IFJDVFJvb3RTaGFkb3dWaWV3ID0gYXdhaXQgX1JDVFJvb3RTaGFkb3dWaWV3O1xuICBjb25zdCBSQ1RTaGFkb3dUZXh0ID0gYXdhaXQgX1JDVFNoYWRvd1RleHQ7XG5cbiAgdHlwZSBVSUJsb2NrID0gKFJDVFVJTWFuYWdlciwgTWFwPG51bWJlciwgVUlWaWV3PikgPT4gdm9pZDtcblxuICBAUkNUX0VYUE9SVF9NT0RVTEUoXCJSQ1RVSU1hbmFnZXJcIilcbiAgY2xhc3MgUkNUVUlNYW5hZ2VyIHtcbiAgICBicmlkZ2U6IFJDVEJyaWRnZTtcbiAgICByb290Vmlld1RhZ3M6IFNldDxudW1iZXI+O1xuICAgIHNoYWRvd1ZpZXdSZWdpc3RyeTogTWFwPG51bWJlciwgUkNUU2hhZG93Vmlldz47XG4gICAgdmlld1JlZ2lzdHJ5OiBNYXA8bnVtYmVyLCBVSVZpZXc+O1xuICAgIGNvbXBvbmVudERhdGFCeU5hbWU6IE1hcDxzdHJpbmcsIFJDVENvbXBvbmVudERhdGE+O1xuICAgIGpzUmVzcG9uZGVyOiA/VUlWaWV3O1xuICAgIGxheW91dEFuaW1hdGlvbk1hbmFnZXI6IFJDVExheW91dEFuaW1hdGlvbk1hbmFnZXI7XG4gICAgb2JzZXJ2ZXJDb29yZGluYXRvcjogUkNUVUlNYW5hZ2VyT2JzZXJ2ZXJDb29yZGluYXRvcjtcblxuICAgIHBlbmRpbmdVSUJsb2NrczogQXJyYXk8VUlCbG9jaz4gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKGJyaWRnZTogUkNUQnJpZGdlKSB7XG4gICAgICB0aGlzLmJyaWRnZSA9IGJyaWRnZTtcblxuICAgICAgdGhpcy5zaGFkb3dWaWV3UmVnaXN0cnkgPSBuZXcgTWFwKCk7XG4gICAgICB0aGlzLnZpZXdSZWdpc3RyeSA9IG5ldyBNYXAoKTtcblxuICAgICAgLy8gSW50ZXJuYWwgcmVzb3VyY2VzXG4gICAgICB0aGlzLnJvb3RWaWV3VGFncyA9IG5ldyBTZXQoKTtcblxuICAgICAgLy8gR2V0IHZpZXcgbWFuYWdlcnMgZnJvbSBicmlkZ2VcbiAgICAgIHRoaXMuY29tcG9uZW50RGF0YUJ5TmFtZSA9IG5ldyBNYXAoKTtcbiAgICAgIHRoaXMuYnJpZGdlLm1vZHVsZUNsYXNzZXMuZm9yRWFjaCgobW9kdWxlQ2xhc3M6IGFueSkgPT4ge1xuICAgICAgICBpZiAobW9kdWxlQ2xhc3MuX19pc1ZpZXdNYW5hZ2VyKSB7XG4gICAgICAgICAgY29uc3QgY29tcG9uZW50RGF0YSA9IG5ldyBSQ1RDb21wb25lbnREYXRhKG1vZHVsZUNsYXNzLCB0aGlzLmJyaWRnZSk7XG4gICAgICAgICAgdGhpcy5jb21wb25lbnREYXRhQnlOYW1lLnNldChjb21wb25lbnREYXRhLm5hbWUsIGNvbXBvbmVudERhdGEpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5sYXlvdXRBbmltYXRpb25NYW5hZ2VyID0gbmV3IFJDVExheW91dEFuaW1hdGlvbk1hbmFnZXIodGhpcyk7XG4gICAgICB0aGlzLm9ic2VydmVyQ29vcmRpbmF0b3IgPSBuZXcgUkNUVUlNYW5hZ2VyT2JzZXJ2ZXJDb29yZGluYXRvcigpO1xuXG4gICAgICBpbnZhcmlhbnQodGhpcy5icmlkZ2UsIFwiQnJpZGdlIG11c3QgYmUgc2V0XCIpO1xuICAgICAgY29uc3QgZGV2aWNlSW5mb01vZHVsZTogUkNURGV2aWNlSW5mbyA9ICh0aGlzLmJyaWRnZS5tb2R1bGVzQnlOYW1lW1xuICAgICAgICBcIkRldmljZUluZm9cIlxuICAgICAgXTogYW55KTtcbiAgICAgIGRldmljZUluZm9Nb2R1bGUuYWRkTGlzdGVuZXIoXG4gICAgICAgIFwiZGlkVXBkYXRlRGltZW5zaW9uc1wiLFxuICAgICAgICB0aGlzLmRpZFVwZGF0ZURpbWVuc2lvbnNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgZGlkVXBkYXRlRGltZW5zaW9ucyA9ICh7IHdpbmRvdzogeyB3aWR0aCwgaGVpZ2h0LCBzY2FsZSB9IH06IGFueSkgPT4ge1xuICAgICAgLy8gdGhpcy5icmlkZ2UuR2xvYmFsWW9nYUNvbmZpZy5zZXRQb2ludFNjYWxlRmFjdG9yKHNjYWxlKTtcblxuICAgICAgZm9yIChsZXQgcm9vdFZpZXdUYWcgb2YgdGhpcy5yb290Vmlld1RhZ3MpIHtcbiAgICAgICAgY29uc3Qgcm9vdFZpZXcgPSB0aGlzLnZpZXdSZWdpc3RyeS5nZXQocm9vdFZpZXdUYWcpO1xuXG4gICAgICAgIGludmFyaWFudChyb290VmlldywgXCJSb290IHZpZXcgbXVzdCBleGlzdFwiKTtcbiAgICAgICAgaW52YXJpYW50KFxuICAgICAgICAgIHJvb3RWaWV3IGluc3RhbmNlb2YgUkNUUm9vdFZpZXcsXG4gICAgICAgICAgXCJWaWV3IG11c3QgYmUgYW4gUkNUUm9vdFZpZXdcIlxuICAgICAgICApO1xuICAgICAgICB0aGlzLmFkZFVJQmxvY2soKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc2V0QXZhaWxhYmxlU2l6ZSh7IHdpZHRoLCBoZWlnaHQgfSwgc2NhbGUsIHJvb3RWaWV3KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucmVxdWVzdFRpY2soKTtcbiAgICB9O1xuXG4gICAgZ2V0IGFsbG9jYXRlUm9vdFRhZygpOiBudW1iZXIge1xuICAgICAgY29uc3QgdGFnID0gcm9vdFRhZ0NvdW50ZXI7XG4gICAgICByb290VGFnQ291bnRlcisrO1xuICAgICAgcmV0dXJuIHRhZyAqIDEwICsgMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBhIHJvb3QgdmlldyB3aXRoIHRoZSBSQ1RVSU1hbmFnZXIuXG4gICAgICovXG4gICAgcmVnaXN0ZXJSb290Vmlldyhyb290VmlldzogUkNUUm9vdFZpZXcpIHtcbiAgICAgIGNvbnN0IHJlYWN0VGFnID0gcm9vdFZpZXcucmVhY3RUYWc7XG4gICAgICBjb25zdCBhdmFpbGFibGVTaXplID0gcm9vdFZpZXcuYXZhaWxhYmxlU2l6ZTtcblxuICAgICAgLy8gcmVnaXN0ZXIgdmlld1xuICAgICAgdGhpcy52aWV3UmVnaXN0cnkuc2V0KHJlYWN0VGFnLCByb290Vmlldyk7XG5cbiAgICAgIC8vIHJlZ2lzdGVyIHNoYWRvdyB2aWV3XG4gICAgICBjb25zdCBzaGFkb3dWaWV3ID0gbmV3IFJDVFJvb3RTaGFkb3dWaWV3KCk7XG4gICAgICBzaGFkb3dWaWV3LmF2YWlsYWJsZVNpemUgPSBhdmFpbGFibGVTaXplO1xuICAgICAgc2hhZG93Vmlldy5yZWFjdFRhZyA9IHJlYWN0VGFnO1xuICAgICAgc2hhZG93Vmlldy52aWV3TmFtZSA9IHJvb3RWaWV3LmNvbnN0cnVjdG9yLm5hbWU7XG5cbiAgICAgIGNvbnN0IHBpeGVsUmF0aW8gPSB0aGlzLmJyaWRnZS5kZXZpY2VJbmZvLmdldERldmljZVBpeGVsUmF0aW8oKTtcbiAgICAgIHNoYWRvd1ZpZXcudXBkYXRlUG9pbnRTY2FsZUZhY3RvcihwaXhlbFJhdGlvKTtcblxuICAgICAgdGhpcy5zaGFkb3dWaWV3UmVnaXN0cnkuc2V0KHJlYWN0VGFnLCBzaGFkb3dWaWV3KTtcbiAgICAgIHRoaXMucm9vdFZpZXdUYWdzLmFkZChyZWFjdFRhZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBhdmFpbGFibGUgc2l6ZSAoYGF2YWlsYWJsZVNpemVgIHByb3BlcnR5KSBmb3IgYSByb290IHZpZXcuXG4gICAgICogVGhpcyBtaWdodCBiZSB1c2VkIGluIHJlc3BvbnNlIHRvIGNoYW5nZXMgaW4gZXh0ZXJuYWwgbGF5b3V0IGNvbnN0cmFpbnRzLlxuICAgICAqIFRoaXMgdmFsdWUgd2lsbCBiZSBkaXJlY3RseSB0cmFzbWl0dGVkIHRvIGxheW91dCBlbmdpbmUgYW5kIGRlZmluZXMgaG93IGJpZyB2aWV3cG9ydCBpcztcbiAgICAgKiB0aGlzIHZhbHVlIGRvZXMgbm90IGFmZmVjdCByb290IG5vZGUgc2l6ZSBzdHlsZSBwcm9wZXJ0aWVzLlxuICAgICAqIENhbiBiZSBjb25zaWRlcmVkIGFzIHNvbWV0aGluZyBzaW1pbGFyIHRvIGBzZXRTaXplOmZvclZpZXc6YCBidXQgYXBwbGljYWJsZSBvbmx5IGZvciByb290IHZpZXcuXG4gICAgICovXG4gICAgc2V0QXZhaWxhYmxlU2l6ZShzaXplOiBTaXplLCBzY2FsZTogbnVtYmVyLCByb290VmlldzogUkNUUm9vdFZpZXcpOiB2b2lkIHtcbiAgICAgIHRoaXMucGVuZGluZ1VJQmxvY2tzLnB1c2goKCkgPT4ge1xuICAgICAgICBjb25zdCByZWFjdFRhZyA9IHJvb3RWaWV3LnJlYWN0VGFnO1xuICAgICAgICBjb25zdCByb290U2hhZG93VmlldyA9IHRoaXMuc2hhZG93Vmlld1JlZ2lzdHJ5LmdldChyZWFjdFRhZyk7XG4gICAgICAgIGlmIChyb290U2hhZG93VmlldyAmJiByb290U2hhZG93VmlldyBpbnN0YW5jZW9mIFJDVFJvb3RTaGFkb3dWaWV3KVxuICAgICAgICAgIHJvb3RTaGFkb3dWaWV3LnVwZGF0ZUF2YWlsYWJsZVNpemUoc2l6ZSkgJiZcbiAgICAgICAgICAgIHJvb3RTaGFkb3dWaWV3LnVwZGF0ZVBvaW50U2NhbGVGYWN0b3Ioc2NhbGUpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2V0TG9jYWxEYXRhRm9yVmlldyhsb2NhbERhdGE6IGFueSwgdmlldzogVUlWaWV3KSB7XG4gICAgICBjb25zdCB0YWcgPSB2aWV3LnJlYWN0VGFnO1xuICAgICAgY29uc3Qgc2hhZG93VmlldyA9IHRoaXMuc2hhZG93Vmlld1JlZ2lzdHJ5LmdldCh0YWcpO1xuICAgICAgaWYgKHNoYWRvd1ZpZXcgPT0gbnVsbCkge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYENvdWxkIG5vdCBsb2NhdGUgc2hhZG93IHZpZXcgd2l0aCB0YWcgJHt0YWd9LCB0aGlzIGlzIHByb2JhYmx5IGNhdXNlZCBieSBhIHRlbXBvcmFyeSBpbmNvbnNpc3RlbmN5IGJldHdlZW4gbmF0aXZlIHZpZXdzIGFuZCBzaGFkb3cgdmlld3MuYFxuICAgICAgICApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzaGFkb3dWaWV3LmxvY2FsRGF0YSA9IGxvY2FsRGF0YTtcbiAgICAgIHRoaXMucmVxdWVzdFRpY2soKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIHJlYWN0VGFnIGZyb20gYSBjb21wb25lbnQsIGZpbmQgaXRzIHJvb3QgdmlldywgaWYgcG9zc2libGUuXG4gICAgICogT3RoZXJ3aXNlLCB0aGlzIHdpbGwgZ2l2ZSBiYWNrIG5pbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWFjdFRhZyB0aGUgY29tcG9uZW50IHRhZ1xuICAgICAqIEBwYXJhbSBjb21wbGV0aW9uIHRoZSBjb21wbGV0aW9uIGJsb2NrIHRoYXQgd2lsbCBoYW5kIG92ZXIgdGhlIHJvb3RWaWV3LCBpZiBhbnkuXG4gICAgICpcbiAgICAgKi9cbiAgICByb290Vmlld0ZvclJlYWN0VGFnKHJlYWN0VGFnOiBudW1iZXIsIGNvbXBsZXRpb246IEZ1bmN0aW9uKSB7fVxuXG4gICAgdmlld05hbWVGb3JSZWFjdFRhZyhyZWFjdFRhZzogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgIGNvbnN0IHNoYWRvd1ZpZXcgPSB0aGlzLnNoYWRvd1ZpZXdSZWdpc3RyeS5nZXQocmVhY3RUYWcpO1xuICAgICAgaW52YXJpYW50KHNoYWRvd1ZpZXcsIGBObyBzdWNoIHNoYWRvd1ZpZXcgd2l0aCBpZCAke3JlYWN0VGFnfWApO1xuICAgICAgcmV0dXJuIHNoYWRvd1ZpZXcudmlld05hbWU7XG4gICAgfVxuXG4gICAgcHVyZ2VWaWV3KHJlYWN0VGFnOiBudW1iZXIpIHtcbiAgICAgIGNvbnN0IHNoYWRvd1ZpZXcgPSB0aGlzLnNoYWRvd1ZpZXdSZWdpc3RyeS5nZXQocmVhY3RUYWcpO1xuICAgICAgaWYgKHNoYWRvd1ZpZXcpIHtcbiAgICAgICAgdGhpcy5zaGFkb3dWaWV3UmVnaXN0cnkuZGVsZXRlKHJlYWN0VGFnKTtcbiAgICAgICAgc2hhZG93Vmlldy5wdXJnZSgpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5sYXlvdXRBbmltYXRpb25NYW5hZ2VyLmlzUGVuZGluZygpKSB7XG4gICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLnZpZXdSZWdpc3RyeS5nZXQocmVhY3RUYWcpO1xuICAgICAgICBpZiAodmlldyAmJiB2aWV3LnJlYWN0U3VwZXJ2aWV3KSB7XG4gICAgICAgICAgdmlldy5yZWFjdFN1cGVydmlldy5yZW1vdmVSZWFjdFN1YnZpZXcodmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXlvdXRBbmltYXRpb25NYW5hZ2VyLnF1ZXVlUmVtb3ZlZE5vZGUocmVhY3RUYWcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5hZGRVSUJsb2NrKCh1aU1hbmFnZXIsIHZpZXdSZWdpc3RyeSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHZpZXcgPSB2aWV3UmVnaXN0cnkuZ2V0KHJlYWN0VGFnKTtcbiAgICAgICAgICB2aWV3UmVnaXN0cnkuZGVsZXRlKHJlYWN0VGFnKTtcbiAgICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5wdXJnZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZnJhbWUoKSB7XG4gICAgICB0aGlzLm9ic2VydmVyQ29vcmRpbmF0b3IudWlNYW5hZ2VyV2lsbFBlcmZvcm1MYXlvdXQodGhpcyk7XG5cbiAgICAgIHRoaXMucm9vdFZpZXdUYWdzLmZvckVhY2goKHJvb3RUYWcpID0+IHtcbiAgICAgICAgY29uc3Qgcm9vdFNoYWRvd1ZpZXcgPSB0aGlzLnNoYWRvd1ZpZXdSZWdpc3RyeS5nZXQocm9vdFRhZyk7XG4gICAgICAgIGlmIChyb290U2hhZG93VmlldyAhPSBudWxsICYmIHJvb3RTaGFkb3dWaWV3LmlzRGlydHkpIHtcbiAgICAgICAgICBpbnZhcmlhbnQoXG4gICAgICAgICAgICByb290U2hhZG93VmlldyBpbnN0YW5jZW9mIFJDVFJvb3RTaGFkb3dWaWV3LFxuICAgICAgICAgICAgXCJhdHRlbXB0aW5nIHRvIHJlY2FsY3VsYXRlIGZyb20gc2hhZG93VmlldyB0aGF0IGlzbid0IHJvb3RcIlxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBjb25zdCBsYXlvdXRDaGFuZ2VzID0gaW5zdHJ1bWVudChcIuKam++4jyBMYXlvdXRcIiwgKCkgPT5cbiAgICAgICAgICAgIHJvb3RTaGFkb3dWaWV3LnJlY2FsY3VsYXRlTGF5b3V0KClcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgaWYgKHRoaXMubGF5b3V0QW5pbWF0aW9uTWFuYWdlci5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgdGhpcy5sYXlvdXRBbmltYXRpb25NYW5hZ2VyLmFkZExheW91dENoYW5nZXMobGF5b3V0Q2hhbmdlcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXBwbHlMYXlvdXRDaGFuZ2VzKGxheW91dENoYW5nZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMub2JzZXJ2ZXJDb29yZGluYXRvci51aU1hbmFnZXJEaWRQZXJmb3JtTGF5b3V0KHRoaXMpO1xuXG4gICAgICBpZiAodGhpcy5sYXlvdXRBbmltYXRpb25NYW5hZ2VyLmlzUGVuZGluZygpKSB7XG4gICAgICAgIGluc3RydW1lbnQoXCLimpvvuI8gTGF5b3V0QW5pbWF0aW9uIENvbnN0cnVjdGlvblwiLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5sYXlvdXRBbmltYXRpb25NYW5hZ2VyLmFwcGx5TGF5b3V0Q2hhbmdlcygpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5vYnNlcnZlckNvb3JkaW5hdG9yLnVpTWFuYWdlcldpbGxGbHVzaEJsb2Nrcyh0aGlzKTtcblxuICAgICAgaW5zdHJ1bWVudChcIuKam++4jyBTdHlsZVwiLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnBlbmRpbmdVSUJsb2Nrcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgdWlCbG9ja3MgPSBbLi4udGhpcy5wZW5kaW5nVUlCbG9ja3NdO1xuICAgICAgICAgIHRoaXMucGVuZGluZ1VJQmxvY2tzID0gW107XG5cbiAgICAgICAgICB1aUJsb2Nrcy5mb3JFYWNoKChibG9jaykgPT4ge1xuICAgICAgICAgICAgYmxvY2suY2FsbChudWxsLCB0aGlzLCB0aGlzLnZpZXdSZWdpc3RyeSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB0aGlzLnJlcXVlc3RUaWNrKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHNob3VsZENvbnRpbnVlKCk6IGJvb2xlYW4ge1xuICAgICAgcmV0dXJuIHRoaXMucGVuZGluZ1VJQmxvY2tzLmxlbmd0aCAhPT0gMDtcbiAgICB9XG5cbiAgICByZXF1ZXN0VGljaygpIHtcbiAgICAgIHRoaXMucm9vdFZpZXdUYWdzLmZvckVhY2goKHJvb3RWaWV3VGFnKSA9PiB7XG4gICAgICAgIGNvbnN0IHJvb3RWaWV3ID0gdGhpcy52aWV3UmVnaXN0cnkuZ2V0KHJvb3RWaWV3VGFnKTtcbiAgICAgICAgaW52YXJpYW50KFxuICAgICAgICAgIHJvb3RWaWV3ICYmIHJvb3RWaWV3IGluc3RhbmNlb2YgUkNUUm9vdFZpZXcsXG4gICAgICAgICAgYFJvb3RWaWV3ICh3aXRoIElEICR7cm9vdFZpZXdUYWd9KSBkb2VzIG5vdCBleGlzdGBcbiAgICAgICAgKTtcbiAgICAgICAgcm9vdFZpZXcucmVxdWVzdFRpY2soKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGFwcGx5TGF5b3V0Q2hhbmdlcyhsYXlvdXRDaGFuZ2VzOiBMYXlvdXRDaGFuZ2VbXSkge1xuICAgICAgbGF5b3V0Q2hhbmdlcy5mb3JFYWNoKChsYXlvdXRDaGFuZ2UpID0+IHtcbiAgICAgICAgY29uc3QgeyByZWFjdFRhZywgbGF5b3V0IH0gPSBsYXlvdXRDaGFuZ2U7XG4gICAgICAgIHRoaXMuYWRkVUlCbG9jaygodWlNYW5hZ2VyLCB2aWV3UmVnaXN0cnkpID0+IHtcbiAgICAgICAgICBjb25zdCB2aWV3ID0gdmlld1JlZ2lzdHJ5LmdldChyZWFjdFRhZyk7XG4gICAgICAgICAgaW52YXJpYW50KHZpZXcsIGBWaWV3IHdpdGggcmVhY3RUYWcgJHtyZWFjdFRhZ30gZG9lcyBub3QgZXhpc3RgKTtcbiAgICAgICAgICB2aWV3LmZyYW1lID0gbGF5b3V0O1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIEBSQ1RfRVhQT1JUX01FVEhPRChSQ1RGdW5jdGlvblR5cGVOb3JtYWwpXG4gICAgbWVhc3VyZShyZWFjdFRhZzogbnVtYmVyLCBjYWxsYmFja0lkOiA/bnVtYmVyKSB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICB0aGlzLmFkZFVJQmxvY2soKCkgPT4ge1xuICAgICAgICAgIGxldCBzaGFkb3dWaWV3ID0gdGhpcy5zaGFkb3dWaWV3UmVnaXN0cnkuZ2V0KHJlYWN0VGFnKTtcbiAgICAgICAgICBsZXQgdmlldyA9IHRoaXMudmlld1JlZ2lzdHJ5LmdldChyZWFjdFRhZyk7XG5cbiAgICAgICAgICBpZiAoIXNoYWRvd1ZpZXcgfHwgIXNoYWRvd1ZpZXcubWVhc3VyZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCB7IGdsb2JhbFgsIGdsb2JhbFkgfSA9IHNoYWRvd1ZpZXcubWVhc3VyZUdsb2JhbCgpO1xuXG4gICAgICAgICAgaW52YXJpYW50KFxuICAgICAgICAgICAgc2hhZG93Vmlldy5wcmV2aW91c0xheW91dCxcbiAgICAgICAgICAgIFwiU2hhZG93IHZpZXcgaGFzIG5vIHByZXZpb3VzIGxheW91dFwiXG4gICAgICAgICAgKTtcbiAgICAgICAgICBsZXQgeyBsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQgfSA9IHNoYWRvd1ZpZXcucHJldmlvdXNMYXlvdXQ7XG5cbiAgICAgICAgICBpZiAoY2FsbGJhY2tJZCAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmJyaWRnZS5jYWxsYmFja0Zyb21JZChjYWxsYmFja0lkKShcbiAgICAgICAgICAgICAgbGVmdCxcbiAgICAgICAgICAgICAgdG9wLFxuICAgICAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICAgICAgaGVpZ2h0LFxuICAgICAgICAgICAgICBnbG9iYWxYLFxuICAgICAgICAgICAgICBnbG9iYWxZXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICAgICAgbGVmdCxcbiAgICAgICAgICAgICAgdG9wLFxuICAgICAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICAgICAgaGVpZ2h0LFxuICAgICAgICAgICAgICBnbG9iYWxYLFxuICAgICAgICAgICAgICBnbG9iYWxZXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgQFJDVF9FWFBPUlRfTUVUSE9EKFJDVEZ1bmN0aW9uVHlwZU5vcm1hbClcbiAgICBhc3luYyBtZWFzdXJlSW5XaW5kb3cocmVhY3RUYWc6IG51bWJlciwgY2FsbGJhY2tJZDogbnVtYmVyKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm1lYXN1cmUocmVhY3RUYWcpO1xuICAgICAgaW52YXJpYW50KHJlc3VsdCwgYE5vIG1lYXN1cmVtZW50IGF2YWlsYWJsZSBmb3IgdmlldyAke3JlYWN0VGFnfWApO1xuICAgICAgY29uc3QgeyBnbG9iYWxYLCBnbG9iYWxZLCB3aWR0aCwgaGVpZ2h0IH0gPSByZXN1bHQ7XG4gICAgICB0aGlzLmJyaWRnZS5jYWxsYmFja0Zyb21JZChjYWxsYmFja0lkKShnbG9iYWxYLCBnbG9iYWxZLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG5cbiAgICBAUkNUX0VYUE9SVF9NRVRIT0QoUkNURnVuY3Rpb25UeXBlTm9ybWFsKVxuICAgIHNldEpTUmVzcG9uZGVyKHJlYWN0VGFnOiBudW1iZXIpIHtcbiAgICAgIHRoaXMuanNSZXNwb25kZXIgPSB0aGlzLnZpZXdSZWdpc3RyeS5nZXQocmVhY3RUYWcpO1xuICAgICAgaWYgKCF0aGlzLmpzUmVzcG9uZGVyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgYEludmFsaWQgdmlldyBzZXQgdG8gYmUgdGhlIEpTIHJlc3BvbmRlciAtIHRhZyAke3JlYWN0VGFnfWBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBAUkNUX0VYUE9SVF9NRVRIT0QoUkNURnVuY3Rpb25UeXBlTm9ybWFsKVxuICAgIGNsZWFySlNSZXNwb25kZXIoKSB7XG4gICAgICB0aGlzLmpzUmVzcG9uZGVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBAUkNUX0VYUE9SVF9NRVRIT0QoUkNURnVuY3Rpb25UeXBlTm9ybWFsKVxuICAgIGNvbmZpZ3VyZU5leHRMYXlvdXRBbmltYXRpb24oXG4gICAgICBjb25maWc6IExheW91dEFuaW1hdGlvbkNvbmZpZyxcbiAgICAgIG9uQW5pbWF0aW9uRGlkRW5kOiBudW1iZXJcbiAgICApIHtcbiAgICAgIGlmIChcbiAgICAgICAgIUNhblVzZS5tYXRjaE1lZGlhIHx8XG4gICAgICAgICF3aW5kb3cubWF0Y2hNZWRpYShcIihwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpXCIpLm1hdGNoZXNcbiAgICAgICkge1xuICAgICAgICB0aGlzLmxheW91dEFuaW1hdGlvbk1hbmFnZXIuY29uZmlndXJlTmV4dChcbiAgICAgICAgICBjb25maWcsXG4gICAgICAgICAgdGhpcy5icmlkZ2UuY2FsbGJhY2tGcm9tSWQob25BbmltYXRpb25EaWRFbmQpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYWRkVUlCbG9jayhibG9jazogP1VJQmxvY2spIHtcbiAgICAgIGlmIChibG9jayA9PSBudWxsIHx8IHRoaXMudmlld1JlZ2lzdHJ5ID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8gYmxvY2suY2FsbChudWxsLCB0aGlzLCB0aGlzLnZpZXdSZWdpc3RyeSk7XG4gICAgICB0aGlzLnBlbmRpbmdVSUJsb2Nrcy5wdXNoKGJsb2NrKTtcbiAgICB9XG5cbiAgICBwcmVwZW5kVUlCbG9jayhibG9jazogP1VJQmxvY2spIHtcbiAgICAgIGlmICghYmxvY2spIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5wZW5kaW5nVUlCbG9ja3MudW5zaGlmdChibG9jayk7XG4gICAgfVxuXG4gICAgQFJDVF9FWFBPUlRfTUVUSE9EKFJDVEZ1bmN0aW9uVHlwZU5vcm1hbClcbiAgICBzZXRDaGlsZHJlbihjb250YWluZXJUYWc6IG51bWJlciwgcmVhY3RUYWdzOiBBcnJheTxudW1iZXI+KSB7XG4gICAgICBSQ1RVSU1hbmFnZXIuUkNUU2V0Q2hpbGRyZW4oXG4gICAgICAgIGNvbnRhaW5lclRhZyxcbiAgICAgICAgcmVhY3RUYWdzLFxuICAgICAgICB0aGlzLnNoYWRvd1ZpZXdSZWdpc3RyeVxuICAgICAgKTtcblxuICAgICAgdGhpcy5hZGRVSUJsb2NrKFxuICAgICAgICAodWlNYW5hZ2VyOiBSQ1RVSU1hbmFnZXIsIHZpZXdSZWdpc3RyeTogTWFwPG51bWJlciwgVUlWaWV3PikgPT4ge1xuICAgICAgICAgIFJDVFVJTWFuYWdlci5SQ1RTZXRDaGlsZHJlbihjb250YWluZXJUYWcsIHJlYWN0VGFncywgdmlld1JlZ2lzdHJ5KTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgUkNUU2V0Q2hpbGRyZW4oXG4gICAgICBjb250YWluZXJUYWc6IG51bWJlcixcbiAgICAgIHJlYWN0VGFnczogQXJyYXk8bnVtYmVyPixcbiAgICAgIHJlZ2lzdHJ5OiBNYXA8bnVtYmVyLCAkU3VidHlwZTxSQ1RDb21wb25lbnQ+PlxuICAgICkge1xuICAgICAgY29uc3QgY29udGFpbmVyID0gcmVnaXN0cnkuZ2V0KGNvbnRhaW5lclRhZyk7XG4gICAgICBsZXQgaW5kZXggPSAwO1xuICAgICAgcmVhY3RUYWdzLmZvckVhY2goKHJlYWN0VGFnKSA9PiB7XG4gICAgICAgIGNvbnN0IHZpZXcgPSByZWdpc3RyeS5nZXQocmVhY3RUYWcpO1xuICAgICAgICBpbnZhcmlhbnQoXG4gICAgICAgICAgY29udGFpbmVyLFxuICAgICAgICAgIGBObyBjb250YWluZXIgdmlldyBmb3VuZCB3aXRoIGlkOiAke2NvbnRhaW5lclRhZ31gXG4gICAgICAgICk7XG4gICAgICAgIGludmFyaWFudCh2aWV3LCBgTm8gdmlldyBmb3VuZCB3aXRoIGlkOiAke3JlYWN0VGFnfWApO1xuICAgICAgICBjb250YWluZXIuaW5zZXJ0UmVhY3RTdWJ2aWV3QXRJbmRleCh2aWV3LCBpbmRleCsrKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIEBSQ1RfRVhQT1JUX01FVEhPRChSQ1RGdW5jdGlvblR5cGVOb3JtYWwpXG4gICAgY3JlYXRlVmlldyhcbiAgICAgIHJlYWN0VGFnOiBudW1iZXIsXG4gICAgICB2aWV3TmFtZTogc3RyaW5nLFxuICAgICAgcm9vdFRhZzogbnVtYmVyLFxuICAgICAgcHJvcHM6IE9iamVjdFxuICAgICkge1xuICAgICAgY29uc3QgY29tcG9uZW50RGF0YSA9IHRoaXMuY29tcG9uZW50RGF0YUJ5TmFtZS5nZXQodmlld05hbWUpO1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICBjb21wb25lbnREYXRhLFxuICAgICAgICBgTm8gY29tcG9uZW50IGZvdW5kIGZvciB2aWV3IHdpdGggbmFtZSAke3ZpZXdOYW1lfWBcbiAgICAgICk7XG5cbiAgICAgIC8vIHJlZ2lzdGVyIHNoYWRvdyB2aWV3XG4gICAgICBjb25zdCBzaGFkb3dWaWV3ID0gY29tcG9uZW50RGF0YS5jcmVhdGVTaGFkb3dWaWV3KHJlYWN0VGFnKTtcbiAgICAgIGlmIChzaGFkb3dWaWV3ICE9IG51bGwpIHtcbiAgICAgICAgc2hhZG93Vmlldy52aWV3TmFtZSA9IHZpZXdOYW1lO1xuICAgICAgICBjb21wb25lbnREYXRhLnNldFByb3BzRm9yU2hhZG93Vmlldyhwcm9wcywgc2hhZG93Vmlldyk7XG4gICAgICAgIHRoaXMuc2hhZG93Vmlld1JlZ2lzdHJ5LnNldChyZWFjdFRhZywgc2hhZG93Vmlldyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNoYWRvdyB2aWV3IGlzIHRoZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIGJhY2tncm91bmQgY29sb3IgdGhpcyBpcyBhIGxpdHRsZVxuICAgICAgLy8gYml0IGNvdW50ZXItaW50dWl0aXZlIGlmIHBlb3BsZSB0cnkgdG8gc2V0IGJhY2tncm91bmQgY29sb3Igd2hlbiBzZXR0aW5nIHVwXG4gICAgICAvLyB0aGUgdmlldywgYnV0IGl0J3MgdGhlIG9ubHkgd2F5IHRoYXQgbWFrZXMgc2Vuc2UgZ2l2ZW4gb3VyIHRocmVhZGluZyBtb2RlbFxuICAgICAgY29uc3QgYmFja2dyb3VuZENvbG9yID0gc2hhZG93Vmlldy5iYWNrZ3JvdW5kQ29sb3I7XG5cbiAgICAgIC8vIERpc3BhdGNoIHZpZXcgY3JlYXRpb24gZGlyZWN0bHkgdG8gdGhlIG1haW4gdGhyZWFkIGluc3RlYWQgb2YgYWRkaW5nIHRvXG4gICAgICAvLyBVSUJsb2NrcyBhcnJheS4gVGhpcyB3YXksIGl0IGRvZXNuJ3QgZ2V0IGRlZmVycmVkIHVudGlsIGFmdGVyIGxheW91dC5cbiAgICAgIGNvbnN0IHZpZXcgPSBjb21wb25lbnREYXRhLmNyZWF0ZVZpZXcocmVhY3RUYWcpO1xuICAgICAgaWYgKHZpZXcgIT0gbnVsbCkge1xuICAgICAgICBjb21wb25lbnREYXRhLnNldFByb3BzRm9yVmlldyhwcm9wcywgdmlldyk7XG5cbiAgICAgICAgaWYgKHR5cGVvZiB2aWV3LnNldEJhY2tncm91bmRDb2xvciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgdmlldy5zZXRCYWNrZ3JvdW5kQ29sb3IoYmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRPRE86IGludmVzdGlnYXRlIHVzYWdlIG9mIHJlYWN0QnJpZGdlRGlkRmluaXNoVHJhbnNhY3Rpb25cblxuICAgICAgICB0aGlzLnZpZXdSZWdpc3RyeS5zZXQocmVhY3RUYWcsIHZpZXcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIEBSQ1RfRVhQT1JUX01FVEhPRChSQ1RGdW5jdGlvblR5cGVOb3JtYWwpXG4gICAgdXBkYXRlVmlldyhyZWFjdFRhZzogbnVtYmVyLCB2aWV3TmFtZTogc3RyaW5nLCB1cGRhdGVkUHJvcHM6IE9iamVjdCkge1xuICAgICAgY29uc3QgY29tcG9uZW50RGF0YSA9IHRoaXMuY29tcG9uZW50RGF0YUJ5TmFtZS5nZXQodmlld05hbWUpO1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICBjb21wb25lbnREYXRhLFxuICAgICAgICBgTm8gY29tcG9uZW50IGZvdW5kIGZvciB2aWV3IHdpdGggbmFtZSAke3ZpZXdOYW1lfWBcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHNoYWRvd1ZpZXcgPSB0aGlzLnNoYWRvd1ZpZXdSZWdpc3RyeS5nZXQocmVhY3RUYWcpO1xuICAgICAgaWYgKHNoYWRvd1ZpZXcpIHtcbiAgICAgICAgY29tcG9uZW50RGF0YS5zZXRQcm9wc0ZvclNoYWRvd1ZpZXcodXBkYXRlZFByb3BzLCBzaGFkb3dWaWV3KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdmlldyA9IHRoaXMudmlld1JlZ2lzdHJ5LmdldChyZWFjdFRhZyk7XG4gICAgICBpZiAodmlldykge1xuICAgICAgICBjb21wb25lbnREYXRhLnNldFByb3BzRm9yVmlldyh1cGRhdGVkUHJvcHMsIHZpZXcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHN5bmNocm9ub3VzbHlVcGRhdGVWaWV3KHJlYWN0VGFnOiBudW1iZXIsIHZpZXdOYW1lOiBzdHJpbmcsIHByb3BzOiBPYmplY3QpIHtcbiAgICAgIGNvbnN0IGNvbXBvbmVudERhdGEgPSB0aGlzLmNvbXBvbmVudERhdGFCeU5hbWUuZ2V0KHZpZXdOYW1lKTtcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgY29tcG9uZW50RGF0YSxcbiAgICAgICAgYE5vIGNvbXBvbmVudCBmb3VuZCBmb3IgdmlldyB3aXRoIG5hbWUgJHt2aWV3TmFtZX1gXG4gICAgICApO1xuXG4gICAgICBjb25zdCB2aWV3ID0gdGhpcy52aWV3UmVnaXN0cnkuZ2V0KHJlYWN0VGFnKTtcbiAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiYW5pbWF0aW5nIHZpZXdcIiwgdmlldywgcHJvcHMpO1xuICAgICAgICBjb21wb25lbnREYXRhLnNldFByb3BzRm9yVmlldyhwcm9wcywgdmlldyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgQFJDVF9FWFBPUlRfTUVUSE9EKFJDVEZ1bmN0aW9uVHlwZU5vcm1hbClcbiAgICByZXBsYWNlRXhpc3RpbmdOb25Sb290VmlldyhyZWFjdFRhZzogbnVtYmVyLCBuZXdSZWFjdFRhZzogbnVtYmVyKSB7XG4gICAgICBjb25zdCBzaGFkb3dWaWV3ID0gdGhpcy5zaGFkb3dWaWV3UmVnaXN0cnkuZ2V0KHJlYWN0VGFnKTtcbiAgICAgIGludmFyaWFudChzaGFkb3dWaWV3LCBgc2hhZG93VmlldyAoZm9yIElEICR7cmVhY3RUYWd9KSBub3QgZm91bmRgKTtcblxuICAgICAgY29uc3Qgc3VwZXJTaGFkb3dWaWV3ID0gc2hhZG93Vmlldy5yZWFjdFN1cGVydmlldztcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgc3VwZXJTaGFkb3dWaWV3LFxuICAgICAgICBgc2hhZG93VmlldyBzdXBlciAob2YgSUQgJHtyZWFjdFRhZ30pIG5vdCBmb3VuZGBcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGluZGV4T2ZWaWV3ID0gc3VwZXJTaGFkb3dWaWV3LnJlYWN0U3Vidmlld3MuaW5kZXhPZihzaGFkb3dWaWV3KTtcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgaW5kZXhPZlZpZXcgIT09IC0xLFxuICAgICAgICBcIlZpZXcncyBzdXBlcnZpZXcgZG9lcyd0IGNsYWltIGl0IGFzIHN1YnZpZXdcIlxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVtb3ZlQXRJbmRpY2VzID0gW2luZGV4T2ZWaWV3XTtcbiAgICAgIGNvbnN0IGFkZFRhZ3MgPSBbbmV3UmVhY3RUYWddO1xuXG4gICAgICB0aGlzLm1hbmFnZUNoaWxkcmVuKFxuICAgICAgICBzdXBlclNoYWRvd1ZpZXcucmVhY3RUYWcsXG4gICAgICAgIG51bGwsXG4gICAgICAgIG51bGwsXG4gICAgICAgIGFkZFRhZ3MsXG4gICAgICAgIHJlbW92ZUF0SW5kaWNlcyxcbiAgICAgICAgcmVtb3ZlQXRJbmRpY2VzXG4gICAgICApO1xuICAgIH1cblxuICAgIEBSQ1RfRVhQT1JUX01FVEhPRChSQ1RGdW5jdGlvblR5cGVOb3JtYWwpXG4gICAgYXN5bmMgZmluZFN1YnZpZXdJbihcbiAgICAgIHJlYWN0VGFnOiBudW1iZXIsXG4gICAgICBhdFBvaW50OiBbbnVtYmVyLCBudW1iZXJdLFxuICAgICAgY2FsbGJhY2tJZDogbnVtYmVyXG4gICAgKSB7XG4gICAgICBjb25zdCBbeCwgeV0gPSBhdFBvaW50O1xuICAgICAgY29uc3QgdmlldyA9IHRoaXMudmlld1JlZ2lzdHJ5LmdldChyZWFjdFRhZyk7XG5cbiAgICAgIGludmFyaWFudCh2aWV3LCBgTm8gc3VjaCB2aWV3IHdpdGggdGFnICR7cmVhY3RUYWd9YCk7XG5cbiAgICAgIGNvbnN0IHRhcmdldCA9IHJlYWN0Vmlld0Zyb21Qb2ludCh2aWV3LCB4LCB5KTtcblxuICAgICAgaWYgKCF0YXJnZXQgfHwgISh0YXJnZXQgaW5zdGFuY2VvZiBVSVZpZXcpKSByZXR1cm47XG5cbiAgICAgIGNvbnN0IG1lYXN1cmVtZW50ID0gYXdhaXQgdGhpcy5tZWFzdXJlKHRhcmdldC5yZWFjdFRhZyk7XG5cbiAgICAgIGludmFyaWFudChcbiAgICAgICAgbWVhc3VyZW1lbnQsXG4gICAgICAgIGBWaWV3IHdpdGggdGFnICR7dGFyZ2V0LnJlYWN0VGFnfSBoYXMgbm8gbWVhc3VyZW1lbnRgXG4gICAgICApO1xuICAgICAgY29uc3QgeyBnbG9iYWxYLCBnbG9iYWxZLCB3aWR0aCwgaGVpZ2h0IH0gPSBtZWFzdXJlbWVudDtcblxuICAgICAgdGhpcy5icmlkZ2UuY2FsbGJhY2tGcm9tSWQoY2FsbGJhY2tJZCkoXG4gICAgICAgIHRhcmdldC5yZWFjdFRhZyxcbiAgICAgICAgZ2xvYmFsWCxcbiAgICAgICAgZ2xvYmFsWSxcbiAgICAgICAgd2lkdGgsXG4gICAgICAgIGhlaWdodFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBAUkNUX0VYUE9SVF9NRVRIT0QoUkNURnVuY3Rpb25UeXBlTm9ybWFsKVxuICAgIG1hbmFnZUNoaWxkcmVuKFxuICAgICAgdGFnOiBudW1iZXIsXG4gICAgICBtb3ZlRnJvbTogP0FycmF5PG51bWJlcj4sXG4gICAgICBtb3ZlVG86ID9BcnJheTxudW1iZXI+LFxuICAgICAgYWRkQ2hpbGRUYWdzOiBBcnJheTxudW1iZXI+LFxuICAgICAgYWRkQXRJbmRpY2VzOiBBcnJheTxudW1iZXI+LFxuICAgICAgcmVtb3ZlRnJvbTogQXJyYXk8bnVtYmVyPlxuICAgICkge1xuICAgICAgY29uc3Qgdmlld1RvTWFuYWdlID0gdGhpcy52aWV3UmVnaXN0cnkuZ2V0KHRhZyk7XG4gICAgICBjb25zdCBzaGFkb3dWaWV3VG9NYW5hZ2UgPSB0aGlzLnNoYWRvd1ZpZXdSZWdpc3RyeS5nZXQodGFnKTtcblxuICAgICAgaWYgKCF2aWV3VG9NYW5hZ2UgfHwgIXNoYWRvd1ZpZXdUb01hbmFnZSkgcmV0dXJuO1xuXG4gICAgICAvLyBkZXRlcm1pbmUgY291bnRzIHdpdGggY2hlY2tzIGZvciBudWxsXG4gICAgICBjb25zdCBudW1Ub01vdmUgPSAhbW92ZUZyb20gPyAwIDogbW92ZUZyb20ubGVuZ3RoO1xuXG4gICAgICAvLyBXZSB0cmVhdCBtb3ZlcyBhcyBhbiBhZGQgYW5kIGEgZGVsZXRlXG4gICAgICBjb25zdCB2aWV3c1RvQWRkID0gW107XG4gICAgICBjb25zdCBpbmRpY2VzVG9SZW1vdmUgPSBbXTtcbiAgICAgIGNvbnN0IHRhZ3NUb1JlbW92ZSA9IFtdO1xuICAgICAgY29uc3QgdGFnc1RvRGVsZXRlID0gW107XG5cbiAgICAgIC8vIG1vdmVzIGFyZSBiYXNlZCBvbiBhIHNlcmllcyBvZiBhZGRzIGFmdGVyIHJlbW92ZXNcbiAgICAgIGlmIChtb3ZlRnJvbSAmJiBtb3ZlVG8pIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb3ZlRnJvbS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IG1vdmVGcm9tSW5kZXggPSBtb3ZlRnJvbVtpXTtcbiAgICAgICAgICBjb25zdCB0YWdUb01vdmUgPSB2aWV3VG9NYW5hZ2UucmVhY3RTdWJ2aWV3c1ttb3ZlRnJvbUluZGV4XS5yZWFjdFRhZztcbiAgICAgICAgICB2aWV3c1RvQWRkW2ldID0ge1xuICAgICAgICAgICAgdGFnOiB0YWdUb01vdmUsXG4gICAgICAgICAgICBpbmRleDogbW92ZVRvW2ldXG4gICAgICAgICAgfTtcbiAgICAgICAgICBpbmRpY2VzVG9SZW1vdmVbaV0gPSBtb3ZlRnJvbUluZGV4O1xuICAgICAgICAgIHRhZ3NUb1JlbW92ZVtpXSA9IHRhZ1RvTW92ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBhZGQgdGhlIHJlc3Qgb2YgdGhlIGFkZHNcbiAgICAgIGlmIChhZGRDaGlsZFRhZ3MpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhZGRDaGlsZFRhZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCB2aWV3VGFnVG9BZGQgPSBhZGRDaGlsZFRhZ3NbaV07XG4gICAgICAgICAgY29uc3QgaW5kZXhUb0FkZEF0ID0gYWRkQXRJbmRpY2VzW2ldO1xuICAgICAgICAgIHZpZXdzVG9BZGRbbnVtVG9Nb3ZlICsgaV0gPSB7XG4gICAgICAgICAgICB0YWc6IHZpZXdUYWdUb0FkZCxcbiAgICAgICAgICAgIGluZGV4OiBpbmRleFRvQWRkQXRcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIG5vdyBhZGQgdGhlIHJlcXVpcmVkIHJlbW92ZXNcbiAgICAgIGlmIChyZW1vdmVGcm9tKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVtb3ZlRnJvbS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IGluZGV4VG9SZW1vdmUgPSByZW1vdmVGcm9tW2ldO1xuICAgICAgICAgIGlmICh2aWV3VG9NYW5hZ2UucmVhY3RTdWJ2aWV3c1tpbmRleFRvUmVtb3ZlXSkge1xuICAgICAgICAgICAgY29uc3QgdGFnVG9SZW1vdmUgPVxuICAgICAgICAgICAgICB2aWV3VG9NYW5hZ2UucmVhY3RTdWJ2aWV3c1tpbmRleFRvUmVtb3ZlXS5yZWFjdFRhZztcbiAgICAgICAgICAgIGluZGljZXNUb1JlbW92ZVtudW1Ub01vdmUgKyBpXSA9IGluZGV4VG9SZW1vdmU7XG4gICAgICAgICAgICB0YWdzVG9SZW1vdmVbbnVtVG9Nb3ZlICsgaV0gPSB0YWdUb1JlbW92ZTtcbiAgICAgICAgICAgIHRhZ3NUb0RlbGV0ZVtpXSA9IHRhZ1RvUmVtb3ZlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBOQjogbW92ZUZyb20gYW5kIHJlbW92ZUZyb20gYXJlIGJvdGggcmVsYXRpdmUgdG8gdGhlIHN0YXJ0aW5nIHN0YXRlIG9mIHRoZSBWaWV3J3MgY2hpbGRyZW4uXG4gICAgICAvLyBtb3ZlVG8gYW5kIGFkZEF0IGFyZSBib3RoIHJlbGF0aXZlIHRvIHRoZSBmaW5hbCBzdGF0ZSBvZiB0aGUgVmlldydzIGNoaWxkcmVuLlxuICAgICAgLy9cbiAgICAgIC8vIDEpIFNvcnQgdGhlIHZpZXdzIHRvIGFkZCBhbmQgaW5kaWNlcyB0byByZW1vdmUgYnkgaW5kZXhcbiAgICAgIC8vIDIpIEl0ZXJhdGUgdGhlIGluZGljZXMgYmVpbmcgcmVtb3ZlZCBmcm9tIGhpZ2ggdG8gbG93IGFuZCByZW1vdmUgdGhlbS4gR29pbmcgaGlnaCB0byBsb3dcbiAgICAgIC8vICAgIG1ha2VzIHN1cmUgd2UgcmVtb3ZlIHRoZSBjb3JyZWN0IGluZGV4IHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIHRvIHJlbW92ZS5cbiAgICAgIC8vIDMpIEl0ZXJhdGUgdGhlIHZpZXdzIGJlaW5nIGFkZGVkIGJ5IGluZGV4IGxvdyB0byBoaWdoIGFuZCBhZGQgdGhlbS4gTGlrZSB0aGUgdmlldyByZW1vdmFsLFxuICAgICAgLy8gICAgaXRlcmF0aW9uIGRpcmVjdGlvbiBpcyBpbXBvcnRhbnQgdG8gcHJlc2VydmUgdGhlIGNvcnJlY3QgaW5kZXguXG5cbiAgICAgIHZpZXdzVG9BZGQuc29ydChmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgIHJldHVybiBhLmluZGV4IC0gYi5pbmRleDtcbiAgICAgIH0pO1xuICAgICAgaW5kaWNlc1RvUmVtb3ZlLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgICB9KTtcblxuICAgICAgLy8gQXBwbHkgY2hhbmdlcyB0byBub2RlIGhpZXJhcmNoeVxuICAgICAgLy8gcmVtb3ZpbmcgaW4gdGhlIG9yZGVyIGxhc3QgaW5kZXggdG8gZmlyc3QgaW5kZXhcbiAgICAgIGZvciAobGV0IGkgPSBpbmRpY2VzVG9SZW1vdmUubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgY29uc3QgY2hpbGRJbmRleCA9IGluZGljZXNUb1JlbW92ZVtpXTtcblxuICAgICAgICBsZXQgc2hhZG93U3ViVmlldyA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKHNoYWRvd1ZpZXdUb01hbmFnZSBpbnN0YW5jZW9mIFJDVFNoYWRvd1RleHQpIHtcbiAgICAgICAgICBzaGFkb3dTdWJWaWV3ID0gc2hhZG93Vmlld1RvTWFuYWdlLnRleHRDaGlsZHJlbltjaGlsZEluZGV4XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzaGFkb3dTdWJWaWV3ID0gc2hhZG93Vmlld1RvTWFuYWdlLnJlYWN0U3Vidmlld3NbY2hpbGRJbmRleF07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2hhZG93U3ViVmlldykgc2hhZG93Vmlld1RvTWFuYWdlLnJlbW92ZVJlYWN0U3VidmlldyhzaGFkb3dTdWJWaWV3KTtcblxuICAgICAgICBpZiAoIXRoaXMubGF5b3V0QW5pbWF0aW9uTWFuYWdlci5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgIHRoaXMuYWRkVUlCbG9jaygodWlNYW5hZ2VyLCB2aWV3UmVnaXN0cnkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN1YlZpZXcgPSB2aWV3VG9NYW5hZ2UucmVhY3RTdWJ2aWV3c1tjaGlsZEluZGV4XTtcbiAgICAgICAgICAgIHZpZXdUb01hbmFnZS5yZW1vdmVSZWFjdFN1YnZpZXcoc3ViVmlldyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gYWRkIHRoZSBuZXcgY2hpbGRyZW5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmlld3NUb0FkZC5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB7IHRhZzogdGFnVG9BZGQsIGluZGV4OiBpbmRleFRvQWRkIH0gPSB2aWV3c1RvQWRkW2ldO1xuXG4gICAgICAgIGNvbnN0IHNoYWRvd1N1YlZpZXcgPSB0aGlzLnNoYWRvd1ZpZXdSZWdpc3RyeS5nZXQodGFnVG9BZGQpO1xuICAgICAgICBpZiAoc2hhZG93U3ViVmlldykge1xuICAgICAgICAgIHNoYWRvd1ZpZXdUb01hbmFnZS5pbnNlcnRSZWFjdFN1YnZpZXdBdEluZGV4KFxuICAgICAgICAgICAgc2hhZG93U3ViVmlldyxcbiAgICAgICAgICAgIGluZGV4VG9BZGRcbiAgICAgICAgICApO1xuICAgICAgICAgIHNoYWRvd1N1YlZpZXcubWFrZURpcnR5KCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFkZFVJQmxvY2soKHVpTWFuYWdlciwgdmlld1JlZ2lzdHJ5KSA9PiB7XG4gICAgICAgICAgY29uc3Qgc3ViVmlldyA9IHZpZXdSZWdpc3RyeS5nZXQodGFnVG9BZGQpO1xuICAgICAgICAgIGludmFyaWFudChcbiAgICAgICAgICAgIHN1YlZpZXcsXG4gICAgICAgICAgICBgQXR0ZW1wdGVkIHRvIGluc2VydCBzdWJ2aWV3IHdpdGggdGFnICR7dGFnVG9BZGR9IHRoYXQgZG9lcyBub3QgZXhpc3RgXG4gICAgICAgICAgKTtcbiAgICAgICAgICB2aWV3VG9NYW5hZ2UuaW5zZXJ0UmVhY3RTdWJ2aWV3QXRJbmRleChzdWJWaWV3LCBpbmRleFRvQWRkKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFnc1RvRGVsZXRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMucHVyZ2VWaWV3KHRhZ3NUb0RlbGV0ZVtpXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgQFJDVF9FWFBPUlRfTUVUSE9EKFJDVEZ1bmN0aW9uVHlwZU5vcm1hbClcbiAgICBmb2N1cyhyZWFjdFRhZzogbnVtYmVyKSB7fVxuXG4gICAgQFJDVF9FWFBPUlRfTUVUSE9EKFJDVEZ1bmN0aW9uVHlwZU5vcm1hbClcbiAgICBibHVyKHJlYWN0VGFnOiBudW1iZXIpIHt9XG5cbiAgICBjb25zdGFudHNUb0V4cG9ydCgpIHtcbiAgICAgIGNvbnN0IGNvbnN0YW50cyA9IHt9O1xuICAgICAgY29uc3QgYnViYmxpbmdFdmVudHMgPSB7fTtcbiAgICAgIGNvbnN0IGRpcmVjdEV2ZW50cyA9IHt9O1xuXG4gICAgICBmb3IgKGNvbnN0IFtuYW1lLCBjb21wb25lbnREYXRhXSBvZiB0aGlzLmNvbXBvbmVudERhdGFCeU5hbWUpIHtcbiAgICAgICAgY29uc3QgbW9kdWxlQ29uc3RhbnRzID0ge307XG5cbiAgICAgICAgLy8gUmVnaXN0ZXIgd2hpY2ggZXZlbnQtdHlwZXMgdGhpcyB2aWV3IGRpc3BhdGNoZXMuXG4gICAgICAgIC8vIFJlYWN0IG5lZWRzIHRoaXMgZm9yIHRoZSBldmVudCBwbHVnaW4uXG4gICAgICAgIGNvbnN0IGJ1YmJsaW5nRXZlbnRUeXBlcyA9IHt9O1xuICAgICAgICBjb25zdCBkaXJlY3RFdmVudFR5cGVzID0ge307XG5cbiAgICAgICAgLy8gQWRkIG1hbmFnZXIgY2xhc3NcbiAgICAgICAgbW9kdWxlQ29uc3RhbnRzLk1hbmFnZXIgPSBicmlkZ2VNb2R1bGVOYW1lRm9yQ2xhc3MoXG4gICAgICAgICAgY29tcG9uZW50RGF0YS5tYW5hZ2VyQ2xhc3NcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBBZGQgbmF0aXZlIHByb3BzXG4gICAgICAgIGNvbnN0IHZpZXdDb25maWcgPSBjb21wb25lbnREYXRhLnZpZXdDb25maWc7XG4gICAgICAgIG1vZHVsZUNvbnN0YW50cy5OYXRpdmVQcm9wcyA9IHZpZXdDb25maWcucHJvcFR5cGVzO1xuICAgICAgICBtb2R1bGVDb25zdGFudHMuYmFzZU1vZHVsZU5hbWUgPSB2aWV3Q29uZmlnLmJhc2VNb2R1bGVOYW1lO1xuXG4gICAgICAgIC8vIEFkZCBkaXJlY3QgZXZlbnRzXG4gICAgICAgIGZvciAobGV0IGV2ZW50TmFtZSBvZiB2aWV3Q29uZmlnLmRpcmVjdEV2ZW50cykge1xuICAgICAgICAgIGlmICghZGlyZWN0RXZlbnRzW2V2ZW50TmFtZV0pIHtcbiAgICAgICAgICAgIGRpcmVjdEV2ZW50c1tldmVudE5hbWVdID0ge1xuICAgICAgICAgICAgICByZWdpc3RyYXRpb25OYW1lOiBgb24ke2V2ZW50TmFtZS5zdWJzdHJpbmcoMyl9YFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGlyZWN0RXZlbnRUeXBlc1tldmVudE5hbWVdID0gZGlyZWN0RXZlbnRzW2V2ZW50TmFtZV07XG4gICAgICAgIH1cbiAgICAgICAgbW9kdWxlQ29uc3RhbnRzLmRpcmVjdEV2ZW50VHlwZXMgPSBkaXJlY3RFdmVudFR5cGVzO1xuXG4gICAgICAgIC8vIEFkZCBidWJibGluZyBldmVudHNcbiAgICAgICAgZm9yIChsZXQgZXZlbnROYW1lIG9mIHZpZXdDb25maWcuYnViYmxpbmdFdmVudHMpIHtcbiAgICAgICAgICBpZiAoIWJ1YmJsaW5nRXZlbnRzW2V2ZW50TmFtZV0pIHtcbiAgICAgICAgICAgIGNvbnN0IGJ1YmJsZU5hbWUgPSBgb24ke2V2ZW50TmFtZS5zdWJzdHJpbmcoMyl9YDtcbiAgICAgICAgICAgIGJ1YmJsaW5nRXZlbnRzW2V2ZW50TmFtZV0gPSB7XG4gICAgICAgICAgICAgIHBoYXNlZFJlZ2lzdHJhdGlvbk5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYnViYmxlZDogYnViYmxlTmFtZSxcbiAgICAgICAgICAgICAgICBjYXB0dXJlZDogYCR7YnViYmxlTmFtZX1DYXB0dXJlYFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICBidWJibGluZ0V2ZW50VHlwZXNbZXZlbnROYW1lXSA9IGJ1YmJsaW5nRXZlbnRzW2V2ZW50TmFtZV07XG4gICAgICAgIH1cbiAgICAgICAgbW9kdWxlQ29uc3RhbnRzLmJ1YmJsaW5nRXZlbnRUeXBlcyA9IGJ1YmJsaW5nRXZlbnRUeXBlcztcblxuICAgICAgICBjb25zdGFudHNbbmFtZV0gPSBtb2R1bGVDb25zdGFudHM7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb25zdGFudHM7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIFJDVFVJTWFuYWdlcjtcbn0pKCk7XG4iXX0=