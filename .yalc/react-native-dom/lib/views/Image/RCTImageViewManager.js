var _regenerator=require("babel-runtime/regenerator");var _regenerator2=_interopRequireDefault(_regenerator);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _this2=this;var _RCTBridge=require("./../../bridge/RCTBridge");var _RCTBridge2=_interopRequireDefault(_RCTBridge);var _RCTImageView=require("./RCTImageView");var _RCTImageView2=_interopRequireDefault(_RCTImageView);var _RCTImageSource=require("./RCTImageSource");var _RCTImageSource2=_interopRequireDefault(_RCTImageSource);var _RCTViewManager3=require("./../RCTViewManager");var _RCTViewManager4=_interopRequireDefault(_RCTViewManager3);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};Object['ke'+'ys'](descriptor).forEach(function(key){desc[key]=descriptor[key];});desc.enumerable=!!desc.enumerable;desc.configurable=!!desc.configurable;if('value'in desc||desc.initializer){desc.writable=true;}desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc;},desc);if(context&&desc.initializer!==void 0){desc.value=desc.initializer?desc.initializer.call(context):void 0;desc.initializer=undefined;}if(desc.initializer===void 0){Object['define'+'Property'](target,property,desc);desc=null;}return desc;}module.exports=function _callee(){var _dec,_dec2,_dec3,_dec4,_dec5,_dec6,_dec7,_dec8,_dec9,_dec10,_dec11,_class,_desc,_value,_class2;var RCTViewManager,RCT_EXPORT_VIEW_PROP,RCTImageViewManager;return _regenerator2.default.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regenerator2.default.awrap(_RCTViewManager4.default);case 2:RCTViewManager=_context.sent;RCT_EXPORT_VIEW_PROP=RCTViewManager.RCT_EXPORT_VIEW_PROP;RCTImageViewManager=(_dec=(0,_RCTBridge.RCT_EXPORT_MODULE)("RCTImageViewManager"),_dec2=RCT_EXPORT_VIEW_PROP("source","array"),_dec3=RCT_EXPORT_VIEW_PROP("resizeMode","string"),_dec4=RCT_EXPORT_VIEW_PROP("blurRadius","number"),_dec5=RCT_EXPORT_VIEW_PROP("tintColor","color"),_dec6=RCT_EXPORT_VIEW_PROP("onLoadStart","RCTDirectEventBlock"),_dec7=RCT_EXPORT_VIEW_PROP("onLoad","RCTDirectEventBlock"),_dec8=RCT_EXPORT_VIEW_PROP("onLoadEnd","RCTDirectEventBlock"),_dec9=RCT_EXPORT_VIEW_PROP("onError","RCTDirectEventBlock"),_dec10=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypePromise),_dec11=(0,_RCTBridge.RCT_EXPORT_METHOD)(_RCTBridge.RCTFunctionTypeNormal),_dec(_class=(_class2=function(_RCTViewManager2){(0,_inherits3.default)(RCTImageViewManager,_RCTViewManager2);function RCTImageViewManager(){(0,_classCallCheck3.default)(this,RCTImageViewManager);return(0,_possibleConstructorReturn3.default)(this,(RCTImageViewManager.__proto__||Object.getPrototypeOf(RCTImageViewManager)).apply(this,arguments));}(0,_createClass3.default)(RCTImageViewManager,[{key:"view",value:function view(){return new _RCTImageView2.default(this.bridge);}},{key:"setImageSources",value:function setImageSources(view,value){var imageSources=value.map(function(srcJson){var size={width:srcJson.width!=null?srcJson.width:0,height:srcJson.height!=null?srcJson.height:0};var imageSource=new _RCTImageSource2.default(srcJson.uri,size,srcJson.scale?srcJson.scale:1);if(srcJson.__packager_asset!=null){imageSource.packagerAsset=srcJson.__packager_asset;}return imageSource;});view.imageSources=imageSources;}},{key:"setResizeMode",value:function setResizeMode(view,value){view.resizeMode=value;}},{key:"setBlurRadius",value:function setBlurRadius(view,value){view.blurRadius=value;}},{key:"setTintColor",value:function setTintColor(view,value){view.tintColor=value;}},{key:"setOnLoadStart",value:function setOnLoadStart(view,value){view.onLoadStart=value;}},{key:"setOnLoad",value:function setOnLoad(view,value){view.onLoad=value;}},{key:"setOnLoadEnd",value:function setOnLoadEnd(view,value){view.onLoadEnd=value;}},{key:"setOnError",value:function setOnError(){}},{key:"prefetchImage",value:function prefetchImage(url,resolveId,rejectId){var resolve=this.bridge.callbackFromId(resolveId);var reject=this.bridge.callbackFromId(rejectId);this.bridge.imageLoader.loadImageWithURLRequest(url).then(function(){resolve(true);}).catch(function(error){reject("E_PREFETCH_FAILURE",null,error);});}},{key:"getSize",value:function getSize(request,successId,errorId){var success=this.bridge.callbackFromId(successId);var error=this.bridge.callbackFromId(errorId);this.bridge.imageLoader.getImageSizeForURLRequest(request).then(function(size){success(size.width,size.height);}).catch(function(errorMsg){error(errorMsg);});}}]);return RCTImageViewManager;}(RCTViewManager),(_applyDecoratedDescriptor(_class2.prototype,"setImageSources",[_dec2],Object.getOwnPropertyDescriptor(_class2.prototype,"setImageSources"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setResizeMode",[_dec3],Object.getOwnPropertyDescriptor(_class2.prototype,"setResizeMode"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setBlurRadius",[_dec4],Object.getOwnPropertyDescriptor(_class2.prototype,"setBlurRadius"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setTintColor",[_dec5],Object.getOwnPropertyDescriptor(_class2.prototype,"setTintColor"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setOnLoadStart",[_dec6],Object.getOwnPropertyDescriptor(_class2.prototype,"setOnLoadStart"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setOnLoad",[_dec7],Object.getOwnPropertyDescriptor(_class2.prototype,"setOnLoad"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setOnLoadEnd",[_dec8],Object.getOwnPropertyDescriptor(_class2.prototype,"setOnLoadEnd"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"setOnError",[_dec9],Object.getOwnPropertyDescriptor(_class2.prototype,"setOnError"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"prefetchImage",[_dec10],Object.getOwnPropertyDescriptor(_class2.prototype,"prefetchImage"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,"getSize",[_dec11],Object.getOwnPropertyDescriptor(_class2.prototype,"getSize"),_class2.prototype)),_class2))||_class);return _context.abrupt("return",RCTImageViewManager);case 6:case"end":return _context.stop();}}},null,_this2);}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL1JlYWN0RG9tL3ZpZXdzL0ltYWdlL1JDVEltYWdlVmlld01hbmFnZXIuanMiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsIlJDVFZpZXdNYW5hZ2VyIiwiUkNUX0VYUE9SVF9WSUVXX1BST1AiLCJSQ1RJbWFnZVZpZXdNYW5hZ2VyIiwiYnJpZGdlIiwidmlldyIsInZhbHVlIiwiaW1hZ2VTb3VyY2VzIiwibWFwIiwic3JjSnNvbiIsInNpemUiLCJ3aWR0aCIsImhlaWdodCIsImltYWdlU291cmNlIiwidXJpIiwic2NhbGUiLCJfX3BhY2thZ2VyX2Fzc2V0IiwicGFja2FnZXJBc3NldCIsInJlc2l6ZU1vZGUiLCJibHVyUmFkaXVzIiwidGludENvbG9yIiwib25Mb2FkU3RhcnQiLCJvbkxvYWQiLCJvbkxvYWRFbmQiLCJ1cmwiLCJyZXNvbHZlSWQiLCJyZWplY3RJZCIsInJlc29sdmUiLCJjYWxsYmFja0Zyb21JZCIsInJlamVjdCIsImltYWdlTG9hZGVyIiwibG9hZEltYWdlV2l0aFVSTFJlcXVlc3QiLCJ0aGVuIiwiY2F0Y2giLCJlcnJvciIsInJlcXVlc3QiLCJzdWNjZXNzSWQiLCJlcnJvcklkIiwic3VjY2VzcyIsImdldEltYWdlU2l6ZUZvclVSTFJlcXVlc3QiLCJlcnJvck1zZyJdLCJtYXBwaW5ncyI6ImlwQkFLQSxtRCxtREFNQSw0Qyx5REFDQSxnRCw2REFFQSxvRCxxeUJBVUFBLE9BQU9DLE9BQVAsQ0FBa0IseVhBQ1ZDLGNBRFUsZUFFUkMsb0JBRlEsQ0FFaUJELGNBRmpCLENBRVJDLG9CQUZRLENBS1ZDLG1CQUxVLE9BSWYsaUNBQWtCLHFCQUFsQixDQUplLE9BVWJELHFCQUFxQixRQUFyQixDQUErQixPQUEvQixDQVZhLE9Bb0NiQSxxQkFBcUIsWUFBckIsQ0FBbUMsUUFBbkMsQ0FwQ2EsT0F5Q2JBLHFCQUFxQixZQUFyQixDQUFtQyxRQUFuQyxDQXpDYSxPQThDYkEscUJBQXFCLFdBQXJCLENBQWtDLE9BQWxDLENB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NkJKLE9BRDdCLEVBRUdILElBRkgsQ0FFUSxTQUFDdEIsSUFBRCxDQUFnQixDQUNwQjRCLFFBQVE1QixLQUFLQyxLQUFiLENBQW9CRCxLQUFLRSxNQUF6QixFQUNELENBSkgsRUFLR3FCLEtBTEgsQ0FLUyxTQUFDTyxRQUFELENBQWMsQ0FDbkJOLE1BQU1NLFFBQU4sRUFDRCxDQVBILEVBUUQsQ0FsR2EsaUNBS2tCdkMsY0FMbEIscWlEQXFHVEUsbUJBckdTLDREQUFELEVBQWpCIiwiZmlsZSI6IlJDVEltYWdlVmlld01hbmFnZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBwcm92aWRlc01vZHVsZSBSQ1RJbWFnZVZpZXdNYW5hZ2VyXG4gKiBAZmxvd1xuICovXG5pbXBvcnQgdHlwZSBVSVZpZXcgZnJvbSBcIlVJVmlld1wiO1xuaW1wb3J0IFJDVEJyaWRnZSwge1xuICBSQ1RfRVhQT1JUX01PRFVMRSxcbiAgUkNUX0VYUE9SVF9NRVRIT0QsXG4gIFJDVEZ1bmN0aW9uVHlwZU5vcm1hbCxcbiAgUkNURnVuY3Rpb25UeXBlUHJvbWlzZVxufSBmcm9tIFwiUkNUQnJpZGdlXCI7XG5pbXBvcnQgUkNUSW1hZ2VWaWV3IGZyb20gXCJSQ1RJbWFnZVZpZXdcIjtcbmltcG9ydCBSQ1RJbWFnZVNvdXJjZSBmcm9tIFwiUkNUSW1hZ2VTb3VyY2VcIjtcblxuaW1wb3J0IF9SQ1RWaWV3TWFuYWdlciBmcm9tIFwiUkNUVmlld01hbmFnZXJcIjtcblxudHlwZSBJbWFnZVNvdXJjZUpzb24gPSB7XG4gIF9fcGFja2FnZXJfYXNzZXQ/OiBib29sZWFuLFxuICB3aWR0aD86IG51bWJlcixcbiAgaGVpZ2h0PzogbnVtYmVyLFxuICBzY2FsZT86IG51bWJlcixcbiAgdXJpOiBzdHJpbmdcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gKGFzeW5jICgpID0+IHtcbiAgY29uc3QgUkNUVmlld01hbmFnZXIgPSBhd2FpdCBfUkNUVmlld01hbmFnZXI7XG4gIGNvbnN0IHsgUkNUX0VYUE9SVF9WSUVXX1BST1AgfSA9IFJDVFZpZXdNYW5hZ2VyO1xuXG4gIEBSQ1RfRVhQT1JUX01PRFVMRShcIlJDVEltYWdlVmlld01hbmFnZXJcIilcbiAgY2xhc3MgUkNUSW1hZ2VWaWV3TWFuYWdlciBleHRlbmRzIFJDVFZpZXdNYW5hZ2VyIHtcbiAgICB2aWV3KCk6IFJDVEltYWdlVmlldyB7XG4gICAgICByZXR1cm4gbmV3IFJDVEltYWdlVmlldyh0aGlzLmJyaWRnZSk7XG4gICAgfVxuXG4gICAgQFJDVF9FWFBPUlRfVklFV19QUk9QKFwic291cmNlXCIsIFwiYXJyYXlcIilcbiAgICBzZXRJbWFnZVNvdXJjZXModmlldzogUkNUSW1hZ2VWaWV3LCB2YWx1ZTogSW1hZ2VTb3VyY2VKc29uW10pIHtcbiAgICAgIGNvbnN0IGltYWdlU291cmNlcyA9IHZhbHVlLm1hcCgoc3JjSnNvbjogSW1hZ2VTb3VyY2VKc29uKSA9PiB7XG4gICAgICAgIGNvbnN0IHNpemUgPSB7XG4gICAgICAgICAgd2lkdGg6IHNyY0pzb24ud2lkdGggIT0gbnVsbCA/IHNyY0pzb24ud2lkdGggOiAwLFxuICAgICAgICAgIGhlaWdodDogc3JjSnNvbi5oZWlnaHQgIT0gbnVsbCA/IHNyY0pzb24uaGVpZ2h0IDogMFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGltYWdlU291cmNlID0gbmV3IFJDVEltYWdlU291cmNlKFxuICAgICAgICAgIHNyY0pzb24udXJpLFxuICAgICAgICAgIC8vICRGbG93Rml4TWVcbiAgICAgICAgICBzaXplLFxuICAgICAgICAgIC8vICRGbG93Rml4TWVcbiAgICAgICAgICBzcmNKc29uLnNjYWxlID8gc3JjSnNvbi5zY2FsZSA6IDFcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoc3JjSnNvbi5fX3BhY2thZ2VyX2Fzc2V0ICE9IG51bGwpIHtcbiAgICAgICAgICBpbWFnZVNvdXJjZS5wYWNrYWdlckFzc2V0ID0gc3JjSnNvbi5fX3BhY2thZ2VyX2Fzc2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGltYWdlU291cmNlO1xuICAgICAgfSk7XG5cbiAgICAgIHZpZXcuaW1hZ2VTb3VyY2VzID0gaW1hZ2VTb3VyY2VzO1xuICAgIH1cblxuICAgIEBSQ1RfRVhQT1JUX1ZJRVdfUFJPUChcInJlc2l6ZU1vZGVcIiwgXCJzdHJpbmdcIilcbiAgICBzZXRSZXNpemVNb2RlKHZpZXc6IFJDVEltYWdlVmlldywgdmFsdWU6IHN0cmluZykge1xuICAgICAgdmlldy5yZXNpemVNb2RlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQFJDVF9FWFBPUlRfVklFV19QUk9QKFwiYmx1clJhZGl1c1wiLCBcIm51bWJlclwiKVxuICAgIHNldEJsdXJSYWRpdXModmlldzogUkNUSW1hZ2VWaWV3LCB2YWx1ZTogbnVtYmVyKSB7XG4gICAgICB2aWV3LmJsdXJSYWRpdXMgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBAUkNUX0VYUE9SVF9WSUVXX1BST1AoXCJ0aW50Q29sb3JcIiwgXCJjb2xvclwiKVxuICAgIHNldFRpbnRDb2xvcih2aWV3OiBSQ1RJbWFnZVZpZXcsIHZhbHVlOiA/bnVtYmVyKSB7XG4gICAgICB2aWV3LnRpbnRDb2xvciA9IHZhbHVlO1xuICAgIH1cblxuICAgIEBSQ1RfRVhQT1JUX1ZJRVdfUFJPUChcIm9uTG9hZFN0YXJ0XCIsIFwiUkNURGlyZWN0RXZlbnRCbG9ja1wiKVxuICAgIHNldE9uTG9hZFN0YXJ0KHZpZXc6IFJDVEltYWdlVmlldywgdmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgIHZpZXcub25Mb2FkU3RhcnQgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBAUkNUX0VYUE9SVF9WSUVXX1BST1AoXCJvbkxvYWRcIiwgXCJSQ1REaXJlY3RFdmVudEJsb2NrXCIpXG4gICAgc2V0T25Mb2FkKHZpZXc6IFJDVEltYWdlVmlldywgdmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgIHZpZXcub25Mb2FkID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQFJDVF9FWFBPUlRfVklFV19QUk9QKFwib25Mb2FkRW5kXCIsIFwiUkNURGlyZWN0RXZlbnRCbG9ja1wiKVxuICAgIHNldE9uTG9hZEVuZCh2aWV3OiBSQ1RJbWFnZVZpZXcsIHZhbHVlOiBib29sZWFuKSB7XG4gICAgICB2aWV3Lm9uTG9hZEVuZCA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8vIFRPRE86IHNldCB0aGlzIHRvIHNvbWV0aGluZyBtZWFuaW5nZnVsbFxuICAgIEBSQ1RfRVhQT1JUX1ZJRVdfUFJPUChcIm9uRXJyb3JcIiwgXCJSQ1REaXJlY3RFdmVudEJsb2NrXCIpXG4gICAgc2V0T25FcnJvcigpIHt9XG5cbiAgICBAUkNUX0VYUE9SVF9NRVRIT0QoUkNURnVuY3Rpb25UeXBlUHJvbWlzZSlcbiAgICBwcmVmZXRjaEltYWdlKHVybDogc3RyaW5nLCByZXNvbHZlSWQ6IG51bWJlciwgcmVqZWN0SWQ6IG51bWJlcikge1xuICAgICAgY29uc3QgcmVzb2x2ZSA9IHRoaXMuYnJpZGdlLmNhbGxiYWNrRnJvbUlkKHJlc29sdmVJZCk7XG4gICAgICBjb25zdCByZWplY3QgPSB0aGlzLmJyaWRnZS5jYWxsYmFja0Zyb21JZChyZWplY3RJZCk7XG5cbiAgICAgIHRoaXMuYnJpZGdlLmltYWdlTG9hZGVyXG4gICAgICAgIC5sb2FkSW1hZ2VXaXRoVVJMUmVxdWVzdCh1cmwpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgcmVqZWN0KFwiRV9QUkVGRVRDSF9GQUlMVVJFXCIsIG51bGwsIGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgQFJDVF9FWFBPUlRfTUVUSE9EKFJDVEZ1bmN0aW9uVHlwZU5vcm1hbClcbiAgICBnZXRTaXplKHJlcXVlc3Q6IHN0cmluZywgc3VjY2Vzc0lkOiBudW1iZXIsIGVycm9ySWQ6IG51bWJlcikge1xuICAgICAgY29uc3Qgc3VjY2VzcyA9IHRoaXMuYnJpZGdlLmNhbGxiYWNrRnJvbUlkKHN1Y2Nlc3NJZCk7XG4gICAgICBjb25zdCBlcnJvciA9IHRoaXMuYnJpZGdlLmNhbGxiYWNrRnJvbUlkKGVycm9ySWQpO1xuXG4gICAgICB0aGlzLmJyaWRnZS5pbWFnZUxvYWRlclxuICAgICAgICAuZ2V0SW1hZ2VTaXplRm9yVVJMUmVxdWVzdChyZXF1ZXN0KVxuICAgICAgICAudGhlbigoc2l6ZTogU2l6ZSkgPT4ge1xuICAgICAgICAgIHN1Y2Nlc3Moc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yTXNnKSA9PiB7XG4gICAgICAgICAgZXJyb3IoZXJyb3JNc2cpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gUkNUSW1hZ2VWaWV3TWFuYWdlcjtcbn0pKCk7XG4iXX0=