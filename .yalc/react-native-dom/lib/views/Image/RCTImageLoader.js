Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _dec,_class;var _RCTBridge=require("./../../bridge/RCTBridge");var _RCTBridge2=_interopRequireDefault(_RCTBridge);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var RCTImageLoader=(_dec=(0,_RCTBridge.RCT_EXPORT_MODULE)("RCTImageLoader"),_dec(_class=function(){function RCTImageLoader(bridge){(0,_classCallCheck3.default)(this,RCTImageLoader);this.bridge=bridge;this.imageCache={};}(0,_createClass3.default)(RCTImageLoader,[{key:"loadImage",value:function loadImage(url){var _this=this;var loadPromise=new Promise(function(resolve,reject){var image=new Image();if(url.startsWith("data:"))return resolve(image);if(url.startsWith("blob:")){var blob=_this.bridge.blobManager.resolveURL(url);url=URL.createObjectURL(blob);}image.onload=function(){return resolve(image);};image.onerror=function(){return reject();};image.src=url;});this.imageCache[url]=loadPromise;return loadPromise;}},{key:"getImagePromise",value:function getImagePromise(url){var existingImage=this.imageCache[url];if(existingImage!=null){return existingImage;}else{return this.loadImage(url);}}},{key:"loadImageWithURLRequest",value:function loadImageWithURLRequest(url){return this.getImagePromise(url);}},{key:"getImageSizeForURLRequest",value:function getImageSizeForURLRequest(url){return this.getImagePromise(url).then(function(image){return{width:image.width,height:image.height};});}}]);return RCTImageLoader;}())||_class);exports.default=RCTImageLoader;
//# sourceMappingURL=RCTImageLoader.js.map