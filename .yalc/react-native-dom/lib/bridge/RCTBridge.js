Object.defineProperty(exports,"__esModule",{value:true});exports.RCT_EXPORT_MODULE=exports.default=exports.RCTFunctionTypeSync=exports.RCTFunctionTypePromise=exports.RCTFunctionTypeNormal=undefined;var _extends2=require("babel-runtime/helpers/extends");var _extends3=_interopRequireDefault(_extends2);var _regenerator=require("babel-runtime/regenerator");var _regenerator2=_interopRequireDefault(_regenerator);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _toConsumableArray2=require("babel-runtime/helpers/toConsumableArray");var _toConsumableArray3=_interopRequireDefault(_toConsumableArray2);var _class,_temp,_initialiseProps;exports.getPropertyNames=getPropertyNames;exports.bridgeModuleNameForClass=bridgeModuleNameForClass;exports.RCT_EXPORT_METHOD=RCT_EXPORT_METHOD;var _Invariant=require("./../utils/Invariant");var _Invariant2=_interopRequireDefault(_Invariant);var _yogaDom=require("yoga-dom");var YG=_interopRequireWildcard(_yogaDom);var _RCTModuleConfig=require("./RCTModuleConfig");var _NotificationCenter=require("./../base/NotificationCenter");var _NotificationCenter2=_interopRequireDefault(_NotificationCenter);var _RCTBridgeMethod=require("./RCTBridgeMethod");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj.default=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}exports.RCTFunctionTypeNormal=_RCTBridgeMethod.RCTFunctionTypeNormal;exports.RCTFunctionTypePromise=_RCTBridgeMethod.RCTFunctionTypePromise;exports.RCTFunctionTypeSync=_RCTBridgeMethod.RCTFunctionTypeSync;var MODULE_IDS=0;var METHOD_IDS=1;var PARAMS=2;var DEVTOOLS_FLAG=/\bdevtools\b/;var HOTRELOAD_FLAG=/\bhotreload\b/;var WORKER_SRC="ErrorUtils = {\n  setGlobalHandler: () => {},\n  reportFatalError: console.error\n};\n\nfunction sendMessage(topic, payload) {\n  postMessage({ topic, payload });\n}\n\nvar Status = undefined;\n\nfunction loadBundle(bundle) {\n  return new Promise(function(resolve, reject) {\n    if (__DEV__) {\n      var xmlHttp = new XMLHttpRequest();\n      xmlHttp.open(\"GET\", bundle, true);\n      xmlHttp.setRequestHeader(\"Accept\", \"multipart/mixed\");\n      xmlHttp.onload = function() {\n        importScripts(bundle);\n        resolve();\n      };\n      xmlHttp.onerror = function(evt) {\n        reject(evt);\n      };\n      xmlHttp.onabort = function(evt) {\n        reject(evt);\n      };\n      xmlHttp.onprogress = function(evt) {\n        const progressEvents = xmlHttp.response.match(/\\{[\\S]*\\}/g);\n        if (progressEvents) {\n          const { done, total } = JSON.parse(\n            progressEvents[progressEvents.length - 1]\n          );\n\n          if (done && total) {\n            sendMessage(\"updateProgress\", { done, total });\n          }\n        }\n      };\n      xmlHttp.send();\n    } else {\n      importScripts(bundle);\n      resolve();\n    }\n  });\n}\n\nfunction handleError(e) {\n  console.warn(e);\n  var xmlhttp = new XMLHttpRequest();\n  xmlhttp.open(\"GET\", bundle, true);\n  xmlhttp.onreadystatechange = function() {\n    if (xmlhttp.readyState == 4) {\n      var result = JSON.parse(xmlhttp.responseText);\n      if (result) {\n        if (\n          result.type === \"UnableToResolveError\" ||\n          result.type === \"NotFoundError\"\n        ) {\n          console.warn(result.message);\n        } else {\n          if (result.snippet) {\n            // remove all color characters and split the lines for improved clarity\n            result.snippet = result.snippet\n              .replace(/\\u001b\\[.*?m/g, \"\")\n              .split(\"\\\\n\");\n          }\n          if (result.filename && result.filename.indexOf(\":\") <= 2) {\n            result.filename = \"file:///\" + result.filename;\n          }\n          if (result.errors) {\n            for (var i = 0; i < result.errors.length; i++) {\n              var error = result.errors[i];\n              if (error.filename && error.filename.indexOf(\":\") <= 2) {\n                error.filename = \"file:///\" + error.filename;\n              }\n            }\n          }\n          console.warn(JSON.stringify(result, undefined, 2));\n        }\n      }\n    }\n    xmlhttp.send(null);\n  };\n}\n\nonmessage = ({ data }) => {\n  const { topic, payload } = data;\n  // console.log(\"Recieved message from main thread:\", topic, payload);\n\n  switch (topic) {\n    case \"loadBridgeConfig\": {\n      const { config, bundle } = payload;\n      __fbBatchedBridgeConfig = config;\n      loadBundle(bundle)\n        .then(function() {\n          sendMessage(\"bundleFinishedLoading\");\n        })\n        .catch(handleError);\n      break;\n    }\n    case \"callFunctionReturnFlushedQueue\": {\n      try {\n        if (self.__fbBatchedBridge) {\n          const flushedQueue = __fbBatchedBridge.callFunctionReturnFlushedQueue(\n            ...payload\n          );\n          sendMessage(\"flushedQueue\", flushedQueue);\n        }\n      } catch (e) {\n        console.warn(e);\n        console.warn(\"topic\", topic);\n        console.warn(\"payload\", payload);\n      }\n      break;\n    }\n    case \"invokeCallbackAndReturnFlushedQueue\": {\n      try {\n        if (self.__fbBatchedBridge) {\n          const flushedQueue = __fbBatchedBridge.invokeCallbackAndReturnFlushedQueue(\n            ...payload\n          );\n          sendMessage(\"flushedQueue\", flushedQueue);\n        }\n      } catch (e) {\n        console.warn(e);\n        console.warn(\"topic\", topic);\n        console.warn(\"payload\", payload);\n      }\n      break;\n    }\n    case \"flush\": {\n      try {\n        if (self.__fbBatchedBridge) {\n          const flushedQueue = __fbBatchedBridge.flushedQueue.apply(null);\n          sendMessage(\"flushedQueue\", flushedQueue);\n        }\n      } catch (e) {\n        console.warn(e);\n        console.warn(\"topic\", topic);\n        console.warn(\"payload\", payload);\n      }\n      break;\n    }\n  }\n};\n";if(__DEV__){WORKER_SRC="__DEV__ = true;\n"+WORKER_SRC;if(DEVTOOLS_FLAG.test(location.search)){WORKER_SRC="__DEVTOOLS__ = true;\n"+WORKER_SRC;if(window.__REACT_DEVTOOLS_GLOBAL_HOOK__){console.log("We detected that you have the React Devtools extension installed. "+"Please note that at this time, React VR is only compatible with the "+"standalone React Native Inspector that ships with Nuclide.");}}}else{WORKER_SRC="__DEV__ = false;\n"+WORKER_SRC;}function getPropertyNames(obj){if(obj==null)return[];var currentPropertyNames=Object.getOwnPropertyNames(obj);return currentPropertyNames.concat(getPropertyNames(Object.getPrototypeOf(obj)));}function bridgeModuleNameForClass(cls){var name=cls.__moduleName;if(name!=null){if(name.startsWith("RK")){name=name.substring(2);}else if(name.startsWith("RCT")){name=name.substring(3);}return name;}return"";}function generateModuleConfig(name,bridgeModule){var methodNames=[].concat((0,_toConsumableArray3.default)(new Set(getPropertyNames(bridgeModule)))).filter(function(methodName){return methodName.startsWith("__rct_export__");});var constants=bridgeModule.constantsToExport?bridgeModule.constantsToExport():undefined;var allMethods=[];var promiseMethods=[];var syncMethods=[];methodNames.forEach(function(rctName){if(bridgeModule[rctName]){var _bridgeModule$rctName=bridgeModule[rctName].call(bridgeModule),_bridgeModule$rctName2=(0,_slicedToArray3.default)(_bridgeModule$rctName,2),methodName=_bridgeModule$rctName2[0],methodType=_bridgeModule$rctName2[1];allMethods.push(methodName);if(methodType===_RCTBridgeMethod.RCTFunctionTypePromise){promiseMethods.push(allMethods.length-1);}if(methodType===_RCTBridgeMethod.RCTFunctionTypeSync){syncMethods.push(allMethods.length-1);}}});return[name,constants,allMethods,promiseMethods,syncMethods];}var RCTBridge=(_temp=_class=function(){function RCTBridge(moduleName,bundle,nativeModules){(0,_classCallCheck3.default)(this,RCTBridge);_initialiseProps.call(this);this.loading=true;this.moduleName=moduleName;this.bundleLocation=bundle;this.nativeModules=nativeModules;var bridgeCodeBlob=new Blob([WORKER_SRC]);var worker=new Worker(URL.createObjectURL(bridgeCodeBlob));this.setThread(worker);}(0,_createClass3.default)(RCTBridge,[{key:"moduleForClass",value:function moduleForClass(cls){(0,_Invariant2.default)(cls.__moduleName,"Class does not seem to be exported");return this.modulesByName[bridgeModuleNameForClass(cls)];}},{key:"setThread",value:function setThread(thread){this.thread=thread;thread.onmessage=this.onMessage.bind(this);}},{key:"sendMessage",value:function sendMessage(topic,payload){if(this.thread){this.thread.postMessage({topic:topic,payload:payload});}}},{key:"callNativeModule",value:function callNativeModule(moduleId,methodId,params){var moduleConfig=this.moduleConfigs[moduleId];(0,_Invariant2.default)(moduleConfig,"No such module with id: "+moduleId);var _moduleConfig=(0,_slicedToArray3.default)(moduleConfig,3),name=_moduleConfig[0],functions=_moduleConfig[2];(0,_Invariant2.default)(functions,"Module "+name+" has no methods to call");var functionName=functions[methodId];(0,_Invariant2.default)(functionName,"No such function in module "+name+" with id "+methodId);var nativeModule=this.modulesByName[name];(0,_Invariant2.default)(nativeModule,"No such module with name "+name);(0,_Invariant2.default)(nativeModule[functionName],"No such method "+functionName+" on module "+name);nativeModule[functionName].apply(nativeModule,params);}},{key:"onMessage",value:function onMessage(message){var _message$data=message.data,topic=_message$data.topic,payload=_message$data.payload;switch(topic){case"bundleFinishedLoading":{this.loading=false;_NotificationCenter2.default.emitEvent("RCTJavaScriptDidLoadNotification");if(this.bundleFinishedLoading){this.bundleFinishedLoading();}break;}case"flushedQueue":{if(payload!=null&&Array.isArray(payload)){var _payload=(0,_slicedToArray3.default)(payload,3),moduleIds=_payload[0],methodIds=_payload[1],params=_payload[2];for(var i=0;i<moduleIds.length;i++){this.messages.push({moduleId:moduleIds[i],methodId:methodIds[i],args:params[i]});}}break;}case"updateProgress":{this.devLoadingView.updateProgress(payload);break;}default:{console.warn("Unknown topic: "+topic);}}if(this.shouldContinue()){this.uiManager.requestTick();}}},{key:"generateModuleConfig",value:function generateModuleConfig(name,bridgeModule){var methodNames=[].concat((0,_toConsumableArray3.default)(new Set(getPropertyNames(bridgeModule)))).filter(function(methodName){return methodName.startsWith("__rct_export__");});var constants=bridgeModule.constantsToExport?bridgeModule.constantsToExport():undefined;var allMethods=[];var promiseMethods=[];var syncMethods=[];methodNames.forEach(function(rctName){if(bridgeModule[rctName]){var _bridgeModule$rctName3=bridgeModule[rctName].call(bridgeModule),_bridgeModule$rctName4=(0,_slicedToArray3.default)(_bridgeModule$rctName3,2),methodName=_bridgeModule$rctName4[0],methodType=_bridgeModule$rctName4[1];allMethods.push(methodName);if(methodType===_RCTBridgeMethod.RCTFunctionTypePromise){promiseMethods.push(allMethods.length-1);}if(methodType===_RCTBridgeMethod.RCTFunctionTypeSync){syncMethods.push(allMethods.length-1);}}});this.moduleConfigs.push((0,_RCTModuleConfig.moduleConfigFactory)(name,constants,allMethods,promiseMethods,syncMethods));return[name,constants,allMethods,promiseMethods,syncMethods];}},{key:"loadBridgeConfig",value:function loadBridgeConfig(){var config=this.getInitialModuleConfig();this.sendMessage("loadBridgeConfig",{config:config,bundle:this.bundleLocation});}},{key:"enqueueJSCall",value:function enqueueJSCall(moduleName,methodName,args){this.sendMessage("callFunctionReturnFlushedQueue",[moduleName,methodName,args]);}},{key:"enqueueJSCallWithDotMethod",value:function enqueueJSCallWithDotMethod(moduleDotMethod,args){var _moduleDotMethod$spli=moduleDotMethod.split("."),_moduleDotMethod$spli2=(0,_slicedToArray3.default)(_moduleDotMethod$spli,2),module=_moduleDotMethod$spli2[0],method=_moduleDotMethod$spli2[1];this.enqueueJSCall(module,method,args);}},{key:"enqueueJSCallback",value:function enqueueJSCallback(id,args){this.sendMessage("invokeCallbackAndReturnFlushedQueue",[id,args]);}},{key:"callbackFromId",value:function callbackFromId(id){var _this=this;return function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this.enqueueJSCallback(id,args);};}},{key:"frame",value:function frame(){var _this2=this;var messages;return _regenerator2.default.async(function frame$(_context){while(1){switch(_context.prev=_context.next){case 0:this.sendMessage("flush");messages=[].concat((0,_toConsumableArray3.default)(this.messages));this.messages=[];messages.forEach(function(_ref){var moduleId=_ref.moduleId,methodId=_ref.methodId,args=_ref.args;_this2.callNativeModule(moduleId,methodId,args);});case 4:case"end":return _context.stop();}}},null,this);}},{key:"shouldContinue",value:function shouldContinue(){return this.messages.length!==0;}},{key:"uiManager",get:function get(){if(!this._uiManager){var uiManager=this.modulesByName["UIManager"];this._uiManager=uiManager;}return this._uiManager;}},{key:"devLoadingView",get:function get(){if(!this._devLoadingView){var devLoadingView=this.modulesByName["DevLoadingView"];this._devLoadingView=devLoadingView;}return this._devLoadingView;}},{key:"eventDispatcher",get:function get(){if(!this._eventDispatcher){var eventDispatcher=this.modulesByName["EventDispatcher"];this._eventDispatcher=eventDispatcher;}return this._eventDispatcher;}},{key:"imageLoader",get:function get(){if(!this._imageLoader){var imageLoader=this.modulesByName["ImageLoader"];this._imageLoader=imageLoader;}return this._imageLoader;}},{key:"deviceInfo",get:function get(){if(!this._deviceInfo){var deviceInfo=this.modulesByName["DeviceInfo"];this._deviceInfo=deviceInfo;}return this._deviceInfo;}},{key:"devSettings",get:function get(){if(!this._devSettings){var devSettings=this.modulesByName["DevSettings"];this._devSettings=devSettings;}return this._devSettings;}}]);return RCTBridge;}(),_initialiseProps=function _initialiseProps(){var _this3=this;this.modulesByName={};this.moduleClasses=[];this.moduleConfigs=[];this.messages=[];this.queue=[];this.executing=false;this.initializeModules=function _callee(){return _regenerator2.default.async(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regenerator2.default.awrap(Promise.all(_this3.nativeModules));case 2:_this3.moduleClasses=_context2.sent;_this3.moduleClasses=_this3.moduleClasses.map(function(maybeModule){return maybeModule.__esModule?maybeModule.default:maybeModule;});_this3.moduleClasses.forEach(function(moduleClass){var module=new moduleClass(_this3);var moduleName=bridgeModuleNameForClass(moduleClass);_this3.modulesByName[moduleName]=module;});case 5:case"end":return _context2.stop();}}},null,_this3);};this.getInitialModuleConfig=function(){var remoteModuleConfig=Object.keys(_this3.modulesByName).map(function(moduleName){var bridgeModule=_this3.modulesByName[moduleName];return _this3.generateModuleConfig(moduleName,bridgeModule);});return{remoteModuleConfig:remoteModuleConfig};};},_temp);exports.default=RCTBridge;function RCT_EXPORT_METHOD(type){return function(target,key,descriptor){if(typeof descriptor.value==="function"){Object.defineProperty(target,"__rct_export__"+key,(0,_extends3.default)({},descriptor,{value:function value(){return[key,type];}}));}return descriptor;};}var RCT_EXPORT_MODULE=exports.RCT_EXPORT_MODULE=function RCT_EXPORT_MODULE(name){return function(target){target.__moduleName=name;};};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL1JlYWN0RG9tL2JyaWRnZS9SQ1RCcmlkZ2UuanMiXSwibmFtZXMiOlsiZ2V0UHJvcGVydHlOYW1lcyIsImJyaWRnZU1vZHVsZU5hbWVGb3JDbGFzcyIsIlJDVF9FWFBPUlRfTUVUSE9EIiwiWUciLCJSQ1RGdW5jdGlvblR5cGVOb3JtYWwiLCJSQ1RGdW5jdGlvblR5cGVQcm9taXNlIiwiUkNURnVuY3Rpb25UeXBlU3luYyIsIk1PRFVMRV9JRFMiLCJNRVRIT0RfSURTIiwiUEFSQU1TIiwiREVWVE9PTFNfRkxBRyIsIkhPVFJFTE9BRF9GTEFHIiwiV09SS0VSX1NSQyIsIl9fREVWX18iLCJ0ZXN0IiwibG9jYXRpb24iLCJzZWFyY2giLCJ3aW5kb3ciLCJfX1JFQUNUX0RFVlRPT0xTX0dMT0JBTF9IT09LX18iLCJjb25zb2xlIiwibG9nIiwib2JqIiwiY3VycmVudFByb3BlcnR5TmFtZXMiLCJPYmplY3QiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiY29uY2F0IiwiZ2V0UHJvdG90eXBlT2YiLCJjbHMiLCJuYW1lIiwiX19tb2R1bGVOYW1lIiwic3RhcnRzV2l0aCIsInN1YnN0cmluZyIsImdlbmVyYXRlTW9kdWxlQ29uZmlnIiwiYnJpZGdlTW9kdWxlIiwibWV0aG9kTmFtZXMiLCJTZXQiLCJmaWx0ZXIiLCJtZXRob2ROYW1lIiwiY29uc3RhbnRzIiwiY29uc3RhbnRzVG9FeHBvcnQiLCJ1bmRlZmluZWQiLCJhbGxNZXRob2RzIiwicHJvbWlzZU1ldGhvZHMiLCJzeW5jTWV0aG9kcyIsImZvckVhY2giLCJyY3ROYW1lIiwiY2FsbCIsIm1ldGhvZFR5cGUiLCJwdXNoIiwibGVuZ3RoIiwiUkNUQnJpZGdlIiwibW9kdWxlTmFtZSIsImJ1bmRsZSIsIm5hdGl2ZU1vZHVsZXMiLCJsb2FkaW5nIiwiYnVuZGxlTG9jYXRpb24iLCJicmlkZ2VDb2RlQmxvYiIsIkJsb2IiLCJ3b3JrZXIiLCJXb3JrZXIiLCJVUkwiLCJjcmVhdGVPYmplY3RVUkwiLCJzZXRUaHJlYWQiLCJtb2R1bGVzQnlOYW1lIiwidGhyZWFkIiwib25tZXNzYWdlIiwib25NZXNzYWdlIiwiYmluZCIsInRvcGljIiwicGF5bG9hZCIsInBvc3RNZXNzYWdlIiwibW9kdWxlSWQiLCJtZXRob2RJZCIsInBhcmFtcyIsIm1vZHVsZUNvbmZpZyIsIm1vZHVsZUNvbmZpZ3MiLCJmdW5jdGlvbnMiLCJmdW5jdGlvbk5hbWUiLCJuYXRpdmVNb2R1bGUiLCJhcHBseSIsIm1lc3NhZ2UiLCJkYXRhIiwiZW1pdEV2ZW50IiwiYnVuZGxlRmluaXNoZWRMb2FkaW5nIiwiQXJyYXkiLCJpc0FycmF5IiwibW9kdWxlSWRzIiwibWV0aG9kSWRzIiwiaSIsIm1lc3NhZ2VzIiwiYXJncyIsImRldkxvYWRpbmdWaWV3IiwidXBkYXRlUHJvZ3Jlc3MiLCJ3YXJuIiwic2hvdWxkQ29udGludWUiLCJ1aU1hbmFnZXIiLCJyZXF1ZXN0VGljayIsImNvbmZpZyIsImdldEluaXRpYWxNb2R1bGVDb25maWciLCJzZW5kTWVzc2FnZSIsIm1vZHVsZURvdE1ldGhvZCIsInNwbGl0IiwibW9kdWxlIiwibWV0aG9kIiwiZW5xdWV1ZUpTQ2FsbCIsImlkIiwiZW5xdWV1ZUpTQ2FsbGJhY2siLCJjYWxsTmF0aXZlTW9kdWxlIiwiX3VpTWFuYWdlciIsIl9kZXZMb2FkaW5nVmlldyIsIl9ldmVudERpc3BhdGNoZXIiLCJldmVudERpc3BhdGNoZXIiLCJfaW1hZ2VMb2FkZXIiLCJpbWFnZUxvYWRlciIsIl9kZXZpY2VJbmZvIiwiZGV2aWNlSW5mbyIsIl9kZXZTZXR0aW5ncyIsImRldlNldHRpbmdzIiwibW9kdWxlQ2xhc3NlcyIsInF1ZXVlIiwiZXhlY3V0aW5nIiwiaW5pdGlhbGl6ZU1vZHVsZXMiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwibWF5YmVNb2R1bGUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIm1vZHVsZUNsYXNzIiwicmVtb3RlTW9kdWxlQ29uZmlnIiwia2V5cyIsInR5cGUiLCJ0YXJnZXQiLCJrZXkiLCJkZXNjcmlw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QUFLOEIsYUFBTCxDQUFtQlosVUFBbkIsQ0FBckIsQ0FDQSxNQUFPLFFBQUtuQixvQkFBTCxDQUEwQm1CLFVBQTFCLENBQXNDbEIsWUFBdEMsQ0FBUCxDQUNELENBSndCLENBQTNCLENBTUEsTUFBTyxDQUFFZ0cscUNBQUYsQ0FBUCxDQUNELEMsMEJBL0xrQi9FLFMsQ0EwUmQsUUFBU2hELGtCQUFULENBQTJCaUksSUFBM0IsQ0FBa0QsQ0FDdkQsTUFBTyxVQUFDQyxNQUFELENBQWNDLEdBQWQsQ0FBd0JDLFVBQXhCLENBQTRDLENBQ2pELEdBQUksTUFBT0EsWUFBV0MsS0FBbEIsR0FBNEIsVUFBaEMsQ0FBNEMsQ0FDMUNoSCxPQUFPaUgsY0FBUCxDQUFzQkosTUFBdEIsa0JBQStDQyxHQUEvQywwQkFDS0MsVUFETCxFQUVFQyxNQUFPLHVCQUFNLENBQUNGLEdBQUQsQ0FBTUYsSUFBTixDQUFOLEVBRlQsSUFJRCxDQUVELE1BQU9HLFdBQVAsQ0FDRCxDQVRELENBVUQsQ0FFTSxHQUFNRyw2Q0FBb0IsUUFBcEJBLGtCQUFvQixDQUFDN0csSUFBRCxRQUFrQixVQUNqRHdHLE1BRGlELENBRTlDLENBQ0hBLE9BQU92RyxZQUFQLENBQXNCRCxJQUF0QixDQUNELENBSmdDLEVBQTFCIiwiZmlsZSI6IlJDVEJyaWRnZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQHByb3ZpZGVzTW9kdWxlIFJDVEJyaWRnZVxuICogQGZsb3dcbiAqL1xuaW1wb3J0IGludmFyaWFudCBmcm9tIFwiSW52YXJpYW50XCI7XG5pbXBvcnQgWW9nYSwgKiBhcyBZRyBmcm9tIFwieW9nYS1kb21cIjtcbmltcG9ydCB7IG1vZHVsZUNvbmZpZ0ZhY3RvcnkgfSBmcm9tIFwiUkNUTW9kdWxlQ29uZmlnXCI7XG5pbXBvcnQgTm90aWZpY2F0aW9uQ2VudGVyIGZyb20gXCJOb3RpZmljYXRpb25DZW50ZXJcIjtcbmltcG9ydCB7XG4gIFJDVEZ1bmN0aW9uVHlwZU5vcm1hbCxcbiAgUkNURnVuY3Rpb25UeXBlUHJvbWlzZSxcbiAgUkNURnVuY3Rpb25UeXBlU3luY1xufSBmcm9tIFwiUkNUQnJpZGdlTWV0aG9kXCI7XG5pbXBvcnQgdHlwZSB7IE1vZHVsZUNvbmZpZyB9IGZyb20gXCJSQ1RNb2R1bGVDb25maWdcIjtcbmltcG9ydCB0eXBlIHsgUkNURnVuY3Rpb25UeXBlIH0gZnJvbSBcIlJDVEJyaWRnZU1ldGhvZFwiO1xuaW1wb3J0IHR5cGUgUkNURXZlbnREaXNwYXRjaGVyIGZyb20gXCJSQ1RFdmVudERpc3BhdGNoZXJcIjtcbmltcG9ydCB0eXBlIFJDVEltYWdlTG9hZGVyIGZyb20gXCJSQ1RJbWFnZUxvYWRlclwiO1xuaW1wb3J0IHR5cGUgUkNURGV2aWNlSW5mbyBmcm9tIFwiUkNURGV2aWNlSW5mb1wiO1xuaW1wb3J0IHR5cGUgUkNURGV2TG9hZGluZ1ZpZXcgZnJvbSBcIlJDVERldkxvYWRpbmdWaWV3XCI7XG5pbXBvcnQgdHlwZSBSQ1REZXZTZXR0aW5ncyBmcm9tIFwiUkNURGV2U2V0dGluZ3NcIjtcbmltcG9ydCB0eXBlIHtcbiAgUkNUTW9kdWxlLFxuICBSQ1RNb2R1bGVTdGF0aWNzLFxuICBOYXRpdmVNb2R1bGVJbXBvcnRzXG59IGZyb20gXCJSQ1RNb2R1bGVcIjtcblxuaW1wb3J0IHR5cGVvZiBfUkNUVUlNYW5hZ2VyIGZyb20gXCJSQ1RVSU1hbmFnZXJcIjtcbnR5cGUgUkNUVUlNYW5hZ2VyID0gJENhbGw8JGF3YWl0PF9SQ1RVSU1hbmFnZXI+PjtcblxuZXhwb3J0IHsgUkNURnVuY3Rpb25UeXBlTm9ybWFsLCBSQ1RGdW5jdGlvblR5cGVQcm9taXNlLCBSQ1RGdW5jdGlvblR5cGVTeW5jIH07XG5leHBvcnQgdHlwZSB7IFJDVEZ1bmN0aW9uVHlwZSB9O1xuXG50eXBlIE1lc3NhZ2VQYXlsb2FkID0ge1xuICBkYXRhOiB7XG4gICAgdG9waWM6IHN0cmluZyxcbiAgICBwYXlsb2FkOiBhbnlcbiAgfVxufTtcblxudHlwZSBOYXRpdmVDYWxsID0ge1xuICBtb2R1bGVJZDogbnVtYmVyLFxuICBtZXRob2RJZDogbnVtYmVyLFxuICBhcmdzOiBBcnJheTxhbnk+XG59O1xuXG5jb25zdCBNT0RVTEVfSURTID0gMDtcbmNvbnN0IE1FVEhPRF9JRFMgPSAxO1xuY29uc3QgUEFSQU1TID0gMjtcblxuY29uc3QgREVWVE9PTFNfRkxBRyA9IC9cXGJkZXZ0b29sc1xcYi87XG5jb25zdCBIT1RSRUxPQURfRkxBRyA9IC9cXGJob3RyZWxvYWRcXGIvO1xuXG4vLyAkRmxvd0ZpeE1lXG5sZXQgV09SS0VSX1NSQyA9IHByZXZhbGBcbiAgY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuICBjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuXG4gIG1vZHVsZS5leHBvcnRzID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICdSQ1RCcmlkZ2Uud29ya2VyLmpzJyksXG4gICAgJ3V0ZjgnXG4gICk7XG5gO1xuXG5pZiAoX19ERVZfXykge1xuICBXT1JLRVJfU1JDID0gXCJfX0RFVl9fID0gdHJ1ZTtcXG5cIiArIFdPUktFUl9TUkM7XG4gIGlmIChERVZUT09MU19GTEFHLnRlc3QobG9jYXRpb24uc2VhcmNoKSkge1xuICAgIFdPUktFUl9TUkMgPSBcIl9fREVWVE9PTFNfXyA9IHRydWU7XFxuXCIgKyBXT1JLRVJfU1JDO1xuICAgIGlmICh3aW5kb3cuX19SRUFDVF9ERVZUT09MU19HTE9CQUxfSE9PS19fKSB7XG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgXCJXZSBkZXRlY3RlZCB0aGF0IHlvdSBoYXZlIHRoZSBSZWFjdCBEZXZ0b29scyBleHRlbnNpb24gaW5zdGFsbGVkLiBcIiArXG4gICAgICAgICAgXCJQbGVhc2Ugbm90ZSB0aGF0IGF0IHRoaXMgdGltZSwgUmVhY3QgVlIgaXMgb25seSBjb21wYXRpYmxlIHdpdGggdGhlIFwiICtcbiAgICAgICAgICBcInN0YW5kYWxvbmUgUmVhY3QgTmF0aXZlIEluc3BlY3RvciB0aGF0IHNoaXBzIHdpdGggTnVjbGlkZS5cIlxuICAgICAgKTtcbiAgICB9XG4gIH1cbn0gZWxzZSB7XG4gIFdPUktFUl9TUkMgPSBcIl9fREVWX18gPSBmYWxzZTtcXG5cIiArIFdPUktFUl9TUkM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm9wZXJ0eU5hbWVzKG9iajogP09iamVjdCk6IEFycmF5PHN0cmluZz4ge1xuICBpZiAob2JqID09IG51bGwpIHJldHVybiBbXTtcblxuICBjb25zdCBjdXJyZW50UHJvcGVydHlOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iaik7XG4gIHJldHVybiBjdXJyZW50UHJvcGVydHlOYW1lcy5jb25jYXQoXG4gICAgZ2V0UHJvcGVydHlOYW1lcyhPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSlcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJyaWRnZU1vZHVsZU5hbWVGb3JDbGFzcyhjbHM6IFJDVE1vZHVsZVN0YXRpY3MpOiBzdHJpbmcge1xuICBsZXQgbmFtZSA9IGNscy5fX21vZHVsZU5hbWU7XG5cbiAgaWYgKG5hbWUgIT0gbnVsbCkge1xuICAgIGlmIChuYW1lLnN0YXJ0c1dpdGgoXCJSS1wiKSkge1xuICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDIpO1xuICAgIH0gZWxzZSBpZiAobmFtZS5zdGFydHNXaXRoKFwiUkNUXCIpKSB7XG4gICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoMyk7XG4gICAgfVxuICAgIHJldHVybiBuYW1lO1xuICB9XG5cbiAgcmV0dXJuIFwiXCI7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlTW9kdWxlQ29uZmlnKG5hbWU6IHN0cmluZywgYnJpZGdlTW9kdWxlOiBSQ1RNb2R1bGUpIHtcbiAgY29uc3QgbWV0aG9kTmFtZXMgPSBbLi4ubmV3IFNldChnZXRQcm9wZXJ0eU5hbWVzKGJyaWRnZU1vZHVsZSkpXS5maWx0ZXIoXG4gICAgKG1ldGhvZE5hbWUpID0+IG1ldGhvZE5hbWUuc3RhcnRzV2l0aChcIl9fcmN0X2V4cG9ydF9fXCIpXG4gICk7XG5cbiAgY29uc3QgY29uc3RhbnRzID0gYnJpZGdlTW9kdWxlLmNvbnN0YW50c1RvRXhwb3J0XG4gICAgPyBicmlkZ2VNb2R1bGUuY29uc3RhbnRzVG9FeHBvcnQoKVxuICAgIDogdW5kZWZpbmVkO1xuXG4gIGNvbnN0IGFsbE1ldGhvZHMgPSBbXTtcbiAgY29uc3QgcHJvbWlzZU1ldGhvZHMgPSBbXTtcbiAgY29uc3Qgc3luY01ldGhvZHMgPSBbXTtcblxuICBtZXRob2ROYW1lcy5mb3JFYWNoKChyY3ROYW1lKSA9PiB7XG4gICAgaWYgKGJyaWRnZU1vZHVsZVtyY3ROYW1lXSkge1xuICAgICAgY29uc3QgW21ldGhvZE5hbWUsIG1ldGhvZFR5cGVdID0gYnJpZGdlTW9kdWxlW3JjdE5hbWVdLmNhbGwoYnJpZGdlTW9kdWxlKTtcbiAgICAgIGFsbE1ldGhvZHMucHVzaChtZXRob2ROYW1lKTtcblxuICAgICAgaWYgKG1ldGhvZFR5cGUgPT09IFJDVEZ1bmN0aW9uVHlwZVByb21pc2UpIHtcbiAgICAgICAgcHJvbWlzZU1ldGhvZHMucHVzaChhbGxNZXRob2RzLmxlbmd0aCAtIDEpO1xuICAgICAgfVxuXG4gICAgICBpZiAobWV0aG9kVHlwZSA9PT0gUkNURnVuY3Rpb25UeXBlU3luYykge1xuICAgICAgICBzeW5jTWV0aG9kcy5wdXNoKGFsbE1ldGhvZHMubGVuZ3RoIC0gMSk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gW25hbWUsIGNvbnN0YW50cywgYWxsTWV0aG9kcywgcHJvbWlzZU1ldGhvZHMsIHN5bmNNZXRob2RzXTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUkNUQnJpZGdlIHtcbiAgbmF0aXZlTW9kdWxlczogTmF0aXZlTW9kdWxlSW1wb3J0cztcblxuICBtb2R1bGVzQnlOYW1lOiB7IFtuYW1lOiBzdHJpbmddOiBSQ1RNb2R1bGUgfSA9IHt9O1xuICBtb2R1bGVDbGFzc2VzOiBBcnJheTxDbGFzczxSQ1RNb2R1bGU+PiA9IFtdO1xuICBtb2R1bGVDb25maWdzOiBBcnJheTxNb2R1bGVDb25maWc+ID0gW107XG4gIGJ1bmRsZUZpbmlzaGVkTG9hZGluZzogPygpID0+IHZvaWQ7XG4gIG1lc3NhZ2VzOiBBcnJheTxOYXRpdmVDYWxsPiA9IFtdO1xuICBtb2R1bGVOYW1lOiBzdHJpbmc7XG4gIGJ1bmRsZUxvY2F0aW9uOiBzdHJpbmc7XG4gIGxvYWRpbmc6IGJvb2xlYW47XG5cbiAgX3VpTWFuYWdlcjogP1JDVFVJTWFuYWdlcjtcbiAgX2V2ZW50RGlzcGF0Y2hlcjogP1JDVEV2ZW50RGlzcGF0Y2hlcjtcbiAgX2ltYWdlTG9hZGVyOiA/UkNUSW1hZ2VMb2FkZXI7XG4gIF9kZXZpY2VJbmZvOiA/UkNURGV2aWNlSW5mbztcbiAgX2RldkxvYWRpbmdWaWV3OiA/UkNURGV2TG9hZGluZ1ZpZXc7XG4gIF9kZXZTZXR0aW5nczogP1JDVERldlNldHRpbmdzO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIG1vZHVsZU5hbWU6IHN0cmluZyxcbiAgICBidW5kbGU6IHN0cmluZyxcbiAgICBuYXRpdmVNb2R1bGVzOiBOYXRpdmVNb2R1bGVJbXBvcnRzXG4gICkge1xuICAgIHRoaXMubG9hZGluZyA9IHRydWU7XG4gICAgdGhpcy5tb2R1bGVOYW1lID0gbW9kdWxlTmFtZTtcbiAgICB0aGlzLmJ1bmRsZUxvY2F0aW9uID0gYnVuZGxlO1xuICAgIHRoaXMubmF0aXZlTW9kdWxlcyA9IG5hdGl2ZU1vZHVsZXM7XG5cbiAgICBjb25zdCBicmlkZ2VDb2RlQmxvYiA9IG5ldyBCbG9iKFtXT1JLRVJfU1JDXSk7XG4gICAgY29uc3Qgd29ya2VyID0gbmV3IFdvcmtlcihVUkwuY3JlYXRlT2JqZWN0VVJMKGJyaWRnZUNvZGVCbG9iKSk7XG4gICAgdGhpcy5zZXRUaHJlYWQod29ya2VyKTtcbiAgfVxuXG4gIG1vZHVsZUZvckNsYXNzKGNsczogUkNUTW9kdWxlU3RhdGljcyk6IFJDVE1vZHVsZSB7XG4gICAgaW52YXJpYW50KGNscy5fX21vZHVsZU5hbWUsIFwiQ2xhc3MgZG9lcyBub3Qgc2VlbSB0byBiZSBleHBvcnRlZFwiKTtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVzQnlOYW1lW2JyaWRnZU1vZHVsZU5hbWVGb3JDbGFzcyhjbHMpXTtcbiAgfVxuXG4gIHF1ZXVlOiBBcnJheTxhbnk+ID0gW107XG4gIGV4ZWN1dGluZzogYm9vbGVhbiA9IGZhbHNlO1xuICB0aHJlYWQ6ID9Xb3JrZXI7XG5cbiAgc2V0VGhyZWFkKHRocmVhZDogV29ya2VyKSB7XG4gICAgdGhpcy50aHJlYWQgPSB0aHJlYWQ7XG4gICAgdGhyZWFkLm9ubWVzc2FnZSA9IHRoaXMub25NZXNzYWdlLmJpbmQodGhpcyk7XG4gIH1cblxuICBzZW5kTWVzc2FnZSh0b3BpYzogc3RyaW5nLCBwYXlsb2FkOiBhbnkpIHtcbiAgICBpZiAodGhpcy50aHJlYWQpIHtcbiAgICAgIHRoaXMudGhyZWFkLnBvc3RNZXNzYWdlKHsgdG9waWMsIHBheWxvYWQgfSk7XG4gICAgfVxuICB9XG5cbiAgY2FsbE5hdGl2ZU1vZHVsZShtb2R1bGVJZDogbnVtYmVyLCBtZXRob2RJZDogbnVtYmVyLCBwYXJhbXM6IEFycmF5PGFueT4pIHtcbiAgICBjb25zdCBtb2R1bGVDb25maWcgPSB0aGlzLm1vZHVsZUNvbmZpZ3NbbW9kdWxlSWRdO1xuXG4gICAgaW52YXJpYW50KG1vZHVsZUNvbmZpZywgYE5vIHN1Y2ggbW9kdWxlIHdpdGggaWQ6ICR7bW9kdWxlSWR9YCk7XG4gICAgY29uc3QgW25hbWUsICwgZnVuY3Rpb25zXSA9IG1vZHVsZUNvbmZpZztcblxuICAgIGludmFyaWFudChmdW5jdGlvbnMsIGBNb2R1bGUgJHtuYW1lfSBoYXMgbm8gbWV0aG9kcyB0byBjYWxsYCk7XG4gICAgY29uc3QgZnVuY3Rpb25OYW1lID0gZnVuY3Rpb25zW21ldGhvZElkXTtcblxuICAgIGludmFyaWFudChcbiAgICAgIGZ1bmN0aW9uTmFtZSxcbiAgICAgIGBObyBzdWNoIGZ1bmN0aW9uIGluIG1vZHVsZSAke25hbWV9IHdpdGggaWQgJHttZXRob2RJZH1gXG4gICAgKTtcbiAgICBjb25zdCBuYXRpdmVNb2R1bGUgPSB0aGlzLm1vZHVsZXNCeU5hbWVbbmFtZV07XG5cbiAgICBpbnZhcmlhbnQobmF0aXZlTW9kdWxlLCBgTm8gc3VjaCBtb2R1bGUgd2l0aCBuYW1lICR7bmFtZX1gKTtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBuYXRpdmVNb2R1bGVbZnVuY3Rpb25OYW1lXSxcbiAgICAgIGBObyBzdWNoIG1ldGhvZCAke2Z1bmN0aW9uTmFtZX0gb24gbW9kdWxlICR7bmFtZX1gXG4gICAgKTtcblxuICAgIC8vIGNvbnNvbGUubG9nKFwiSlMgLT4gTmF0aXZlXCIsIG5hbWUsIGZ1bmN0aW9uTmFtZSwgcGFyYW1zKTtcblxuICAgIG5hdGl2ZU1vZHVsZVtmdW5jdGlvbk5hbWVdLmFwcGx5KG5hdGl2ZU1vZHVsZSwgcGFyYW1zKTtcbiAgfVxuXG4gIG9uTWVzc2FnZShtZXNzYWdlOiBhbnkpIHtcbiAgICBjb25zdCB7IHRvcGljLCBwYXlsb2FkIH0gPSBtZXNzYWdlLmRhdGE7XG5cbiAgICBzd2l0Y2ggKHRvcGljKSB7XG4gICAgICBjYXNlIFwiYnVuZGxlRmluaXNoZWRMb2FkaW5nXCI6IHtcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIE5vdGlmaWNhdGlvbkNlbnRlci5lbWl0RXZlbnQoXCJSQ1RKYXZhU2NyaXB0RGlkTG9hZE5vdGlmaWNhdGlvblwiKTtcbiAgICAgICAgaWYgKHRoaXMuYnVuZGxlRmluaXNoZWRMb2FkaW5nKSB7XG4gICAgICAgICAgdGhpcy5idW5kbGVGaW5pc2hlZExvYWRpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJmbHVzaGVkUXVldWVcIjoge1xuICAgICAgICBpZiAocGF5bG9hZCAhPSBudWxsICYmIEFycmF5LmlzQXJyYXkocGF5bG9hZCkpIHtcbiAgICAgICAgICBjb25zdCBbbW9kdWxlSWRzLCBtZXRob2RJZHMsIHBhcmFtc10gPSBwYXlsb2FkO1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbW9kdWxlSWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goe1xuICAgICAgICAgICAgICBtb2R1bGVJZDogbW9kdWxlSWRzW2ldLFxuICAgICAgICAgICAgICBtZXRob2RJZDogbWV0aG9kSWRzW2ldLFxuICAgICAgICAgICAgICBhcmdzOiBwYXJhbXNbaV1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJ1cGRhdGVQcm9ncmVzc1wiOiB7XG4gICAgICAgIHRoaXMuZGV2TG9hZGluZ1ZpZXcudXBkYXRlUHJvZ3Jlc3MocGF5bG9hZCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICBjb25zb2xlLndhcm4oYFVua25vd24gdG9waWM6ICR7dG9waWN9YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2hvdWxkQ29udGludWUoKSkge1xuICAgICAgdGhpcy51aU1hbmFnZXIucmVxdWVzdFRpY2soKTtcbiAgICB9XG4gIH1cblxuICBpbml0aWFsaXplTW9kdWxlcyA9IGFzeW5jICgpID0+IHtcbiAgICB0aGlzLm1vZHVsZUNsYXNzZXMgPSBhd2FpdCBQcm9taXNlLmFsbCh0aGlzLm5hdGl2ZU1vZHVsZXMpO1xuXG4gICAgLy8gcmVzb2x2ZSBkZWZhdWx0IGV4cG9ydHMgZnJvbSBlcyBtb2R1bGVzXG4gICAgdGhpcy5tb2R1bGVDbGFzc2VzID0gdGhpcy5tb2R1bGVDbGFzc2VzLm1hcCgobWF5YmVNb2R1bGUpID0+IHtcbiAgICAgIHJldHVybiBtYXliZU1vZHVsZS5fX2VzTW9kdWxlID8gKG1heWJlTW9kdWxlOiBhbnkpLmRlZmF1bHQgOiBtYXliZU1vZHVsZTtcbiAgICB9KTtcblxuICAgIHRoaXMubW9kdWxlQ2xhc3Nlcy5mb3JFYWNoKChtb2R1bGVDbGFzczogQ2xhc3M8UkNUTW9kdWxlPikgPT4ge1xuICAgICAgY29uc3QgbW9kdWxlID0gbmV3IG1vZHVsZUNsYXNzKHRoaXMpO1xuICAgICAgY29uc3QgbW9kdWxlTmFtZSA9IGJyaWRnZU1vZHVsZU5hbWVGb3JDbGFzcyhtb2R1bGVDbGFzcyk7XG4gICAgICB0aGlzLm1vZHVsZXNCeU5hbWVbbW9kdWxlTmFtZV0gPSBtb2R1bGU7XG4gICAgfSk7XG4gIH07XG5cbiAgZ2VuZXJhdGVNb2R1bGVDb25maWcobmFtZTogc3RyaW5nLCBicmlkZ2VNb2R1bGU6IFJDVE1vZHVsZSkge1xuICAgIGNvbnN0IG1ldGhvZE5hbWVzID0gWy4uLm5ldyBTZXQoZ2V0UHJvcGVydHlOYW1lcyhicmlkZ2VNb2R1bGUpKV0uZmlsdGVyKFxuICAgICAgKG1ldGhvZE5hbWUpID0+IG1ldGhvZE5hbWUuc3RhcnRzV2l0aChcIl9fcmN0X2V4cG9ydF9fXCIpXG4gICAgKTtcblxuICAgIGNvbnN0IGNvbnN0YW50cyA9IGJyaWRnZU1vZHVsZS5jb25zdGFudHNUb0V4cG9ydFxuICAgICAgPyBicmlkZ2VNb2R1bGUuY29uc3RhbnRzVG9FeHBvcnQoKVxuICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICBjb25zdCBhbGxNZXRob2RzID0gW107XG4gICAgY29uc3QgcHJvbWlzZU1ldGhvZHMgPSBbXTtcbiAgICBjb25zdCBzeW5jTWV0aG9kcyA9IFtdO1xuXG4gICAgbWV0aG9kTmFtZXMuZm9yRWFjaCgocmN0TmFtZSkgPT4ge1xuICAgICAgaWYgKGJyaWRnZU1vZHVsZVtyY3ROYW1lXSkge1xuICAgICAgICBjb25zdCBbbWV0aG9kTmFtZSwgbWV0aG9kVHlwZV0gPSBicmlkZ2VNb2R1bGVbcmN0TmFtZV0uY2FsbChcbiAgICAgICAgICBicmlkZ2VNb2R1bGVcbiAgICAgICAgKTtcbiAgICAgICAgYWxsTWV0aG9kcy5wdXNoKG1ldGhvZE5hbWUpO1xuXG4gICAgICAgIGlmIChtZXRob2RUeXBlID09PSBSQ1RGdW5jdGlvblR5cGVQcm9taXNlKSB7XG4gICAgICAgICAgcHJvbWlzZU1ldGhvZHMucHVzaChhbGxNZXRob2RzLmxlbmd0aCAtIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1ldGhvZFR5cGUgPT09IFJDVEZ1bmN0aW9uVHlwZVN5bmMpIHtcbiAgICAgICAgICBzeW5jTWV0aG9kcy5wdXNoKGFsbE1ldGhvZHMubGVuZ3RoIC0gMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLm1vZHVsZUNvbmZpZ3MucHVzaChcbiAgICAgIG1vZHVsZUNvbmZpZ0ZhY3RvcnkoXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGNvbnN0YW50cyxcbiAgICAgICAgYWxsTWV0aG9kcyxcbiAgICAgICAgcHJvbWlzZU1ldGhvZHMsXG4gICAgICAgIHN5bmNNZXRob2RzXG4gICAgICApXG4gICAgKTtcbiAgICByZXR1cm4gW25hbWUsIGNvbnN0YW50cywgYWxsTWV0aG9kcywgcHJvbWlzZU1ldGhvZHMsIHN5bmNNZXRob2RzXTtcbiAgfVxuXG4gIGxvYWRCcmlkZ2VDb25maWcoKSB7XG4gICAgY29uc3QgY29uZmlnID0gdGhpcy5nZXRJbml0aWFsTW9kdWxlQ29uZmlnKCk7XG4gICAgdGhpcy5zZW5kTWVzc2FnZShcImxvYWRCcmlkZ2VDb25maWdcIiwge1xuICAgICAgY29uZmlnLFxuICAgICAgYnVuZGxlOiB0aGlzLmJ1bmRsZUxvY2F0aW9uXG4gICAgfSk7XG4gIH1cblxuICBnZXRJbml0aWFsTW9kdWxlQ29uZmlnID0gKCkgPT4ge1xuICAgIGNvbnN0IHJlbW90ZU1vZHVsZUNvbmZpZyA9IE9iamVjdC5rZXlzKHRoaXMubW9kdWxlc0J5TmFtZSkubWFwKFxuICAgICAgKG1vZHVsZU5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgYnJpZGdlTW9kdWxlID0gdGhpcy5tb2R1bGVzQnlOYW1lW21vZHVsZU5hbWVdO1xuICAgICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZU1vZHVsZUNvbmZpZyhtb2R1bGVOYW1lLCBicmlkZ2VNb2R1bGUpO1xuICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIHsgcmVtb3RlTW9kdWxlQ29uZmlnIH07XG4gIH07XG5cbiAgZW5xdWV1ZUpTQ2FsbChtb2R1bGVOYW1lOiBzdHJpbmcsIG1ldGhvZE5hbWU6IHN0cmluZywgYXJnczogQXJyYXk8YW55Pikge1xuICAgIC8vIGNvbnNvbGUubG9nKFwiTmF0aXZlIC0+IEpTXCIsIG1vZHVsZU5hbWUsIG1ldGhvZE5hbWUsIGFyZ3MpO1xuICAgIHRoaXMuc2VuZE1lc3NhZ2UoXCJjYWxsRnVuY3Rpb25SZXR1cm5GbHVzaGVkUXVldWVcIiwgW1xuICAgICAgbW9kdWxlTmFtZSxcbiAgICAgIG1ldGhvZE5hbWUsXG4gICAgICBhcmdzXG4gICAgXSk7XG4gIH1cblxuICBlbnF1ZXVlSlNDYWxsV2l0aERvdE1ldGhvZChtb2R1bGVEb3RNZXRob2Q6IHN0cmluZywgYXJnczogQXJyYXk8YW55Pikge1xuICAgIGNvbnN0IFttb2R1bGUsIG1ldGhvZF0gPSBtb2R1bGVEb3RNZXRob2Quc3BsaXQoXCIuXCIpO1xuICAgIHRoaXMuZW5xdWV1ZUpTQ2FsbChtb2R1bGUsIG1ldGhvZCwgYXJncyk7XG4gIH1cblxuICBlbnF1ZXVlSlNDYWxsYmFjayhpZDogbnVtYmVyLCBhcmdzOiBBcnJheTxhbnk+KSB7XG4gICAgLy8gY29uc29sZS5sb2coXCJpbnZva2VDYWxsYmFja1wiLCBpZCwgYXJncyk7XG4gICAgdGhpcy5zZW5kTWVzc2FnZShcImludm9rZUNhbGxiYWNrQW5kUmV0dXJuRmx1c2hlZFF1ZXVlXCIsIFtpZCwgYXJnc10pO1xuICB9XG5cbiAgY2FsbGJhY2tGcm9tSWQoaWQ6IG51bWJlcikge1xuICAgIHJldHVybiAoLi4uYXJnczogQXJyYXk8YW55PikgPT4ge1xuICAgICAgdGhpcy5lbnF1ZXVlSlNDYWxsYmFjayhpZCwgYXJncyk7XG4gICAgfTtcbiAgfVxuXG4gIGdldCB1aU1hbmFnZXIoKTogUkNUVUlNYW5hZ2VyIHtcbiAgICBpZiAoIXRoaXMuX3VpTWFuYWdlcikge1xuICAgICAgY29uc3QgdWlNYW5hZ2VyOiBhbnkgPSB0aGlzLm1vZHVsZXNCeU5hbWVbXCJVSU1hbmFnZXJcIl07XG4gICAgICB0aGlzLl91aU1hbmFnZXIgPSB1aU1hbmFnZXI7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl91aU1hbmFnZXI7XG4gIH1cblxuICBnZXQgZGV2TG9hZGluZ1ZpZXcoKTogUkNURGV2TG9hZGluZ1ZpZXcge1xuICAgIGlmICghdGhpcy5fZGV2TG9hZGluZ1ZpZXcpIHtcbiAgICAgIGNvbnN0IGRldkxvYWRpbmdWaWV3OiBhbnkgPSB0aGlzLm1vZHVsZXNCeU5hbWVbXCJEZXZMb2FkaW5nVmlld1wiXTtcbiAgICAgIHRoaXMuX2RldkxvYWRpbmdWaWV3ID0gZGV2TG9hZGluZ1ZpZXc7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9kZXZMb2FkaW5nVmlldztcbiAgfVxuXG4gIGdldCBldmVudERpc3BhdGNoZXIoKTogUkNURXZlbnREaXNwYXRjaGVyIHtcbiAgICBpZiAoIXRoaXMuX2V2ZW50RGlzcGF0Y2hlcikge1xuICAgICAgY29uc3QgZXZlbnREaXNwYXRjaGVyOiBhbnkgPSB0aGlzLm1vZHVsZXNCeU5hbWVbXCJFdmVudERpc3BhdGNoZXJcIl07XG4gICAgICB0aGlzLl9ldmVudERpc3BhdGNoZXIgPSBldmVudERpc3BhdGNoZXI7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9ldmVudERpc3BhdGNoZXI7XG4gIH1cblxuICBnZXQgaW1hZ2VMb2FkZXIoKTogUkNUSW1hZ2VMb2FkZXIge1xuICAgIGlmICghdGhpcy5faW1hZ2VMb2FkZXIpIHtcbiAgICAgIGNvbnN0IGltYWdlTG9hZGVyOiBhbnkgPSB0aGlzLm1vZHVsZXNCeU5hbWVbXCJJbWFnZUxvYWRlclwiXTtcbiAgICAgIHRoaXMuX2ltYWdlTG9hZGVyID0gaW1hZ2VMb2FkZXI7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9pbWFnZUxvYWRlcjtcbiAgfVxuXG4gIGdldCBkZXZpY2VJbmZvKCk6IFJDVERldmljZUluZm8ge1xuICAgIGlmICghdGhpcy5fZGV2aWNlSW5mbykge1xuICAgICAgY29uc3QgZGV2aWNlSW5mbzogYW55ID0gdGhpcy5tb2R1bGVzQnlOYW1lW1wiRGV2aWNlSW5mb1wiXTtcbiAgICAgIHRoaXMuX2RldmljZUluZm8gPSBkZXZpY2VJbmZvO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fZGV2aWNlSW5mbztcbiAgfVxuXG4gIGdldCBkZXZTZXR0aW5ncygpOiBSQ1REZXZTZXR0aW5ncyB7XG4gICAgaWYgKCF0aGlzLl9kZXZTZXR0aW5ncykge1xuICAgICAgY29uc3QgZGV2U2V0dGluZ3M6IGFueSA9IHRoaXMubW9kdWxlc0J5TmFtZVtcIkRldlNldHRpbmdzXCJdO1xuICAgICAgdGhpcy5fZGV2U2V0dGluZ3MgPSBkZXZTZXR0aW5ncztcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2RldlNldHRpbmdzO1xuICB9XG5cbiAgYXN5bmMgZnJhbWUoKSB7XG4gICAgdGhpcy5zZW5kTWVzc2FnZShcImZsdXNoXCIpO1xuXG4gICAgY29uc3QgbWVzc2FnZXMgPSBbLi4udGhpcy5tZXNzYWdlc107XG4gICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuXG4gICAgbWVzc2FnZXMuZm9yRWFjaCgoeyBtb2R1bGVJZCwgbWV0aG9kSWQsIGFyZ3MgfSkgPT4ge1xuICAgICAgdGhpcy5jYWxsTmF0aXZlTW9kdWxlKG1vZHVsZUlkLCBtZXRob2RJZCwgYXJncyk7XG4gICAgfSk7XG4gIH1cblxuICBzaG91bGRDb250aW51ZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5tZXNzYWdlcy5sZW5ndGggIT09IDA7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFJDVF9FWFBPUlRfTUVUSE9EKHR5cGU6IFJDVEZ1bmN0aW9uVHlwZSkge1xuICByZXR1cm4gKHRhcmdldDogYW55LCBrZXk6IGFueSwgZGVzY3JpcHRvcjogYW55KSA9PiB7XG4gICAgaWYgKHR5cGVvZiBkZXNjcmlwdG9yLnZhbHVlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGBfX3JjdF9leHBvcnRfXyR7a2V5fWAsIHtcbiAgICAgICAgLi4uZGVzY3JpcHRvcixcbiAgICAgICAgdmFsdWU6ICgpID0+IFtrZXksIHR5cGVdXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVzY3JpcHRvcjtcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IFJDVF9FWFBPUlRfTU9EVUxFID0gKG5hbWU6IHN0cmluZykgPT4gKFxuICB0YXJnZXQ6IFJDVE1vZHVsZVN0YXRpY3NcbikgPT4ge1xuICB0YXJnZXQuX19tb2R1bGVOYW1lID0gbmFtZTtcbn07XG4iXX0=